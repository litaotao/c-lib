(function(a){a.fn.extend({ajaxPagination:function(c,d){if(typeof c=="string"){alert(this.pagination.toSource());return}var b=this;var e={limit:10,page:1,total:0,display_number:0,url:"",loading:function(){},error:function(){},success:function(){},previous:"«",next:"»",fn_get_url:function(f){f=f?f:this.page;return build_query(this.url,{page:f})},fn_get_total:function(f){return parseInt(f.pagination.total)},fn_get_page:function(f){return parseInt(f.pagination.page)},fn_get_limit:function(f){return parseInt(f.pagination.limit)},fn_set_page:function(f){this.page=f}};var c=a.extend({},e,c);if(c.display_number>0&&c.display_number/2==0){c.display_number+=1}this.pagination={options:c,bind_event:function(){a("a",b).click(function(){if(a(this).hasClass("disable")){return}var f=a(this).attr("data-to");b.pagination.options.page=f;b.pagination.get_data()})},build_number:function(n,m,o){var k="";var l=b.pagination.options.display_number;if(l>0){var g=Math.ceil(l/2);n=parseInt(n);g=parseInt(g);o=parseInt(o);var h=1;a(b).append('<a href="javascript:void(0);" class="page-link prev normal" data-to="1">1</a>');if(n>g+1&&o-n>0){a(b).append("...")}if(n<=g){for(h=2;h<=l;h++){if(h>o){break}a(b).append('<a href="javascript:void(0);" class="page-link prev normal" data-to="'+h+'">'+h+"</a>")}for(j=h;j<n+g;j++){if(h>o){break}a(b).append('<a href="javascript:void(0);" class="page-link prev normal" data-to="'+j+'">'+j+"</a>")}}if(n>g&&n+g+1<=o){for(j=1;j<=l;j++){if(j>o){break}var f=n-g+j;a(b).append('<a href="javascript:void(0);" class="page-link prev normal" data-to="'+f+'">'+f+"</a>")}}if(n+g+1>o&&o>l){for(j=l;j>0;j--){var f=o-j;if(f<h){continue}if(j>o){break}a(b).append('<a href="javascript:void(0);" class="page-link prev normal" data-to="'+f+'">'+f+"</a>")}}if(n+g<o&&o-l>1){a(b).append("...")}if(o>l){a(b).append('<a href="javascript:void(0);" class="page-link prev normal" data-to="'+o+'">'+o+"</a>")}}},build_nav:function(k,i,f){var l=1;if(i>0){l=Math.ceil(parseInt(i)/parseInt(f))}if(l>1){a("a",b).unbind();var h=k-1;h=h<=1?1:h;var g=k+1;g=g>=l?l:g;a(b).html("");a(b).append('<div class="page-control"></div>');a(b).children(".page-control").append('<a href="javascript:void(0);" class="page-link prev '+(k<=1?"disable":"normal")+'" data-to="'+h+'">'+this.options.previous+"</a>");b.pagination.build_number(k,i,l);a(b).children(".page-control").append('<a href="javascript:void(0);" class="page-link next '+(k>=l?"disable":"normal")+'" data-to="'+g+'">'+this.options.next+"</a>");a(b).css("height","auto")}else{a(b).html("")}},get_data:function(){$this=b.pagination;var f=c.fn_get_url();a.ajax({type:"get",url:f,dataType:"json",beforeSend:function(){if(typeof($this.options.loading)=="function"){$this.options.loading()}},error:function(){if(typeof($this.options.error)=="function"){$this.options.error()}},success:function(g){$this.options.success(g);$this.build_nav($this.options.fn_get_page(g),$this.options.fn_get_total(g),$this.options.fn_get_limit(g));$this.bind_event()}})}};this.pagination.get_data();return this}})})(jQuery);