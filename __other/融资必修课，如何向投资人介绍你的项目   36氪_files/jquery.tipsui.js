!function(t,e){function i(e,i){this.element=t(e),this.options=t.extend({},s,i),this._defaults=s,this._name=o.toLowerCase(),this._asize={width:10,height:10},this._container=t("<div />").addClass(this._name).addClass(this._name+"-"+this.options.position),this._content=t("<div />").addClass(this._name+"-content").appendTo(this._container),this._arrow=t('<div class="'+this._name+'-arrow"><i></i><em></em></div>').appendTo(this._container),this.init()}var o="TipsUI",n=(e.VBArray&&!e.XMLHttpRequest,e.document,["destroy","setOption","refresh"]),s={type:"click",close:!0,content:"",relative:!1,left:0,top:0,index:0,width:120,show:!1,position:"bottom",css:null};i.prototype.init=function(){var i=this;return i.options.relative?i._container.insertAfter(this.element):i._container.appendTo("body"),i.options.index&&i._container.css({"z-index":i.options.index}),"hover"===i.options.type?i.element.hover(function(){i.show()._refresh()},function(){i.hide()}):i.element.bind(i.options.type,function(){i._container.is(":visible")?i.hide():i.show()._refresh()}),i.options.close===!1?i._content.css({"margin-right":0}):(i._close=t('<a href="javascript:;" class="'+i._name+'-close">&times;</a>').appendTo(i._container),i._close.bind("click",function(){i.options.close&&i.close()&&"function"==typeof i.options.close&&i.options.close.call(i)})),i.options.css&&i._content.css(i.options.css),i.refresh(),!i.options.show&&i.hide(),!i.options.relative&&t(e).bind("resize",function(){i._refresh()}),i},i.prototype._css=function(t){return parseInt(this.element.css(t).replace(/[^\d]/g,"")||0)},i.prototype.content=function(e,i){var o=this;e=e||o.options.content||o.element.attr("title")||"","string"==typeof e?(o._content.html(e),i&&o._refresh(),!o._content.html()&&o.hide()):"function"==typeof e?(o._content.html(e.call(o)),i&&o._refresh(),!o._content.html()&&o.hide()):"object"==typeof e&&e.url&&t.ajax({url:e.url,type:e.type||"GET",dataType:e.dataType||"json",cache:e.cache||!1,success:function(t){e.success&&o._content.html(e.success.call(o,t)),i&&o._refresh(),!o._content.html()&&o.hide()}})},i.prototype.refresh=function(){var t=this;return t.content(t.options.content,!0),t},i.prototype._refresh=function(){var t=this,e={width:t.element.innerWidth(),height:t.element.innerHeight()},i={left:t._css("margin-left"),right:t._css("margin-right"),top:t._css("margin-top"),bottom:t._css("margin-bottom")},o={width:t._container.innerWidth(),height:t._container.innerHeight()},n=t.options.relative?t.element.position():t.element.offset(),s={width:t.options.width},h={};switch(t.options.position){case"left":s.left=n.left-o.width-t._asize.width+i.left,s.top=t.options.top?n.top-t.options.top+e.height/2+i.top:n.top-o.height/2+e.height/2+i.top,h.right=-t._asize.width/2,h.top=t.options.top?n.top-e.height/2:o.height/2-e.height/2;break;case"right":s.left=n.left+e.width+t._asize.width+i.left,s.top=t.options.top?n.top-t.options.top+e.height/2+i.top:n.top-o.height/2+e.height/2+i.top,h.left=-t._asize.width/2,h.top=t.options.top?n.top-e.height/2:o.height/2-e.height/2;break;case"bottom":s.left=t.options.left?n.left-t.options.left+e.width/2+i.left:n.left-t.options.width/2+e.width/2+i.left,s.top=n.top+e.height+t._asize.height/2,h.left=t.options.left?t.options.left-e.width/2-t._asize.width/2:t.options.width/2-t._asize.width/2,h.top=-t._asize.height/2;break;case"top":s.left=t.options.left?n.left-t.options.left+e.width/2+i.left:n.left-t.options.width/2+e.width/2+i.left,s.top=n.top-o.height-t._asize.height/2,h.left=t.options.left?t.options.left-t._asize.width/2:t.options.width/2-t._asize.width/2,h.bottom=-t._asize.height/2}return t._container.css(s),t._arrow.css(h),t},i.prototype.setOption=function(e){return t.extend(this.options,e),this},i.prototype.show=function(){return this._container.show(),this},i.prototype.hide=function(){return this._container.hide(),this},i.prototype.close=function(){return this.hide(),this},t.fn[o]=function(e){var s,h,r,p;if("string"==typeof e){if(s=arguments,h=e,r=function(){for(var t=0;t<n.length;t++)if(n[t]===h)return!0;return!1},Array.prototype.shift.call(s),"check"==h)return!!this.data("plugin_"+o);if(r())return this.each(function(){var e=t(this).data("plugin_"+o);e&&e[h]&&e[h].apply(e,s)});if(p=this.first().data("plugin_"+o),p&&p[h])return p[h].apply(p,s);throw new TypeError(o+' has no method "'+h+'"')}return this.each(function(){var n=t(this).data("plugin_"+o);n?n.setOption.call(n,e).refresh():t(this).data("plugin_"+o,new i(this,e))})}}(jQuery,window);