(function(a){with(a){
a.$C=function(b){if(B&&!Fb(9)){var c=m;try{c=b.parentNode}catch(d){}return!!c}return rc(b.ownerDocument.body,b)},a.aD=function(b,c){return b.aa.h(c?b.rH:b.QC)};Ln.prototype.Sf=Z(67,function(){var b=this.Vq.body.createTextRange();b.moveToElementText(this.Vq.body);return this.ug(new Ln(b,this.Vq),j)});Vn.prototype.Sf=Z(66,function(){return(!this.ta||$C(this.ta))&&(!this.qa||$C(this.qa))&&(!(B&&!Fb(9))||Zn(this).Sf())});
ao.prototype.Sf=Z(65,function(){var b=m;try{b=z.every(this.Mh(),function(b){return B?!!b.parentNode:rc(b.ownerDocument.body,b)})}catch(c){}return b});ho.prototype.Sf=Z(64,function(){return z.every(wn(this),function(b){return b.Sf()})});Dn.prototype.ej=Z(59,function(){return 3!=this.ba.nodeType?-1:this.ba==this.ta?this.Ba:0});fo.prototype.ej=Z(58,s(0));ko.prototype.ej=Z(57,function(){return this.Uf[this.Wk].ej()});
Gn.prototype.Ud=Z(48,function(){var b=Rb(this.P.startContainer).v("div");b.appendChild(this.P.cloneContents());b=b.innerHTML;if(Ea(b,"<")||!this.isCollapsed()&&!Wa(b,"<"))return b;var c=this.rc(),c=1==c.nodeType?c:c.parentNode;return Mr(c.cloneNode(m)).replace(">",">"+b)});Ln.prototype.Ud=Z(47,function(){return this.P.htmlText});Vn.prototype.Ud=Z(46,function(){return Zn(this).Ud()});ao.prototype.Ud=Z(45,function(){return this.Dg()});ho.prototype.Ud=Z(44,function(){return z.map(wn(this),function(b){return b.Ud()}).join("")});
Dn.prototype.cj=Z(43,function(){return 3!=this.ba.nodeType?-1:this.ba==this.qa?this.ya:this.ba.nodeValue.length});fo.prototype.cj=Z(42,s(0));ko.prototype.cj=Z(41,function(){return this.Uf[this.Wk].cj()});un.prototype.bg=Z(40,function(b){this.isCollapsed()||this.Wc();return this.insertNode(b,j)});ao.prototype.bg=Z(39,function(b){b=this.insertNode(b,j);this.isCollapsed()||this.Wc();return b});
rn.prototype.restore=Z(38,function(b){this.zg&&sn.log(be,"Disposed SavedRange objects cannot be restored.",i);var c=this.ak();b||this.G();return c});$n.prototype.ak=Z(37,function(){return Yn(this.nB,this.AJ,this.fD,this.GL)});go.prototype.ak=Z(36,function(){for(var b=(this.Xa.length?Qb(this.Xa[0]):document).body.createControlRange(),c=0,d=this.Xa.length;c<d;c++)b.addElement(this.Xa[c]);return bo(b)});
lo.prototype.ak=Z(35,function(){var b=z.map(this.jz,function(b){return b.restore()}),c=new ho;c.bm=b;c.Qe=z.map(b,function(b){return b.Rd()});return c});En.prototype.Dg=Z(28,function(){var b=new Kr;P.forEach(this,function(c,d,e){3==c.nodeType?b.append(Va(c.nodeValue.substring(e.ej(),e.cj()))):1==c.nodeType&&(-1==e.$b?fc(c)&&b.append("</"+c.tagName+">"):(d=c.cloneNode(m),d=Mr(d),B&&"LI"==c.tagName?b.append(d):(c=d.lastIndexOf("<"),b.append(c?d.substr(0,c):d))))},this);return b.toString()});
Vn.prototype.Dg=Z(27,function(){return Zn(this).Dg()});ao.prototype.Dg=Z(26,function(){return z.map(eo(this),Mr).join("")});ho.prototype.Dg=Z(25,function(){return this.Ud()});ej.prototype.ii=Z(23,function(b,c){var d=b.zd(),e=this.L()+"-collapse-left",g=this.L()+"-collapse-right";b.Yi(d?g:e,!!(c&1));b.Yi(d?e:g,!!(c&2))});vj.prototype.ii=Z(22,function(b){this.M.ii(this,b)});tn.prototype.hp=Z(18,function(){var b=this.Jc?-1:1;this.$b==b&&(this.$b=-1*b,this.depth+=this.$b*(this.Jc?-1:1))});
Dn.prototype.hp=Z(17,function(){Dn.n.hp.apply(this);rc(this.ba,this.qa)&&f(P.Za)});Hd.prototype.setInterval=Z(11,function(b){this.Jg=b;this.pa&&this.enabled?(this.stop(),this.start()):this.pa&&this.stop()});qq.prototype.vw=Z(10,function(){return this.h().innerHTML});Cn.prototype.gh=Z(9,function(b,c){this.insertNode(b,j);this.insertNode(c,m)});
Gn.prototype.gh=Z(8,function(b,c){var d=$b(Qb(this.U()));if(d=no(d))var e=d.U(),g=d.fa(),h=d.sa(),k=d.Ia();var n=this.P.cloneRange(),q=this.P.cloneRange();n.collapse(m);q.collapse(j);n.insertNode(c);q.insertNode(b);n.detach();q.detach();if(d){if(3==e.nodeType)for(;h>e.length;){h-=e.length;do e=e.nextSibling;while(e==b||e==c)}if(3==g.nodeType)for(;k>g.length;){k-=g.length;do g=g.nextSibling;while(g==b||g==c)}Yn(e,h,g,k).select()}});
Ln.prototype.gh=Z(7,function(b,c){var d=this.P.duplicate(),e=this.P.duplicate();Rn(d,b,j);Rn(e,c,m);this.ne()});Vn.prototype.gh=Z(6,function(b,c){Zn(this).gh(b,c);this.ne()});Gn.prototype.Wc=Z(5,function(){var b=this.P;b.extractContents();if(b.startContainer.hasChildNodes()&&(b=b.startContainer.childNodes[b.startOffset])){var c=b.previousSibling;""==Fc(b)&&M(b);c&&""==Fc(c)&&M(c)}});
Ln.prototype.Wc=Z(4,function(){if(!this.isCollapsed()&&this.P.htmlText){var b=this.U(),c=this.fa(),d=this.P.text,e=this.P.duplicate();e.moveStart("character",1);e.moveStart("character",-1);e.text==d&&(this.P=e);this.P.text="";this.ne();d=this.U();e=this.sa();try{var g=b.nextSibling;b==c&&(b.parentNode&&3==b.nodeType&&g&&3==g.nodeType)&&(b.nodeValue+=g.nodeValue,M(g),this.P=Nn(d),this.P.move("character",e),this.ne())}catch(h){}}});Vn.prototype.Wc=Z(3,function(){Zn(this).Wc();this.ne()});
ao.prototype.Wc=Z(2,function(){if(this.P){for(var b=[],c=0,d=this.P.length;c<d;c++)b.push(this.P.item(c));z.forEach(b,M);this.collapse(m)}});ho.prototype.Wc=Z(1,function(){z.forEach(wn(this),function(b){b.Wc()})});
a.bD=function(b,c){var d=c.jd();b.nd[d]&&b.Kb.log(be,"Cannot register the same class of plugin twice.",i);b.nd[d]=c;for(var e in Su)c[Su[e]]&&b.rj[e].push(c);c.C=b;b.Vd()&&c.enable(b)},a.cD=function(b){return b.C&&b.C.gb},a.dD=function(b){var c=b.ba.parentNode;return new Hr(c,z.indexOf(c.childNodes,b.ba))},a.eD=function(b,c,d,e){return Yn(b,c,d,e)},a.fD=function(b){N.call(this);this.rH=db();this.QC=db();this.aa=Rb(b.Ca());b.gh(this.aa.v("SPAN",{id:this.rH}),this.aa.v("SPAN",{id:this.QC}))};y(fD,rn);
fD.prototype.Lo=function(b){M(aD(this,j));M(aD(this,m));return b};fD.prototype.ak=function(){var b=l,c=aD(this,j),d=aD(this,m);if(c&&d){var b=c.parentNode,c=z.indexOf(b.childNodes,c),e=d.parentNode,d=z.indexOf(e.childNodes,d);e==b&&(d-=1);b=Yn(b,c,e,d);b=this.Lo(b);b.select()}else this.Lo();return b};fD.prototype.w=function(){this.Lo();this.aa=l};
a.gD=function(b){var c;if(3==b.ba.nodeType)for(c=b.ba.previousSibling;c&&3==c.nodeType;c=c.previousSibling)b.offset+=Ir(c);else c=b.ba.previousSibling;var d=b.ba.parentNode;b.ba=c?c.nextSibling:d.firstChild;return b},a.hD=function(b,c){return c?Jr(b.U(),b.sa()):Jr(b.fa(),b.Ia())},a.iD=function(b){for(var c=l,d=b.firstChild;d;){var e=d.nextSibling;3==d.nodeType?""==d.nodeValue?b.removeChild(d):c?(c.nodeValue+=d.nodeValue,b.removeChild(d)):c=d:(iD(d),c=l);d=e}},a.jD=function(b){var c=b&&b.nodeName.toLowerCase();
return!(!b||"block"!=(1!=b.nodeType?l:B?Wf(b,"display"):Vf(b,"display"))&&!("td"==c||"table"==c||"li"==c))},a.kD=function(b){return Gc(b,jD,j)},a.lD=function(b,c){if(c){var d,e=gD(hD(c,j)),g=dD(e),h=e.ba.previousSibling;3==e.ba.nodeType&&(e.ba=l);var k=gD(hD(c,m)),n=dD(k),q=k.ba.previousSibling;3==k.ba.nodeType&&(k.ba=l);d=function(){!e.ba&&h&&(e.ba=h.nextSibling,e.ba||(e=new Hr(h,Ir(h))));!k.ba&&q&&(k.ba=q.nextSibling,k.ba||(k=new Hr(q,Ir(q))));return Yn(e.ba||g.ba.firstChild||g.ba,e.offset,k.ba||
n.ba.firstChild||n.ba,k.offset)};var r=kD(c.Bb())}r?(r=vc(r,b),B?iD(r):r.normalize()):b&&(B?iD(b):b.normalize());return d?d():l},a.mD=function(b,c,d){Qs.call(this,c,b||dz.N(),d)};y(mD,Qs);a.nD=function(b){return b.getAttribute&&"true"==b.getAttribute("g_editable")},a.oD=function(b){fD.call(this,b)};y(oD,fD);oD.prototype.Lo=function(b){var c=aD(this,j),d=aD(this,m),c=c&&d?vc(c,d):c||d;oD.n.Lo.call(this);if(b)return lD(c,b);c&&(b=no($b(Qb(c))),(b=lD(c,b))&&b.select())};
a.pD=function(b,c,d){for(var e=(c=1==c)?b.U():b.fa(),g=c?b.sa():b.Ia(),h=b.Bb();e!=h&&e!=d&&!(c&&0!=g||!c&&g!=Ir(e));)var k=e.parentNode,e=z.indexOf(k.childNodes,e),g=c?e:e+1,e=k;return eD(c?e:b.U(),c?g:b.sa(),c?b.fa():e,c?b.Ia():g)},a.qD=function(b){sg(b,m);if(wo)for(var c=b,b=b.parentNode;b&&"HTML"!=b.tagName;){if(rg?"none"==b.style[rg].toLowerCase():(B||rb)&&"on"==b.getAttribute("unselectable")){sg(b,m,j);for(var d=0,e=b.childNodes.length;d<e;d++){var g=b.childNodes[d];g!=c&&1==g.nodeType&&sg(b.childNodes[d],
j)}}c=b;b=b.parentNode}},a.rD=function(b){var c=b.target.tagName;"TEXTAREA"!=c&&"INPUT"!=c&&b.preventDefault()},a.sD=void 0,a.tD=function(b){var c=b.Bb();return b.U()!=c.parentElement&&nD(c)||!!Gc(c,nD)},a.uD=function(b,c){var d=pD(b,1,c),d=pD(d,0,c),e=d.U(),g=d.fa(),h=d.sa(),d=d.Ia();if(e==g){for(;g!=c&&0==h&&d==Ir(g);)e=g.parentNode,h=z.indexOf(e.childNodes,g),d=h+1,g=e;e=g}return Yn(e,h,g,d)},a.vD=function(b,c){wo&&c.e(b,"mousedown",rD,j);sg(b,j);for(var d=b.getElementsByTagName("INPUT"),e=0,g=
d.length;e<g;e++){var h=d[e];h.type in Po&&qD(h)}z.forEach(b.getElementsByTagName("TEXTAREA"),qD)},a.wD=function(b){return!!No[b.tagName]},a.xD=function(b){return as(P.filter(new Zr(b),$r))},a.yD=void 0,a.zD=function(b){var c=arguments,d=c.length;return function(){for(var b=0;b<d;b++)if(!c[b].apply(this,arguments))return m;return j}},a.AD=function(b){this.Af=b;this.lO=j;this.Xv=[]},a.BD=function(b){b.vv||(b.vv=Fc(b.Af));return b.vv};a.CD=function(){Ru.call(this)};y(CD,Ru);CD.prototype.jd=s("BTF");CD.prototype.Kb=ke("goog.editor.plugins.BasicTextFormatter");
a.DD={EI:"+link",pU:"+formatBlock",CU:"+indent",dV:"+outdent",GV:"+strikeThrough",yU:"+insertHorizontalRule",HV:"+subscript",IV:"+superscript",SV:"+underline",ST:"+bold",EU:"+italic",nU:"+fontSize",mU:"+fontName",lU:"+foreColor",MT:"+backColor",bV:"+insertOrderedList",WV:"+insertUnorderedList",FU:"+justifyCenter",GU:"+justifyFull",IU:"+justifyRight",HU:"+justifyLeft"},a.ED=H.Am(DD);t=CD.prototype;t.Be=function(b){return b in ED};t.se=function(){return tv(this.C)};a.FD=function(b){return cD(b).Ca()};
t.Ze=function(b,c){var d,e,g,h,k,n=c;switch(b){case "+backColor":if(n!==l)if(Co){e=n;g=tv(this.C);var q,r;g&&g.isCollapsed()&&(q=cD(this).createTextNode(C?" ":""),n=g.U(),r=1==n.nodeType?n:n.parentNode,""==r.innerHTML?(r.style.textIndent="-10000px",r.appendChild(q)):(r=cD(this).v("span",{style:"text-indent:-10000px"},q),g.bg(r)),An(q).select());GD(this,"hiliteColor",e,m,j);q&&(C&&(q.data=""),r.style.textIndent="")}else rb?GD(this,"hiliteColor",n):GD(this,b,n);break;case "+link":a:{k=n;this.C.hf||
cD(this).Oa().focus();g=(e=this.se())&&e.Bb();if((g=Hc(g,"A"))&&Gc(g,nD))mc(g);else{g=l;var w=[];if((n=e&&e.Bb())&&"IMG"==n.tagName)k=l;else{if(e&&e.isCollapsed())e=e.te(0).Rd(),to?(g=cD(this).createElement("A"),e.insertNode(g)):so&&(e.pasteHTML("<a id='newLink'></a>"),g=cD(this).h("newLink"),g.removeAttribute("id"));else{var A=db();GD(this,"CreateLink",A);z.forEach(this.C.h().getElementsByTagName("A"),function(b){Fa(b.href,A)&&w.push(b)});w.length&&(g=w.pop())}e=g;g=new AD(e);g.Af.href="/";k&&(e.target=
k);w&&(g.Xv=w);k=g}if(k){if(!this.C.execCommand("link",k))if(h=this.C.Hk.prompt(Wz,"http://"))if(e=k,g=BD(k)||h,n=e.Af,n.href=h,q=BD(e),g!=q&&(h=rs(n),3==h.nodeType&&(h=h.parentNode),Fc(h)!=q&&(h=n),hc(h),n=Rb(h),h.appendChild(n.createTextNode(g)),e.vv=l),e.lO=m,e=k.Af,Go){g=e.nextSibling;if(!g||!(3==g.nodeType&&(Ea(g.data," ")||Ea(g.data," "))))g=Rb(e).createTextNode(" "),jc(g,e);po(g,1).select()}else Qr(e,m);else{e=An(k.Af);e=new oD(e);mc(k.Af);for(k.Af=l;k.Xv.length;)mc(k.Xv.pop());e.restore().select();
k=l;break a}break a}}k=l}break;case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":GD(this,b,l,m,j);C&&GD(this,b,l,m,j);(!Ao||!C)&&P.forEach(tv(this.C),HD);break;default:B&&("+formatBlock"==b&&n)&&(n="<"+n+">");if("+foreColor"==b&&n===l)break;switch(b){case "+indent":case "+outdent":Ao&&(C&&(e=j),rb&&(e="+outdent"==b?!FD(this).queryCommandEnabled("outdent"):j));case "+insertOrderedList":case "+insertUnorderedList":if(q=Jo)q=FD(this),q=ID(this,j,q,b,i);if(q)g="P"!=this.C.queryCommandValue("+defaultTag");
else if(!Ko&&(B||rb)){d=this.se();q=d.Bb();var G=FD(this);JD.lastIndex=0;JD.test(q.innerHTML)&&(d=d.U()&&d.fa()?new fD(d):l,"P"==q.tagName?KD(q,j):(q.innerHTML=q.innerHTML.replace(JD,'<p$1 trtempbr="temp_br">'),q=z.toArray(q.getElementsByTagName("P")),P.forEach(q,function(b){if("temp_br"==b.getAttribute("trtempbr")){b.removeAttribute("trtempbr");if(Yr(Ec(b))){var c=B?G.createTextNode(" "):G.createElement("BR");b.appendChild(c)}KD(b)}})),d.restore())}C&&(Io&&!this.queryCommandValue(b))&&(q=this.C.queryCommandValue("+defaultTag"),
"P"==q||"DIV"==q?q=m:(q=this.se(),q.isCollapsed()&&3!=q.rc().nodeType?(d=cD(this).createTextNode(" "),q.insertNode(d,m),An(d).select(),q=j):q=m),h|=q);case "+formatBlock":d=!!this.C.Ph("Bidi");break;case "+subscript":case "+superscript":Ho&&!this.queryCommandValue(b)&&(q="+subscript"==b?"+superscript":"+subscript",r=LD(q),this.queryCommandValue(q)||FD(this).execCommand(r,m,l),FD(this).execCommand(r,m,l));break;case "+underline":case "+bold":case "+italic":e=C&&Ao&&this.queryCommandValue(b);break;
case "+foreColor":case "+fontName":e=Ao&&C}GD(this,b,n,d,!!e);h&&FD(this).execCommand("Delete",m,j);g&&FD(this).execCommand("FormatBlock",m,"<div>")}C&&!this.C.Hg&&cD(this).Oa().focus();return k};
t.queryCommandValue=function(b){var c;switch(b){case "+link":return b=(b=this.se())&&b.Bb(),b=Hc(b,"A"),!!b&&!!Gc(b,nD);case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":return MD(this,b);case "+formatBlock":var b=tv(this.C),d=l;P.forEach(b,function(b,c,e){-1!=e.$b&&(b=kD(b).tagName,d=d||b,d!=b&&(d=l,f(P.Za)),e.hp())});return d;case "+indent":case "+outdent":case "+insertHorizontalRule":return m;case "+fontSize":case "+fontName":case "+foreColor":case "+backColor":return this.Zs(FD(this),
b,Ao&&C);case "+underline":case "+bold":case "+italic":c=Ao&&C;default:var e=FD(this);return ID(this,j,e,b,c)}};t.xG=function(b){yo&&b.match(/^\s*<script/i)&&(b="&nbsp;"+b);zo&&(b=b.replace(/<(\/?)strong([^\w])/gi,"<$1b$2"),b=b.replace(/<(\/?)em([^\w])/gi,"<$1i$2"));return b};
t.oK=function(b){for(var b=b.getElementsByTagName("IMG"),c=0,d;d=b[c];c++)if(B){d.removeAttribute("tabIndex");d.removeAttribute("tabIndexSet");var e=d;"removeAttribute"in e&&e.removeAttribute(sa);try{delete e[sa]}catch(g){}d.hP&&(d.tabIndex=d.hP)}};t.pK=function(b){if(D){for(var c=Sb(this.C.gb.Ha,"HEAD",i,i),d=[],e=c.length,g=1;g<e;++g)for(var h=c[g].getElementsByTagName("STYLE"),k=h.length,n=0;n<k;++n)d.push(h[n].outerHTML);return d.join("")+b}return b};
t.Br=function(b,c,d){if(!d)return m;var e;switch(c){case "b":e="+bold";break;case "i":e="+italic";break;case "u":e="+underline";break;case "s":return j}return e?(this.C.execCommand(e),j):m};
a.JD=B?/<br([^\/>]*)\/?>/gi:/<br([^\/>]*)\/?>(?!<\/(div|p)>)/gi,a.KD=function(b,c){if(B||rb){var d=b.outerHTML.replace(/<(\/?)p/gi,"<$1div");c&&(d=d.replace(JD,"</div><div$1>"));rb&&!/<\/div>$/i.test(d)&&(d+="</div>");b.outerHTML=d}},a.LD=function(b){return 0==b.indexOf("+")?b.substring(1):b},a.HD=function(b){b=kD(b);b.align&&(b.style.textAlign=b.align,b.removeAttribute("align"))},a.GD=function(b,c,d,e,g){var h=l;e&&(h=b.C.queryCommandValue("rtl")?"rtl":b.C.queryCommandValue("ltr")?"ltr":l);var c=
LD(c),k,n;if(B){var q=c;n=[];var e=l,r=b.se();k=cD(b);if(q in ND){var w=r&&r.Bb();if(w){for(var A=Tb("BLOCKQUOTE",l,w),G,I=0;I<A.length;I++)if(r.containsNode(A[I])){G=A[I];break}if(w=G||Hc(w,"BLOCKQUOTE"))e=k.v("div",{style:"height:0"}),w.appendChild(e),n.push(e),G?r=Yn(G,0,e,0):r.containsNode(e)&&(r=eD(r.U(),r.sa(),e,0)),r.select()}}G=b.C;!G.nc()&&!e&&q in OD&&(G=G.h(),r&&(r.isCollapsed()&&!pc(G))&&(e=r.te(0).Rd(),r=e.duplicate(),r.moveToElementText(G),r.collapse(m),r.isEqual(e)&&(r=k.createTextNode(" "),
G.appendChild(r),e.move("character",1),e.move("character",-1),e.select(),n.push(r))),e=k.v("div",{style:"height:0"}),G.appendChild(e),n.push(e));k=n[0];n=n[1]}if(D){k=c;var Q;PD[k]&&(Q=cD(b).v("div",{style:"height: 0"},"x"),b.C.h().appendChild(Q));QD[k]&&(k=b.C.h(),Q=cD(b).v("div",{style:"height: 0"},"x"),k.insertBefore(Q,k.firstChild));k=Q}if(C&&(Q=c,E("1.9")&&"formatblock"==Q.toLowerCase()&&(Q=b.se(),G=Q.U(),Q.isCollapsed()&&(G&&"BODY"==G.tagName)&&(e=Q.sa(),(G=G.childNodes[e])&&"BR"==G.tagName))))Q=
Q.Rd(),Q.setStart(G,0),Q.setEnd(G,0);if(Lo&&"fontsize"==c.toLowerCase()){var X=uD(tv(b.C),b.C.h());P.forEach(P.filter(X,function(b,c,d){return 1==d.$b&&X.containsNode(b)}),function(b){Tf(b,"font-size","");C&&(0==b.style.length&&b.getAttribute("style")!=l)&&b.removeAttribute("style")})}Q=FD(b);if(g&&Ao&&(Q.execCommand("styleWithCSS",m,j),rb)){G=[];e=tv(b.C).Bb();do G.push(e);while(e=e.parentNode);G=P.eK(P.ad(tv(b.C)),P.ad(G));G=P.filter(G,jD);P.forEach(G,function(b){var c=b.style.outline;b.style.outline=
"0px solid red";b.style.outline=c})}Q.execCommand(c,m,d);g&&Ao&&Q.execCommand("styleWithCSS",m,m);D&&(!E("526")&&"formatblock"==c.toLowerCase()&&d&&/^[<]?h\d[>]?$/i.test(d))&&P.forEach(b.se(),function(b){"Apple-style-span"==b.className&&(b.style.fontSize="",b.style.fontWeight="")});if(/insert(un)?orderedlist/i.test(c)){if(D){var na=m;P.forEach(b.se(),function(b){var c=b.tagName;if("UL"==c||"OL"==c)if(na){if(c=qc(b)){var d=b.ownerDocument.createRange();d.setStartAfter(c);d.setEndBefore(b);if(Ha(d.toString())&&
c.nodeName==b.nodeName){for(;c.lastChild;)b.insertBefore(c.lastChild,b.firstChild);c.parentNode.removeChild(c)}}}else na=j})}if(B){for(c=(c=b.se())&&c.rc();c&&"UL"!=c.tagName&&"OL"!=c.tagName;)c=c.parentNode;c&&(c=c.parentNode);c&&(d=z.toArray(c.getElementsByTagName("UL")),z.extend(d,z.toArray(c.getElementsByTagName("OL"))),z.forEach(d,function(b){var c=b.type;if(c&&!("UL"==b.tagName?RD:SD)[c])b.type=""}));n&&M(n)}}k&&M(k);h&&b.C.execCommand(h)},a.OD={indent:1,outdent:1,insertOrderedList:1,insertUnorderedList:1,
justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,ltr:1,rtl:1},a.ND={insertOrderedList:1,insertUnorderedList:1},a.SD={1:1,a:1,A:1,i:1,I:1},a.RD={disc:1,circle:1,square:1},a.PD={justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,formatBlock:1},a.QD={insertOrderedList:1,insertUnorderedList:1},a.TD={center:1,justify:1,right:1,left:1},a.MD=function(b,c){var d=c.replace("+justify","").toLowerCase();"full"==d&&(d="justify");var e=b.C.Ph("Bidi");if(e)return d==e.WW();var g=b.se();if(!g)return m;
for(var h=g.Bb(),e=z.filter(h.childNodes,function(b){return $r(b)&&g.containsNode(b,j)}),e=e.length?e:[h],h=0;h<e.length;h++){var k=kD(e[h]),n=d,q=Xf(k,"textAlign"),q=q.replace(/^-(moz|webkit)-/,"");TD[q]||(q=k.align||"left");if(n!=q)return m}return j};CD.prototype.Zs=function(b,c,d){return ID(this,m,b,c,d)};a.ID=function(b,c,d,e,g){e=LD(e);if(g){var h=FD(b);h.execCommand("styleWithCSS",m,j)}b=c?d.queryCommandState(e):d.queryCommandValue(e);g&&h.execCommand("styleWithCSS",m,m);return b};a.UD=function(b,c){N.call(this);this.Hs=[];for(this.Ds=[];b&&"BODY"!=b.nodeName&&b!=c;){for(var d=0,e=b.previousSibling;e;)e=e.previousSibling,++d;this.Hs.unshift(d);this.Ds.unshift(b.nodeName);b=b.parentNode}};y(UD,N);UD.prototype.toString=function(){for(var b=[],c,d=0;c=this.Ds[d];d++)b.push(this.Hs[d]+","+c);return b.join("\n")};a.VD=function(b,c){for(var d,e=c,g=0;d=b.Ds[g];++g)if(e=e.childNodes[b.Hs[g]],!e||e.nodeName!=d)return l;return e};UD.prototype.w=function(){delete this.Hs;delete this.Ds};ke("goog.editor.plugins.Blockquote");a.WD=function(){Ru.call(this)};y(WD,Ru);t=WD.prototype;t.ih="DIV";t.jd=s("EnterHandler");t.enable=function(b){WD.n.enable.call(this,b);Mo&&("P"==this.ih||"DIV"==this.ih)&&cD(this).Ca().execCommand("opera-defaultBlock",m,this.ih)};t.xG=function(b){return!b||Yr(b)?yo?this.VL():"":b};t.VL=lf("<br>");
t.HM=function(b){if(C&&this.C.Hg)return m;if(8==b.keyCode){var c=tv(this.C),d=this.C.h(),c=c&&c.U();d.firstChild==c&&Js(c)&&(b.preventDefault(),b.stopPropagation())}else if(13==b.keyCode)if(C){if(!b.shiftKey){var d=tv(this.C),c=!d||d.isCollapsed(),e=to?XD(this):YD(this),g=this.C.execCommand("+splitBlockquote",e);g&&(b.preventDefault(),b.stopPropagation());to||e.removeNode(j);g||this.zM(b,c,d)}}else{this.C.Eh();d=to?XD(this):YD(this);if(c=!!this.C.execCommand("+splitBlockquote",d))b.preventDefault(),
b.stopPropagation();to||d.removeNode(j);D&&this.AM(b);if(B||rb)ZD(this);else if(!c&&D){if(c=d=tv(this.C))a:{for(c=d.Bb();c;c=c.parentNode)if(wD(c)){c="BLOCKQUOTE"==c.tagName;break a}c=m}if(c){c=cD(this);e=c.createElement("BR");d.insertNode(e,j);if(d=wD(e.parentNode)){for(d=e.nextSibling;d&&3==d.nodeType&&!d.nodeValue;)d=d.nextSibling;d=!d}d&&ic(c.createElement("BR"),e);Qr(e,m);b.preventDefault()}}this.C.We()}else if(C&&46==b.keyCode&&(c=tv(this.C),c.isCollapsed()&&(d=c.fa(),1==d.nodeType&&(c=d.childNodes[c.Ia()])&&
"BR"==c.tagName)))e=as(P.filter(new Zr(c,m,j),$r)),g=c.nextSibling,d.removeChild(c),b.preventDefault(),g&&wD(g)&&(e&&!("BR"==e.tagName||wD(e))?po(e,Ir(e)).select():(b=rs(g),po(b,0).select()));return m};t.Ar=function(b){if(C&&this.C.Hg)return m;(B||rb)&&13==b.keyCode&&ZD(this,j);return m};t.AM=ha;t.zM=ha;
a.$D=H.Ch("LI","DIV","H1","H2","H3","H4","H5","H6"),a.ZD=function(b,c){for(var d=tv(b.C),e=d.rc(),g=b.C.h(),h;e&&e!=g;){var k=e.nodeName;if("DIV"==k||$D[k]&&(!c||!(Js(e)&&1==e.getElementsByTagName("BR").length))){if(rb&&h){"DIV"==k&&(h==e.lastChild&&Js(h))&&(jc(h,e),An(h).select());break}return}rb&&(c&&"P"==k&&"DIV"!=k)&&(h=e);e=e.parentNode}if(B&&!E(9)){var n=m,d=d.Rd(),e=d.duplicate();e.moveEnd("character",1);if(e.text.length&&(n=e.parentElement(),e=e.duplicate(),e.collapse(m),e=e.parentElement(),
n=n!=e&&e!=d.parentElement()))d.move("character",-1),d.select()}b.C.gb.Ca().execCommand("FormatBlock",m,"<DIV>");n&&(d.move("character",1),d.select())},a.YD=function(b){var b=cD(b).Ca(),c=b.selection.createRange(),d=db();c.pasteHTML('<span id="'+d+'"></span>');b=b.getElementById(d);b.id="";return b},a.XD=function(b){b=tv(b.C);if(!b.isCollapsed()){var c=j;if(rb){var d=b.U(),e=b.sa();d==b.fa()&&(d.lastChild&&"BR"==d.lastChild.tagName&&e==d.childNodes.length-1)&&(c=m)}if(c){var g=b;if(g&&!g.isCollapsed()){var h=
j,c=g.Bb(),d=new UD(g.U(),c),e=g.sa(),k;k=g;var n=k.U();jD(n)&&(n=n.childNodes[k.sa()]||n);var n=kD(n),q=k.fa();jD(q)&&(q=q.childNodes[k.Ia()]||q);q=kD(q);k=n==q;if(n=!k)a:{var q=g,n=q.fa(),q=q.Ia(),r=n;if(jD(r)){var w=r.childNodes[q];if(!w||1==w.nodeType&&jD(w)){n=m;break a}}for(w=kD(r);w!=r;){if(xD(r)){n=j;break a}r=r.parentNode}n=q!=Ir(n)}g.Wc();(g=VD(d,c))?g=po(g,e):(g=po(c,c.childNodes.length),h=m);g.select();k&&(k=kD(g.U()),Js(k,j)&&(h="&nbsp;",rb&&"LI"==k.tagName&&(h="<br>"),k.innerHTML=h,
Is(k.firstChild),h=m));n&&(g=kD(g.U()),k=xD(g),g&&k&&(gc(g,k.childNodes),M(k)));h&&(g=po(VD(d,c),e),g.select())}}}return hD(b,j)};a.aE=function(){},a.bE=new aE,a.cE=["click",C?"keypress":"keydown"];aE.prototype.e=function(b,c,d,e,g){function h(b){if("click"==b.type&&md(b))c.call(e,b);else if(13==b.keyCode||3==b.keyCode)b.type="keypress",c.call(e,b)}h.Dj=c;h.ot=e;g?g.e(b,cE,h):O(b,cE,h)};aE.prototype.Fa=function(b,c,d,e,g){for(var h=0;d=cE[h];h++){var k;k=xd(b,d,m)||[];for(var n,q=0;n=k[q];q++)if(n.Vf.Dj==c&&n.Vf.ot==e){g?g.Fa(b,d,n.Vf):wd(b,d,n.Vf);break}}};a.eE=function(b){N.call(this);this.uk=b||window;this.us=O(this.uk,"resize",this.Uw,m,this);this.kc=Xb(this.uk);if(D&&lb||rb&&this.uk.self!=this.uk.top)this.$t=window.setInterval(v(this.NB,this),dE)};y(eE,Fd);a.dE=500;t=eE.prototype;t.us=l;t.uk=l;t.kc=l;t.$t=l;t.xl=function(){return this.kc?this.kc.clone():l};t.w=function(){eE.n.w.call(this);this.us&&(yd(this.us),this.us=l);this.$t&&(window.clearInterval(this.$t),this.$t=l);this.kc=this.uk=l};t.Uw=function(){this.NB()};
t.NB=function(){var b=Xb(this.uk);Ob(b,this.kc)||(this.kc=b,this.dispatchEvent("resize"))};a.gE=function(b,c){N.call(this);this.aa=Rb(b);this.O=new le(this);this.wA=new eE(this.aa.Oa());this.md={};this.sd=this.aa.v("DIV",{className:fE});R(this.sd,m);b.appendChild(this.sd);Tf(this.sd,"zIndex",c);this.Um=this.sd;this.uK=this.aa.v("DIV",{className:"tr_bubble_closebox",innerHTML:"&nbsp;"});this.Um.appendChild(this.uK);vD(this.sd,this.O);this.ci=new Ph(this.sd)};y(gE,Fd);a.fE="tr_bubble";t=gE.prototype;t.Kb=ke("goog.ui.editor.Bubble");
t.w=function(){gE.n.w.call(this);M(this.sd);this.sd=l;this.O.G();this.O=l;this.wA.G();this.wA=l};t.V=p("Um");t.Bb=p("sd");t.pN=function(){this.Q()&&this.Y()};t.XM=function(){for(var b in this.md)M(this.md[b].element);this.md={};F.remove(this.sd,"tr_multi_bubble");this.O.removeAll();this.dispatchEvent("hide")};t.Q=function(){return this.ci.Q()};a.hE=B?4:2,a.iE=new Of(hE,0,hE,0);
gE.prototype.Y=function(){var b=l,c=j,d;for(d in this.md)var e=this.md[d],b=e.Zz,c=c&&e.TQ;d=496;b=eg(this.sd)!=eg(b);c&&(d=jE(this,b?7:5,4,9));d&496&&(d=jE(this,b?6:4,5,9));d&496&&(d=jE(this,b?7:5,4,5),d&496&&this.Kb.rk("reposition(): positionAtAnchor() failed with "+d))};
a.jE=function(b,c,d,e){var g=l,h;for(h in b.md){var k=b.md[h].Zz;if(!g||rc(k,g))g=b.md[h].Zz}return Hm(g,c,b.sd,d,l,iE,e)},a.kE=function(b,c,d,e,g,h){this.type=d;this.Zz=g;this.TQ=h;this.element=b.v("DIV",{className:"tr_bubble_panel",id:c},b.v("DIV",{className:"tr_bubble_panel_title"},e+":"),b.v("DIV",{className:"tr_bubble_panel_content"}))};kE.prototype.V=function(){return this.element.lastChild};a.lE=function(){Ru.call(this);this.gc=new le(this)};y(lE,Ru);a.mE=function(b,c){return new gE(b,c)},a.nE={};t=lE.prototype;t.Oj=l;t.Gx=m;t.jd=lf("AbstractBubblePlugin");t.Ar=function(){this.Q()&&this.lj();return m};
t.lj=function(b,c){var d;if(b)d=b.target;else if(c)d=c;else{var e=tv(this.C);if(e){var g=e.U(),h=e.fa(),k=e.sa(),n=e.Ia();B&&(e.isCollapsed()&&g!=h)&&(e=po(g,k));1==g.nodeType&&(g==h&&k==n-1)&&(g=g.childNodes[k],1==g.nodeType&&(d=g))}d=d||e&&e.Bb()}var q;a:{if(d&&(k=this.SL(d))){if(k!=this.Kt||!this.Oj){oE(this);this.$g&&Ur(this.$g);d=pE(this);var r=this.ow();if(!H.some(d.md,function(b){return b.type==r})){this.Kt=k;var g=this.ow(),n=this.pD(),h=v(this.LK,this),w=this.fS(),e=db(),k=new kE(d.aa,e,
g,n,k,!w);d.md[e]=k;n=0;for(w=d.Um.childNodes.length-1;n<w;n++){var A=d.Um.childNodes[n];if(d.md[A.id].type>g){q=A;break}}ic(k.element,q||d.Um.lastChild);h(k.V());vD(k.element,d.O);q=H.Sa(d.md);1==q?(d.O.e(d.wA,"resize",d.pN).e(d.ci,"hide",d.XM),d.ci.D(j),d.Y()):2==q&&F.add(d.sd,"tr_multi_bubble");d.Y();this.Oj=e;this.gc.e(d,"hide",this.PD);this.ai();this.Gx&&this.gc.e(d.V(),"keydown",this.qP);this.gc.e(d.V(),"mouseover",function(){this.$g&&this.$g.stop()},this)}}else this.$g&&this.$g.stop();q=m;
break a}oE(this);q=m}return q};t.disable=function(b){if(b.Fj==dv){var c=nE[b.id];c&&(c.G(),delete nE[b.id])}};a.pE=function(b){var c=b.kW||b.C.Hk.document.body;b.aa=Rb(c);var d=nE[b.C.id];d||(d=mE.call(l,c,b.C.WJ||0),nE[b.C.id]=d);return d};t.ow=s("");t.pD=s("");t.fS=mf;
a.oE=function(b){if(b.Oj&&(!b.$g||!b.$g.Xb()))b.$g=new Mj(function(){if(this.Oj){var b=pE(this),d=this.Oj;M(b.md[d].element);delete b.md[d];d=H.Sa(b.md);1>=d&&F.remove(b.sd,"tr_multi_bubble");0==d?b.ci.D(m):b.Y();this.PD()}},250,b),b.$g.start()};t.ai=ha;t.PD=function(){this.Oj=this.Kt=l;this.gc.removeAll()};t.Rw=function(b){if(this.Gx&&this.Q()&&9==b.keyCode&&!b.shiftKey){var c=pE(this).V();if(c=K("tr_bubble_link",c))return c.focus(),b.preventDefault(),j}return m};
t.qP=function(b){if(this.Q()&&9==b.keyCode){var c=pE(this).V(),c=Ub("tr_bubble_link",c);if(b.shiftKey?c[0]==b.target:c.length&&c[c.length-1]==b.target)this.C.focus(),b.preventDefault()}};t.Q=function(){return!!this.Oj};t.Y=function(){var b=pE(this);b&&b.Y()};
t.Kq=function(b,c,d,e,g){c=this.aa.v("SPAN",{className:"tr_bubble_link"},g?this.aa.v("I",{className:g},c):c);this.Gx&&c.setAttribute("tabindex",0);c.setAttribute("role","link");e?e.appendChild(c):(e=this.aa.h(b))&&lc(c,e);c.id=b;vD(c,this.gc);d&&(b=this.gc,bE.e(c,d,i,b.da||b,b));return c};x("Go to link: ");x("Change");x("Remove");a.qE=function(b){N.call(this);this.ed=b};y(qE,Fd);qE.prototype.show=function(){this.Ve||(this.Ve=this.ov(),this.Ve.addEventListener(di,this.bM,m,this));this.Ve.D(j)};qE.prototype.hide=function(){this.Ve&&this.Ve.D(m)};qE.prototype.qb=function(){return!!this.Ve&&this.Ve.Q()};a.rE=function(b){this.el=b;this.xi=new Uh("",j,this.el.ed);this.Xm=new bi(this.el.ed);this.Wm={};this.sh("tr-dialog")};rE.prototype.Va=function(b){this.xi.Va(b);return this};
a.sE=function(b,c){var d=x("OK");b.Xm.set("ok",c||d,j);b.Wm.ok=v(b.el.UM,b.el)},a.uE=function(b){var c=ii,d=x("取消");b.Xm.set(c,d,m,j);b.Wm[c]=v(b.el.Gw,b.el);return b};rE.prototype.he=function(b,c,d){d=d||db();this.Xm.set(d,b);this.Wm[d]=c;return this};rE.prototype.sh=function(b){F.add(Xh(this.xi),b);return this};rE.prototype.Ea=function(b){this.xi.V().appendChild(b);return this};
a.vE=function(b){b.Xm.Fb()&&(sE(b),uE(b));fi(b.xi,b.Xm);var c=b.Wm;b.Wm=l;b.xi.addEventListener(gi,function(b){if(c[b.key])return c[b.key](b)});$h(b.xi,j);var d=b.xi;b.xi=l;return d};t=qE.prototype;t.pw=function(b){return this.Ve.oc.gd(b)};t.UM=function(b){return(b=this.gn(b))?this.dispatchEvent(b):m};t.Gw=function(){return this.dispatchEvent("cancel")};t.w=function(){this.Ve&&(this.hide(),this.Ve.G(),this.Ve=l);qE.n.w.call(this)};t.bM=function(){this.dispatchEvent("afterhide")};a.wE=function(b){Ru.call(this);this.CK=b};y(wE,Ru);t=wE.prototype;t.Be=function(b){return b==this.CK};t.execCommand=function(b,c){return this.Ze.apply(this,arguments)};t.rw=p("ob");t.Ze=function(b,c){this.VG||xE(this);this.ob||(this.ob=this.nv(Rb(this.C.Hk),c));var d=tv(this.C);this.iz=d&&new oD(d);Ls(this.C.gb.Oa());vd(this.ob,"afterhide",this.En,m,this);this.C.Hg=j;this.ob.show();this.dispatchEvent("dialogOpened");Vu(this.C);return j};
t.En=function(){this.C.Hg=m;yE(this);this.VG||xE(this);this.dispatchEvent("dialogClosed");Vu(this.C);this.C.Pq.selectionchange=za()};a.yE=function(b){b.iz&&(b.iz.restore(),b.iz=l);b.C.focus()};t.w=function(){xE(this);wE.n.w.call(this)};t.VG=m;t.vx=m;a.xE=function(b){b.ob&&!b.vx&&(b.vx=j,b.ob.G(),b.ob=l,b.vx=m)};a.zE=function(){};y(zE,$i);ia(zE);t=zE.prototype;t.L=s("goog-tab");t.qc=function(){return Uc.XA};t.v=function(b){var c=zE.n.v.call(this,b);(b=b.Qf())&&this.Mc(c,b);return c};t.o=function(b,c){var c=zE.n.o.call(this,b,c),d=this.Qf(c);d&&b.wt(d);if(b.W&8&&(d=b.getParent())&&qa(d.rm))b.Zb(8,m),d.rm(b);return c};t.Qf=function(b){return b.title||""};t.Mc=function(b,c){b&&(b.title=c||"")};a.AE=function(b,c,d){oj.call(this,b,c||zE.N(),d);rj(this,8,j);this.fk|=9};y(AE,oj);AE.prototype.Qf=p("wp");AE.prototype.Mc=function(b){this.M.Mc(this.h(),b);this.wt(b)};AE.prototype.wt=ca("wp");mj("goog-tab",function(){return new AE(l)});a.BE=function(){};y(BE,Ll);ia(BE);BE.prototype.L=s("goog-tab-bar");BE.prototype.qc=function(){return Uc.VI};BE.prototype.vz=function(b,c,d){this.jF||(this.zq||CE(this),this.jF=H.Am(this.zq));var e=this.jF[c];e?(b.$o(e==DE||e==EE?Ol:Nl),b.kF=e):BE.n.vz.call(this,b,c,d)};BE.prototype.bf=function(b){var c=BE.n.bf.call(this,b);this.zq||CE(this);c.push(this.zq[b.kF]);return c};a.CE=function(b){var c=b.L();b.zq=H.create(FE,c+"-top",GE,c+"-bottom",DE,c+"-start",EE,c+"-end")};a.IE=function(b,c,d){b=b||FE;this.$o(b==DE||b==EE?Ol:Nl);this.kF=b;Qs.call(this,this.wb,c||BE.N(),d);HE(this)};y(IE,Qs);a.FE="top",a.GE="bottom",a.DE="start",a.EE="end";t=IE.prototype;t.PJ=j;t.nf=l;t.z=function(){IE.n.z.call(this);HE(this)};t.w=function(){IE.n.w.call(this);this.nf=l};t.removeChild=function(b,c){JE(this,b);return IE.n.removeChild.call(this,b,c)};t.qz=function(b){IE.n.qz.call(this,b);this.PJ&&this.rm(Oh(this,b))};t.rm=function(b){b?b.qm(j):this.nf&&this.nf.qm(m)};
a.JE=function(b,c){if(c&&c==b.nf){for(var d=Wr(b,c),e=d-1;c=Oh(b,e);e--)if(c.Q()&&c.isEnabled()){b.rm(c);return}for(d+=1;c=Oh(b,d);d++)if(c.Q()&&c.isEnabled()){b.rm(c);return}b.rm(l)}};t.gN=function(b){this.nf&&this.nf!=b.target&&this.nf.qm(m);this.nf=b.target};t.hN=function(b){b.target==this.nf&&(this.nf=l)};t.eN=function(b){JE(this,b.target)};t.fN=function(b){JE(this,b.target)};t.ue=function(){Ts(this)||this.pd(this.nf||Oh(this,0))};
a.HE=function(b){b.m().e(b,"select",b.gN).e(b,"unselect",b.hN).e(b,"disable",b.eN).e(b,"hide",b.fN)};mj("goog-tab-bar",function(){return new IE});a.KE=function(){Ru.call(this)};y(KE,Ru);KE.prototype.Br=function(b){if(C&&this.C.Hg)b=m;else if(9==b.keyCode&&!b.metaKey&&!b.ctrlKey){var c=tv(this.C);Hc(c.Bb(),"LI")||P.some(c,function(b){return"LI"==b.tagName})?(this.C.execCommand(b.shiftKey?"+outdent":"+indent"),b.preventDefault(),b=j):b=m}else b=m;return b};a.LE=function(){Ru.call(this)};y(LE,KE);LE.prototype.jd=s("ListTabHandler");a.ME=function(b){Ru.call(this);this.UO=b};y(ME,Ru);t=ME.prototype;t.jd=lf("LoremIpsum");t.Wp=nf;t.Ep=m;t.queryCommandValue=function(b){return"usinglorem"==b&&this.Ep};
t.execCommand=function(b,c){if("clearlorem"==b){var d=!!c,e=this.C;if(this.Ep&&!e.Hg){var g=e.h();g||(g=e.Hc);this.Ep=m;g.style.fontStyle=this.gP;e.Dd(j,l,j);d&&e.Vd()&&(D?(Qb(e.h()).body.focus(),e.Pf()):rb&&yv(e))}}else"updatelorem"==b&&(d=this.C,!this.Ep&&(!d.Hg&&fv!=d.id)&&((e=d.h())||(e=d.Hc),Js(e)&&(this.Ep=j,this.gP=e.style.fontStyle,e.style.fontStyle="italic",d.Dd(j,this.UO,j))))};t.Be=function(b){return"clearlorem"==b||"updatelorem"==b||"usinglorem"==b};a.NE=function(b){this.tB=b};y(NE,Fd);a.OE=function(){N.call(this);this.QO=100;this.Gd=[];this.Wj=[];this.Rs=[]};y(OE,Fd);t=OE.prototype;t.Rr=l;t.kA=function(){PE(this,this.Gd,this.Wj)};t.Xy=function(){PE(this,this.Wj,this.Gd)};a.PE=function(b,c,d){if(c.length){var e=c.pop();d.push(e);b.Rs.push({type:c==b.Gd?"before_undo":"before_redo",mD:c==b.Gd?e.kA:e.Xy,state:e});1==b.Rs.length&&b.Ag();(0==c.length||1==d.length)&&b.dispatchEvent("state_change")}};
t.Ag=function(){if(!(this.Rr||0==this.Rs.length)){var b=this.Rs.shift();this.dispatchEvent({type:b.type,state:b.state})&&(b.state.tB?(this.Rr=O(b.state,"action_completed",this.AL,m,this),b.mD.call(b.state)):(b.mD.call(b.state),this.Ag()))}};t.AL=function(){yd(this.Rr);this.Rr=l;this.Ag()};a.QE=function(b){Ru.call(this);b=b||new OE;this.mF&&yd(this.mF);this.$d=b;this.mF=O(this.$d,"state_change",this.gL,m,this);this.$i={};this.kn={};this.vE=l;this.ZJ=v(this.DR,this)};y(QE,Ru);QE.prototype.Kb=ke("goog.editor.plugins.UndoRedo");QE.prototype.Mn=l;a.RE=H.Am({UV:"+undo",nV:"+redo"});t=QE.prototype;t.Be=function(b){return b in RE};t.UH=function(b){this.disable(b);this.C=l};
t.enable=function(b){if(!this.isEnabled(b)){uv(b);var c=new le(this);C||c.e(b,"beforechange",this.dM);c.e(b,$u,this.lM);c.e(b,"blur",this.Fw);this.$i[b.Gg]=c;SE(this,b)}};t.disable=function(b){uv(b);var c=this.$i[b.Gg];c&&(c.G(),delete this.$i[b.Gg]);this.kn[b.Gg]&&delete this.kn[b.Gg]};t.isEnabled=function(b){return!!this.$i[b.Gg]};t.w=function(){QE.n.w.call(this);for(var b in this.$i)this.$i[b].G(),delete this.$i[b];this.C=l;this.$d&&(this.$d.G(),delete this.$d)};t.jd=s("UndoRedo");
t.execCommand=function(b){"+undo"==b?this.$d.kA():"+redo"==b&&this.$d.Xy()};t.queryCommandValue=function(b){var c=l;"+undo"==b?c=0<this.$d.Gd.length:"+redo"==b&&(c=0<this.$d.Wj.length);return c};t.gL=function(){this.C.dispatchEvent({type:"cvc",DK:["+redo","+undo"]})};
t.DR=function(b,c,d){var e=this.C;if(e){Uu(e,j,j);try{e.Eh();e.execCommand("clearlorem",j);e.h().innerHTML=c;d&&d.select();var g=this.C;e.focus();g&&g.Gg!=b.vn&&g.execCommand("updatelorem");var h=this.kn[b.vn];h.si=c;h.SH=d}catch(k){this.Kb.log(be,"Error while restoring undo state",k)}finally{this.Mn=b,e.We(),Vu(e)}}};
t.Br=function(b,c,d){if(d){var e;"z"==c?e=b.shiftKey?"+redo":"+undo":"y"==c&&(e="+redo");if(e)return(b="+undo"==e?this.$d.Gd[this.$d.Gd.length-1]:this.$d.Wj[this.$d.Wj.length-1])&&b.vn?this.C.execCommand(e):this.execCommand(e),j}return m};t.dM=function(b){if(!this.Mn){var b=b.target,c=b.Gg;this.vE!=c&&(this.vE=c,SE(this,b))}};t.lM=function(b){this.Mn?(b=this.Mn,this.Mn=l,b.dispatchEvent("action_completed")):SE(this,b.target)};t.Fw=function(b){(b=b.target)&&uv(b)};
a.SE=function(b,c){var d=c.Gg,e,g;c.queryCommandValue("usinglorem")?(e="",g=l):(e=c.h().innerHTML,g=new TE(c),g=!g.isValid()?l:g);var h=b.kn[d];if(h){if(h.si==e)return;if(""==e||""==h.si){var k=c.at(8,"",{});if(e==k&&""==h.si||h.si==k&&""==e)return}h.Yy=e;h.eR=g;k=b.$d;if(0==k.Gd.length||!h.equals(k.Gd[k.Gd.length-1])){k.Gd.push(h);k.Gd.length>k.QO&&k.Gd.shift();var n=k.Wj.length;k.Wj.length=0;k.dispatchEvent({type:"state_added",state:h});(1==k.Gd.length||n)&&k.dispatchEvent("state_change")}}b.kn[d]=
new UE(d,e,g,b.ZJ)},a.UE=function(b,c,d,e){this.tB=j;this.vn=b;this.SG=e;this.si=c;this.SH=d};y(UE,NE);UE.prototype.kA=function(){this.SG(this,this.si,this.SH)};UE.prototype.Xy=function(){this.SG(this,this.Yy,this.eR)};UE.prototype.equals=function(b){return this.vn==b.vn&&this.si==b.si&&this.Yy==b.Yy};
a.TE=function(b){this.Od=b;var c=b.gb.Oa(),b=(b=tv(b))&&b.Sf()&&b.Oa()==c?b:l;if(to){if(c=b,this.hs=m,c){var d=xn(c),e=yn(c);if(d&&e){var b=c.Vh()?c.Ia():c.sa(),d=new UD(d,this.Od.h()),g=zn(c),e=new UD(e,this.Od.h());c.Vh()?(this.Ba=e,this.Oz=g,this.ya=d,this.Pv=b):(this.Ba=d,this.Oz=b,this.ya=e,this.Pv=g);this.hs=j}}}else so&&(c=b,this.hs=m,c&&(b=c.te(0).Rd(),rc(this.Od.h(),b.parentElement())&&(c=this.Od.gb.Ca().body.createTextRange(),c.moveToElementText(this.Od.h()),e=b.duplicate(),e.collapse(j),
e.setEndPoint("StartToStart",c),this.Ba=VE(e),b=b.duplicate(),b.setEndPoint("StartToStart",c),this.ya=VE(b),this.hs=j)))};TE.prototype.isValid=p("hs");TE.prototype.toString=function(){return to?"W3C:"+this.Ba.toString()+"\n"+this.Oz+":"+this.ya.toString()+"\n"+this.Pv:"IE:"+this.Ba+","+this.ya};TE.prototype.select=function(){var b=this.se(this.Od.h());b&&(so&&this.Od.h().focus(),oo(b).select())};
TE.prototype.se=function(b){if(to){var c=VD(this.Ba,b),b=VD(this.ya,b);return!c||!b?l:Yn(c,this.Oz,b,this.Pv).Rd()}c=b.ownerDocument.body.createTextRange();c.moveToElementText(b);c.collapse(j);c.moveEnd("character",this.ya);c.moveStart("character",this.Ba);return c};
a.VE=function(b){var c=b.duplicate(),d=b.text,e=d.length;c.collapse(j);c.moveEnd("character",e);for(var g,h=10;(g=c.compareEndPoints("EndToEnd",b))&&!(e-=g,c.moveEnd("character",-g),--h,0==h););b=0;for(c=d.indexOf("\n\r");-1!=c;)++b,c=d.indexOf("\n\r",c+1);return e+b};a.WE=function(b,c){Kl.call(this,b||cz.N(),c)};y(WE,Kl);mj("goog-toolbar-separator",function(){return new WE});a.YE=function(b,c){N.call(this);this.da=new le(this);this.Od=b;this.tb=c;this.Ty=[];Mh(this.tb,function(b){b.cb&&this.Ty.push(XE(b.Sd()))},this);this.tb.Ke(m);this.da.e(this.Od,"cvc",this.lT).e(this.tb,"action",this.Ew)};y(YE,Fd);a.XE=function(b){return b};t=YE.prototype;t.m=p("da");t.nr=p("Od");t.Q=function(){return this.tb.Q()};t.D=function(b){this.tb.D(b)};t.isEnabled=function(){return this.tb.isEnabled()};t.Ya=function(b){this.tb.Ya(b)};t.blur=function(){this.tb.Tc(l)};
t.w=function(){YE.n.w.call(this);this.da&&(this.da.G(),delete this.da);this.tb&&(this.tb.G(),delete this.tb);delete this.Od;delete this.Ty};t.lT=function(b){if(this.tb.isEnabled()&&this.dispatchEvent("change")){var c;try{c=this.Od.queryCommandValue(b.DK||this.Ty)}catch(d){c={}}var b=c,e;for(e in b)if(c=Kh(this.tb,e)){var g=b[e];c.ti?c.ti(g):c.Yc(!!g)}}};t.Ew=function(b){var c=b.target.Sd();this.Od.execCommand(c,b.target.S())};a.ZE=function(b){this.vL=b};y(ZE,fd);ZE.prototype.type="ok";a.$E=function(b){fd.call(this,"change");this.isValid=b};y($E,fd);a.aF=function(b){return!b?"":"//www.zhihu.com/equation?tex="+encodeURIComponent(b)};a.bF=function(b){T.call(this,b)};y(bF,T);bF.prototype.mj="";bF.prototype.D=function(b){R(this.h(),b)};a.dF=function(b,c,d,e,g,h,k,n){this.ri=c;this.Dk=k||[];for(var c=n||cF.N(),n=[],d=-d,e=-e,q=0;q<k.length;q++)n.push(L("DIV",{"class":c.L()+"-item",style:"width:"+g+"px;height:"+h+"px;background-position:"+d+"px "+e+"px;"})),d-=g;this.Zf=b;rz.call(this,n,c)};y(dF,rz);t=dF.prototype;t.Qh=p("ri");t.ol=function(b){return 0<=b&&b<this.Dk.length?this.Dk[b]:l};t.Rf=function(b){dF.n.Rf.call(this,b);this.Zf.dispatchEvent(new eF(fF,this))};
t.Rh=function(b){dF.n.Rh.call(this,b);b.relatedTarget&&!rc(this.h(),b.relatedTarget)&&this.Zf.xv()};t.kd=function(b){dF.n.kd.call(this,b);b.relatedTarget&&!rc(this.h(),b.relatedTarget)&&this.Zf.yv.stop()};a.eF=function(b,c,d){fd.call(this,b,d);this.IQ=c},a.fF="a";eF.prototype.xw=p("IQ");a.cF=function(){};y(cF,jz);ia(cF);cF.prototype.L=s("ee-palette");a.gF=function(b){dF.call(this,b,"a",0,150,18,18,"\\leftarrow \\rightarrow \\leftrightarrow \\Leftarrow \\Rightarrow \\Leftrightarrow \\uparrow \\downarrow \\updownarrow \\Uparrow \\Downarrow \\Updownarrow".split(" "));vz(this,new Nb(12,1))};y(gF,dF);a.hF=function(b){dF.call(this,b,"c",0,70,18,18,"\\leq \\geq \\prec \\succ \\preceq \\succeq \\ll \\gg \\equiv \\sim \\simeq \\asymp \\approx \\ne \\subset \\supset \\subseteq \\supseteq \\in \\ni \\notin".split(" "));vz(this,new Nb(7,3))};y(hF,dF);a.iF=function(b){dF.call(this,b,"g",0,30,18,18,"\\alpha \\beta \\gamma \\delta \\epsilon \\varepsilon \\zeta \\eta \\theta \\vartheta \\iota \\kappa \\lambda \\mu \\nu \\xi \\pi \\varpi \\rho \\varrho \\sigma \\varsigma \\tau \\upsilon \\phi \\varphi \\chi \\psi \\omega \\Gamma \\Delta \\Theta \\Lambda \\Xi \\Pi \\Sigma \\Upsilon \\Phi \\Psi \\Omega".split(" "));vz(this,new Nb(7,6))};y(iF,dF);a.jF=function(b){dF.call(this,b,"m",0,90,30,56,"x_{a};x^{b};x_{a}^{b};\\bar{x};\\tilde{x};\\frac{a}{b};\\sqrt{x};\\sqrt[n]{x};\\bigcap_{a}^{b};\\bigcup_{a}^{b};\\prod_{a}^{b};\\coprod_{a}^{b};\\left( x \\right);\\left[ x \\right];\\left{ x \\right};\\left| x \\right|;\\int_{a}^{b};\\oint_{a}^{b};\\sum_{a}^{b}{x};\\lim_{a \\rightarrow b}{x}".split(";"));vz(this,new Nb(10,2))};y(jF,dF);a.lF=function(b){dF.call(this,b,"mn",0,0,46,18,["g","s","c","m","a"],kF.N());vz(this,new Nb(5,1))};y(lF,dF);lF.prototype.D=function(b,c){return lF.n.D.call(this,j,c)};a.kF=function(){};y(kF,cF);ia(kF);kF.prototype.L=s("ee-menu-palette");a.mF=function(b){dF.call(this,b,"s",0,50,18,18,"\\times \\div \\cdot \\pm \\mp \\ast \\star \\circ \\bullet \\oplus \\ominus \\oslash \\otimes \\odot \\dagger \\ddagger \\vee \\wedge \\cap \\cup \\aleph \\Re \\Im \\top \\bot \\infty \\partial \\forall \\exists \\neg \\angle \\triangle \\diamond".split(" "));vz(this,new Nb(7,5))};y(mF,dF);a.nF=function(){N.call(this);this.mG={};this.Hm=l;this.O=new le(this);this.yv=new Hd(300);this.O.e(this.yv,Id,this.CD)};y(nF,Fd);t=nF.prototype;t.xw=function(b){var c=this.mG,d=c[b];if(!d){switch(b){case "mn":d=new lF(this);break;case "g":d=new iF(this);break;case "s":d=new mF(this);break;case "c":d=new hF(this);break;case "m":d=new jF(this);break;case "a":d=new gF(this);break;default:f(Error("Invalid palette type!"))}c[b]=d}return d};
t.setActive=function(b){var c=this.Hm;c&&c.D(m);this.Hm=c=this.xw(b);c.D(j);return c};t.xv=function(){this.yv.start()};t.CD=function(){this.setActive("mn")};t.w=function(){nF.n.w.call(this);this.mG=this.Hm=l};a.oF=function(b,c,d){T.call(this,d);this.mj=c;this.Zf=b.HQ};y(oF,bF);t=oF.prototype;t.WE="";t.av=0;
t.v=function(){var b=x("TeX 公式"),c=x("预览"),d=x("Learn more"),e=this.aa,d=e.v("DIV",{style:"display: none;"},e.v("SPAN",{"class":"ee-section-title ee-section-title-floating"},b),this.mj?e.v("A",{id:"ee-section-learn-more",target:"_blank",href:this.mj},d):l,e.v("DIV",{style:"clear: both;"}),b=this.TN=e.v("DIV",{style:"position: relative"}));this.Zf.setActive("mn").X(b);b.appendChild(e.v("DIV",{style:"clear:both"}));var g=this.kh=e.v("textarea",{"class":"ee-tex",dir:"ltr"});b.appendChild(g);b.appendChild(e.v("DIV",
{"class":"ee-section-title"},c));c=this.VQ=e.v("DIV",{"class":"ee-preview-container"});b.appendChild(c);this.g=d};t.z=function(){this.CH=new ou(this.kh);O(this.CH,"input",this.VD,m,this);this.m().e(this.kh,"keydown",this.VD);this.m().e(this.Zf,fF,this.WM,m,this)};t.D=function(b){oF.n.D.call(this,b);b&&Jd(this.HL,0,this)};t.HL=function(){this.kh.focus();Sr(this.kh,this.kh.value.length)};
a.pF=function(b){var c=b.sl();if(c!=b.WE){b.WE=c;var d=!(1024<c.length);b.dispatchEvent(new $E(d));var b=b.VQ,e=Rb(b);e.et(b);c&&(d?c=e.v("IMG",{src:aF(c)}):(c=x("Equation is too long"),c=e.v("DIV",{"class":"ee-warning"},c)),e.appendChild(b,c))}};t.VD=function(){this.av++;Jd(v(this.iN,this,this.av),500)};t.iN=function(b){b==this.av&&pF(this)};
t.WM=function(b){var c=b.xw(),d=this.Zf,e=d.Hm,b=this.kh;if("mn"==c.Qh()){var g=c.Eb,g=-1!=g?c.ol(g):l;if(e!=c&&e.Qh()==g){d.CD();return}g&&(c=this.Zf.setActive(g),c.h()||c.X(this.TN),c=c.h(),$f(c,0,-c.clientHeight))}else{e=this.Zf.Hm;g=e.ol(e.Eb);if(!g)return;Jd(v(this.aO,this,g+" "),0)}b.focus()};t.aO=function(b){var c=this.kh,d=bm(c),e=c.value,e=e.substring(0,d)+b+e.substring(d);c.value=e;Sr(c,d+b.length);pF(this)};t.sl=function(){return this.kh.value};t.pz=function(b){this.kh.value=b;pF(this)};
t.w=function(){this.CH.G();this.Zf=l;oF.n.w.call(this)};a.qF=function(b,c,d){T.call(this,d);this.cC=b;this.mj=c};y(qF,T);t=qF.prototype;t.lh=l;t.v=function(){qF.n.v.call(this);this.Iq()};t.Iq=function(){var b=this.h();this.lh=new oF(this.cC,this.mj,this.aa);this.H(this.lh);this.lh.X(b);this.lh.D(j)};t.$=function(b){this.g=b;this.Iq()};t.sl=function(){return this.lh.sl()};t.pz=function(b){this.lh.pz(b)};t.vw=function(){var b=this.sl(),c=aF(b);return!c?"":'<img src="'+c+'" alt="'+Va(b)+'" class="ee_img tr_noresize" eeimg="1" style="vertical-align: middle">'};
t.isValid=function(){return 1024<this.sl().length};t.D=function(b){this.lh.D(b)};t.w=function(){this.lh&&this.lh.G();this.cC=l;qF.n.w.call(this)};a.rF=function(b,c,d,e){qE.call(this,c);this.Zi=new qF(b,e);this.Zi.X();this.Zi.pz(d);this.Zi.addEventListener("+equation",this.yo,m,this)};y(rF,qE);rF.prototype.ov=function(){var b=new rE(this),c=x("公式编辑器"),d=x("插入公式"),e=x("保存"),d=this.Zi.sl()?e:d;sE(uE(b.Va(c).Ea(this.Zi.h())),d);return vE(b)};rF.prototype.gn=function(){if(this.Zi.isValid())return l;var b=this.Zi.vw();return new ZE(b)};rF.prototype.yo=function(b){this.JF||(this.JF=this.pw("ok"));this.JF.disabled=!b.isValid};a.sF=function(b){this.mj=b||"";wE.call(this,"+equation")};y(sF,wE);t=sF.prototype;t.Da=ke("goog.editor.plugins.EquationEditorPlugin");t.jd=lf("EquationEditorPlugin");t.nv=function(b,c){var d=c||l,e;d?(e=d.getAttribute("alt"),e||(e=d.getAttribute("src"),e=!e?"":decodeURIComponent(e.match(ve)[6]||l).slice(4)||"")):e="";this.lG=d;d={};d.HQ=new nF;d=new rF(d,b,e,this.mj);d.addEventListener("ok",this.In,m,this);return d};t.enable=function(b){sF.n.enable.call(this,b)};
t.disable=function(b){sF.n.disable.call(this,b)};t.In=function(b){yE(this);this.C.Eh();b=dc(cD(this).Ha,b.vL);if(this.lG)lc(b,this.lG);else{var c=tv(this.C);c.isCollapsed()||c.Wc();b=c.insertNode(b,m)}Qr(b,m);this.C.We()};a.tF=function(){lE.call(this)};y(tF,lE);x("Equation:");a.uF=x("Edit"),a.vF=x("Remove");t=tF.prototype;t.jd=s("EquationBubble");t.SL=function(b){return b&&"IMG"==b.nodeName&&(b.getAttribute("eeimg")||F.has(b,"ee_img"))?b:l};t.LK=function(b){this.Kq("ee_bubble_edit",uF,this.mL,b,"zg-icon zg-icon-pen");this.Kq("ee_remove_remove",vF,this.mR,b,"zg-icon zg-icon-trash")};t.ow=s("IMG");t.pD=function(){return x("Equation")};t.mR=function(){this.C.Eh();M(this.Kt);oE(this);this.C.We()};
t.mL=function(){var b=this.Kt;oE(this);this.C.execCommand("+equation",b)};a.wF=function(b){Ru.call(this);this.qA="http://upload."+bh.fm+":"+location.port+"/upload";H.extend(this.F={},this.defaults,b||{})};y(wF,Ru);t=wF.prototype;t.defaults={DX:ha};t.jd=lf("FastUpload");
t.enable=function(b){if(!this.isEnabled(b)&&!(!window.URL&&!window.webkitURL||!window.FileReader||!window.FormData||!document.addEventListener)){$.fn.draghover=function(){return this.each(function(){var b=$(),c=$(this),d=j;c.on("dragenter",function(k){k=k.originalEvent;0===b.size()&&(d&&z.contains(k.dataTransfer.types,"Files"))&&c.trigger("draghoverstart",k);b=b.add(k.target)});c.on("dragleave",function(k){setTimeout(function(){b=b.not(k.target);0===b.size()&&d&&c.trigger("draghoverend",k)},1)});
c.on("dragstart",function(){d=m});c.on("drop dragend",function(){b=$();c.trigger("draghoverend");d=j})})};this.CA=$(this.C.h());var c=cD(this),d=$('<div class="editable-dropzone"><div class="row"><div class="cell"><div>拖拽至此处上传</div></div></div></div>');c.sx(d[0],this.C.h());c=this.sI=d;new le(this);b.h().addEventListener("paste",v(this.Tw,this));document.addEventListener("dragover",v(this.xM,this),m);c.on("dragover",v(this.wM,this));c.get(0).addEventListener("drop",v(this.xr,this),m);$(window).draghover().on({draghoverstart:v(this.FD,
this),draghoverend:v(this.yM,this)});c.draghover().on({draghoverstart:v(this.qM,this),draghoverend:v(this.FD,this)})}};t.xM=function(b){z.contains(b.dataTransfer.types,"Files")&&(b.dataTransfer.dropEffect="none",b.preventDefault())};t.wM=function(b){b=b.originalEvent;b.dataTransfer.dropEffect="copy";b.preventDefault();b.stopPropagation()};t.FD=function(b){b.preventDefault();b.stopPropagation();xF(this,1)};t.qM=function(b){xF(this,2);b.stopPropagation()};
t.yM=function(b){b.preventDefault();xF(this,0)};a.xF=function(b,c){var d=[{display:"none"},{display:"table",width:b.CA.width(),height:b.CA.height(),"background-color":"rgba(255, 255, 255, 0.5)"}];d[2]=$.extend({},d[1],{"background-color":"rgba(245, 245, 245, 0.5)"});b.sI.css(d[c])};t.Tw=function(b){var c=this;b.clipboardData&&z.contains(b.clipboardData.types,"Files")&&z.forEach(b.clipboardData.items,function(d){-1<d.type.indexOf("image")&&(yF(c,d.getAsFile()),b.preventDefault())})};
t.xr=function(b){var c=this;c.C.execCommand("clearlorem");var d=b.dataTransfer.files;document.createElement("img");b.preventDefault();var e=[];z.forEach(d,function(b){-1<b.type.indexOf("image")?(yF(c,b),e.push(j)):e.push(m)});z.every(e,function(b){return!b})&&U("文件类型不支持！");xF(c,0)};
a.yF=function(b,c){var d=new FormData;d.append("via","xhr2");d.append("upload_file",c);var e;e=$.ajaxSettings.xhr();e.withCredentials=j;var g=$.ajax({url:b.qA,data:d,processData:m,contentType:m,xhr:function(){return e},type:"POST"}).done(function(b){"string"===$.type(b)&&(b=JSON.parse(b));if(1===b.code)U(b.msg);else{var c=new Image;c.src=b.msg[0];c.setAttribute("originImgSrc",c.src.replace("_m.jpg","_r.jpg"));c.setAttribute("data-rawWidth",b.msg[1]);c.setAttribute("data-rawHeight",b.msg[2]);g.KA.after(c)}}).fail(function(){U("上传失败！>_<")}).always(function(){g.KA.remove()}),
d=g,h;h=cD(b);var k=h.v("IMG",{"class":"",style:"display:block",src:"http://static.zhihu.com/static/img/spinner2.gif"}),n=tv(b.C);!n||!tD(n)||!rc(b.C.h(),n.Bb())?Js(b.C.field)?kc(b.C.h(),k,0):b.C.h().appendChild(k):n.bg(k);B||(Qr(k,m),h.Oa().focus());Uu(b.C);h=$(k);d.KA=h};a.zF={},a.FF=function(b,c,d){function e(b){mc(b)}function g(c,d){for(;c!==b;){if(d(c))return c;c=c.parentNode}return l}function h(b){return b.tagName&&b.tagName===c}b||f("Missing Editable Container");c||(c="blockquote");var c=c.toUpperCase(),k=no();if(k&&AF(b,xn(k))&&AF(b,yn(k))){var n=eD(k.U(),k.sa(),k.fa(),k.Ia()),q;if(k.isCollapsed())q=[];else{var r=k.rc(),w=k.U(),A=k.fa();q=r.childNodes;var G=function(b){return w!==r&&!AF(b,w)},I=function(b){return!(b.previousSibling&&AF(b.previousSibling,A))};
q=P.toArray(1===q.length?q:P.Yz(P.kL(q,G),I))}var G=k.Bb(),I=g(G,h),Q=z.reduce(q,function(b,d){1===d.nodeType&&(h(d)?b.push(d):b.push.apply(b,z.toArray(d.getElementsByTagName(c))));return b},[]),X;if(I){if(d)return BF.nu;mc(I)}else if(Q.length){if(d)return BF.nu;z.forEach(Q,e)}else{if(d)return BF.SA;if(d=g(G,function(b){return z.contains(CF,b.tagName.toLowerCase())}))X=document.createElement(c),d.parentNode.insertBefore(X,d),X.appendChild(d);else if(k.U()!==k.fa())X=document.createElement(c),q[0].parentNode.insertBefore(X,
q[0]),z.forEach(q,function(b){X.appendChild(b)});else{n=c;DF.ZI?document.execCommand("formatBlock",m,n):(d=no(),k=d.rc(),ra(k)&&1==k.nodeType&&Js(k)?(n=document.createElement(n),k===b?k.appendChild(n):lc(n,k),(D||C)&&n.appendChild(document.createElement("br")),Is(n)):(d=d.fa(),d=Gc(d,function(b){return wD(b.parentNode)||jD(b.parentNode)},j),k=P.Yz(new Zr(d,j,j),qf(EF)),d=P.Yz(new Zr(d,m,m),qf(EF)),k=P.toArray(k).reverse().concat(P.toArray(d)),k.length&&(n=document.createElement(n),d=z.Xd(k),(q=d.nextSibling)&&
(q&&"BR"===q.tagName)&&M(q),jc(n,d),gc(n,k),(D||C)&&n.appendChild(document.createElement("br")),Qr(n.lastChild))));return}}n&&(k=function(c,d){return c&&AF(b,c)&&Ir(c)>=d},k(n.U(),n.sa())&&k(n.fa(),n.Ia())&&n.select())}else if(d)return BF.SA},a.EF=function(b){return b&&"BR"===b.tagName||wD(b)||jD(b)},a.AF=function(b,c){return 3===b.nodeType?b===c:b.contains(3===c.nodeType?c.parentNode:c)},a.CF=["ul","ol","dl","table"],a.BF={nu:1,SA:0},a.DF=zF;DF.ZI=!B;DF.toggle=FF;
DF.Td=function(b,c){return FF(b,c,j)};DF.UI=BF;a.GF=function(){Ru.call(this)};y(GF,Ru);t=GF.prototype;t.jd=lf("Blockquote");t.Be=function(b){return"+blockquote"===b};t.Ze=function(b){this.Be(b)&&zF.toggle(this.C.h())};t.queryCommandValue=function(){return zF.UI.nu===zF.Td(this.C.h())};t.Rw=function(b){if(13===b.keyCode)return this.Mw(b)};t.zz=function(b,c){return HF(b,c).zz};
a.HF=function(b,c){function d(b,c){return{zz:b,GF:c}}D&&(b.normalize(),c=no());var e,g=c;e=g.fa();var h=g.Ia(),g=g.rc(),k=g.childNodes.length;3!==e.nodeType&&k&&(e=g.childNodes[h===k?k-1:h]);if(!e)return d(m,l);if(Js(b))return d(j,b);for(h=e;h!==b;){if(xD(h))return d(m,l);h=h.parentNode}return e&&"BR"===e.tagName&&e.previousSibling&&"BR"===e.previousSibling.tagName?d(j,e):(e=c.Bb())&&1===e.nodeType&&(!e.childNodes.length||Js(e))?d(j,e):d(m,l)};
t.Mw=function(b){var c=tv(this.C);if(c.isCollapsed()){var d;a:{d=c.fa();for(var e=this.C.field;d!==e;){if("BLOCKQUOTE"===d.tagName)break a;d=d.parentNode}d=i}if(d&&(c=HF(d,c),c.zz)){b.preventDefault();b=document.createElement("div");jc(b,d);if(D||C)(d=(d=d.nextSibling)&&"BR"===d.tagName&&d)||(d=document.createElement("br")),b.appendChild(d);po(b,0).select();c.GF&&M(c.GF)}}};RA["+blockquote"]={cb:j,R:"引用内容",va:"+blockquote",La:"tr-icon tr-blockquote",factory:Sz};a.IF=function(b,c){this.eb=b;this.uA=!c};
IF.prototype.ei=function(b,c,d){var e,g=[];if(""!=b){e=$a(b);var h=RegExp("(^|\\W+)"+e,"i");P.some(this.eb,function(b){String(b).match(h)&&g.push(b);return g.length>=c})}e=g;if(0==e.length&&this.uA){var k=[];P.forEach(this.eb,function(c,d){var e=b.toLowerCase(),g=String(c).toLowerCase(),h=0;if(-1!=g.indexOf(e))h=parseInt((g.indexOf(e)/4).toString(),10);else for(var n=e.split(""),Q=-1,X=10,na=0,Xa;Xa=n[na];na++)Xa=g.indexOf(Xa),Xa>Q?(Q=Xa-Q-1,Q>X-5&&(Q=X-5),h+=Q,Q=Xa):(h+=X,X+=5);h<6*e.length&&k.push({zS:c,
YG:h,index:d})});k.sort(function(b,c){var d=b.YG-c.YG;return 0!=d?d:b.index-c.index});e=[];for(var n=0;n<c&&n<k.length;n++)e.push(k[n].zS)}d(b,e)};a.JF=function(b){T.call(this);H.extend(this.F={},this.defaults,b||{});this.be=l};y(JF,T);
a.KF=[["ABAP",["abap"]],["ActionScript",["as","actionscript"]],["Ada",["ada","ada95ada2005"]],["ANTLR",["antlr"]],["ApacheConf",["apacheconf","aconf","apache"]],["AppleScript",["applescript"]],["AspectJ",["aspectj"]],["Asymptote",["asy","asymptote"]],["AutoHotkey",["ahk"]],["Awk",["awk","gawk","mawk","nawk"]],["BBCode",["bbcode"]],["Base Makefile",["basemake"]],["Bash",["bash","sh","ksh"]],["Batchfile",["bat"]],["Befunge",["befunge"]],["BlitzMax",["blitzmax","bmax"]],["Boo",["boo"]],["Brainfuck",
["brainfuck","bf"]],["Bro",["bro"]],["BUGS",["bugs","winbugs","openbugs"]],["C",["c"]],["CMake",["cmake"]],["c-objdump",["c-objdump"]],["aspx-cs",["aspx-cs"]],["C#",["csharp","c#"]],["Ceylon",["ceylon"]],["CFEngine3",["cfengine3","cf3"]],["Cheetah",["cheetah","spitfire"]],["Clojure",["clojure","clj"]],["CoffeeScript",["coffee-script","coffeescript"]],["Coldfusion HTML",["cfm"]],["cfstatement",["cfs"]],["Common Lisp",["common-lisp","cl"]],["Coq",["coq"]],["C++",["cpp","c++"]],["cpp-objdump",["cpp-objdump",
"c++-objdumb","cxx-objdump"]],["Croc",["croc"]],["CSS",["css"]],["CUDA",["cuda","cu"]],["Cython",["cython","pyx"]],["D",["d"]],["d-objdump",["d-objdump"]],["Darcs Patch",["dpatch"]],["Dart",["dart"]],["Delphi",["delphi","pas","pascal","objectpascal"]],["dg",["dg"]],["Diff",["diff","udiff"]],["Django/Jinja",["django","jinja"]],["DTD",["dtd"]],["Duel","duel;Duel Engine;Duel View;JBST;jbst;JsonML+BST".split(";")],["Dylan",["dylan"]],["ECL",["ecl"]],["eC",["ec"]],["Erlang",["erlang"]],["Elixir",["elixir",
"ex","exs"]],["ERB",["erb"]],["Evoque",["evoque"]],["FSharp",["fsharp"]],["Factor",["factor"]],["Fancy",["fancy","fy"]],["Fantom",["fan"]],["Felix",["felix","flx"]],["Fortran",["fortran"]],["GLSL",["glsl"]],["GAS",["gas"]],["Genshi",["genshi","kid","xml+genshi","xml+kid"]],["Gettext Catalog",["pot","po"]],["Gherkin",["Cucumber","cucumber","Gherkin","gherkin"]],["Gnuplot",["gnuplot"]],["Go",["go"]],["GoodData-CL",["gooddata-cl"]],["Gosu",["gosu"]],["Gosu Template",["gst"]],["Groff",["groff","nroff",
"man"]],["Groovy",["groovy"]],["Haml",["haml","HAML"]],["Haskell",["haskell","hs"]],["haXe",["hx","haXe"]],["HTML",["html"]],["HTTP",["http"]],["Hxml",["haxeml","hxml"]],["Hybris",["hybris","hy"]],["INI",["ini","cfg"]],["Io",["io"]],["Ioke",["ioke","ik"]],["IRC logs",["irc"]],["Jade",["jade","JADE"]],["JavaScript",["js","javascript"]],["JSON",["json"]],["Java",["java"]],["Java Server Page",["jsp"]],["Julia console",["jlcon"]],["Julia",["julia","jl"]],["Kconfig",["kconfig","menuconfig","linux-config",
"kernel-config"]],["Koka",["koka"]],["Kotlin",["kotlin"]],["Lasso",["lasso","lassoscript"]],["Lighttpd configuration file",["lighty","lighttpd"]],["Literate Haskell",["lhs","literate-haskell"]],["LiveScript",["live-script","livescript"]],["LLVM",["llvm"]],["Logtalk",["logtalk"]],["Lua",["lua"]],["MOOCode",["moocode"]],["Makefile",["make","makefile","mf","bsdmake"]],["Mako",["mako"]],["MAQL",["maql"]],["Mason",["mason"]],["Matlab",["matlab"]],["Matlab session",["matlabsession"]],["MiniD",["minid"]],
["Modelica",["modelica"]],["Modula-2",["modula2","m2"]],["MoinMoin/Trac Wiki markup",["trac-wiki","moin"]],["Monkey",["monkey"]],["MoonScript",["moon","moonscript"]],["Mscgen",["mscgen","msc"]],["MuPAD",["mupad"]],["MXML",["mxml"]],["MySQL",["mysql"]],["Myghty",["myghty"]],["NASM",["nasm"]],["Nemerle",["nemerle"]],["NewLisp",["newlisp"]],["Newspeak",["newspeak"]],["Nginx configuration file",["nginx"]],["Nimrod",["nimrod","nim"]],["NumPy",["numpy"]],["objdump",["objdump"]],["Objective-C",["objective-c",
"objectivec","obj-c","objc"]],["Objective-J",["objective-j","objectivej","obj-j","objj"]],["OCaml",["ocaml"]],["Octave",["octave"]],["Ooc",["ooc"]],["Opa",["opa"]],["OpenEdge ABL",["openedge","abl","progress"]],["Perl",["perl","pl"]],["PHP",["php","php3","php4","php5"]],["PL/pgSQL",["plpgsql"]],["PostScript",["postscript"]],["PostgreSQL console (psql)",["psql","postgresql-console","postgres-console"]],["PostgreSQL SQL dialect",["postgresql","postgres"]],["POVRay",["pov"]],["PowerShell",["powershell",
"posh","ps1"]],["Prolog",["prolog"]],["Properties",["properties"]],["Protocol Buffer",["protobuf"]],["Python",["python","py","sage"]],["Python Traceback",["pytb"]],["RConsole",["rconsole","rout"]],["Racket",["racket","rkt"]],["Embedded Ragel",["ragel-em"]],["Rd",["rd"]],["REBOL",["rebol"]],["Redcode",["redcode"]],["RHTML",["rhtml","html+erb","html+ruby"]],["RobotFramework",["RobotFramework","robotframework"]],["reStructuredText",["rst","rest","restructuredtext"]],["Ruby",["rb","ruby","duby"]],["Rust",
["rust"]],["S",["splus","s","r"]],["Standard ML",["sml"]],["Sass",["sass","SASS"]],["Scala",["scala"]],["Scaml",["scaml","SCAML"]],["Scheme",["scheme","scm"]],["Scilab",["scilab"]],["SCSS",["scss"]],["Smali",["smali"]],["Smalltalk",["smalltalk","squeak"]],["Smarty",["smarty"]],["Snobol",["snobol"]],["SourcePawn",["sp"]],["Debian Sourcelist",["sourceslist","sources.list"]],["SQL",["sql"]],["sqlite3con",["sqlite3"]],["SquidConf",["squidconf","squid.conf","squid"]],["Scalate Server Page",["ssp"]],["Stan",
["stan"]],["systemverilog",["sv"]],["Tcl",["tcl"]],["Tcsh",["tcsh","csh"]],["Tea",["tea"]],["TeX",["tex","latex"]],["Text",["text"]],["Treetop",["treetop"]],["UrbiScript",["urbiscript"]],["VGL",["vgl"]],["Vala",["vala","vapi"]],["aspx-vb",["aspx-vb"]],["VB.net",["vb.net","vbnet"]],["Velocity",["velocity"]],["verilog",["v"]],["vhdl",["vhdl"]],["VimL",["vim"]],["XQuery",["xquery","xqy","xq","xql","xqm"]],["XML",["xml"]],["XSLT",["xslt"]],["Xtend",["xtend"]],["YAML",["yaml"]]],a.LF=function(b){return{label:b[0],
value:b[1][0],toString:lf(b[0])}},a.MF=z.map(KF,LF);t=JF.prototype;t.defaults={RR:"lang-select",Dq:"collapsed",BO:"lang-list",CQ:"lang-option",Ek:"active",SB:"checked"};t.w=function(){JF.n.w.call(this);this.m().G();this.Z.G();M(this.g);this.ir=this.Nt=this.g=l};t.v=function(){var b=this.F;this.g=L("div",{innerHTML:this.template,className:[b.RR,b.Dq].join(" ")})};t.template='<div class="title-button">选择语言</div><i class="zg-icon zg-icon-double-arrow"></i><div class="input-wrapper"><input class="filter-input zg-form-text-input" placeholder="搜索语言"></div>';
t.z=function(){JF.n.z.call(this);this.Nt=K("title-button",this.g);this.ir=K("filter-input",this.g);sg(this.Nt,j);var b=this.ir,c=this.g,d=this.F,e=this.m(),g=this,h=g.F,k={},n=new IF(MF,m),c=new Im(c,k),q=new dm(l,l,m),r=n.ei;n.ei=function(b,c,d){La(b)?r.apply(this,arguments):d(b,MF)};k.Xc=function(b,c,d){b=b.data;b.value===g.be&&(F.add(d,h.SB),d.appendChild(L("i","icon "+h.SB)));d.appendChild(document.createTextNode(b.toString()))};var w=new Ul(n,c,q);q.Z=w;q.Ik(b);w.Ml=20;e.e(w,"suggestionsupdate",
function(){w.we(w.Cc+0)}).e(w,"update",function(b){this.wy(b.So)}).e(w,"dismiss",function(){this.ii(j)});b=w.M;b.className=d.BO;b.fi=d.CQ;b.tu=d.Ek;this.Z=w;this.m().e(this.g,"click",this.tr).e(this.Nt,"click",this.jN)};t.S=p("be");t.Aa=function(b){var c=b&&z.find(MF,function(c){return c.value===b});c&&(this.dk(c.label),this.dispatchEvent({type:"change",BQ:c}));this.be=b};
t.tr=function(b){var c=this.Z,d=c.M.h();d&&(document.activeElement!==this.ir&&!d.contains(b.target))&&(b.preventDefault(),b.stopPropagation(),Wl(c))};t.jN=function(){this.isCollapsed()&&this.ii(m)};t.isCollapsed=function(){return F.has(this.g,this.F.Dq)};t.ii=function(b){if(this.isCollapsed()!==b){var c=this.ir,d=this.F;b?F.add(this.g,d.Dq):(F.remove(this.g,d.Dq),b=this.Z,d=b.M,b.dm(MF),d.h().scrollTop=0,d.show(),c.value="",c.focus())}};t.dk=function(b){var c=this.Nt;c.title=b;wc(c,b)};
t.wy=function(b){this.Aa(b.value);this.Z.Bc()};a.NF=function(b){Ru.call(this);H.extend(this.F={},this.defaults,b||{});this.Uv=this.tb=l};y(NF,Ru);
a.OF=D||rb||C,a.PF=function(b){return"P"===b.tagName},a.QF=function(b){return 3===b.nodeType},a.RF=function(b){return b&&"PRE"===b.tagName},a.SF=function(b){function c(b){return z.contains(g,b)}function d(){var b=document.createTextNode("\n");g.push(b);return b}var e=document.createElement("div");e.innerHTML=b;var g=[],h=qf(c),b=yc(e,wD);(0,z.forEach)(b,function(b){b.lastChild&&"BR"===b.lastChild.tagName&&b.removeChild(b.lastChild);b.firstChild||b.appendChild(document.createTextNode(""));b.insertBefore(d(),
b.firstChild);b.appendChild(d())});b=z.toArray(e.getElementsByTagName("br"));(0,z.forEach)(b,function(b){b!==b.parentNode.lastChild&&lc(document.createTextNode("\n"),b)});e=yc(e,QF);e=pf(function(b){return z.filter(b,function(d,e){var g=b[e-1];return!g||!(c(g)&&c(d))})},function(b){var c=z.bw(b,h);return-1!==c?b.slice(0,c+1):b},function(b){var c=z.aw(b,h);return-1!==c?b.slice(c):b})(e);return(0,z.map)(e,function(b){return b.nodeValue}).join("").replace(/\xa0/g," ")};t=NF.prototype;t.jd=lf("CodePlugin");
t.Be=function(b){return"+code"===b};t.Ze=function(b){this.Be(b)&&this.trigger()};t.queryCommandValue=function(){var b="1"===TF(this).state,c=this.C.Ph("EnterHandler");c&&(b?c.disable(this.C):c.enable(this.C));this.tb&&this.Uv&&Mh(this.tb,function(c){c instanceof fz&&c.Ya(!b||z.contains(this.Uv,c.Sd()))},this);return b};t.defaults={XK:""};t.YR=function(b){this.tb=b;this.Uv=["toggleFullScreen"].concat("+code")};t.w=function(){NF.n.w.call(this);this.tb=l};
a.UF=function(b,c,d){for(b=b.C.field;c!==b;){if(d(c))return c;c=c.parentNode}},a.TF=function(b){var c,d=no();d&&b.C.field.contains(d.Bb())?(c=d.U(),b=(c=UF(b,c,RF))?"1":"2"):b="0";return{state:b,Jo:d,code:c}};
t.trigger=function(){var b=TF(this),c=b.Jo,d=b.code;switch(b.state){case "1":var e=!La(Fc(d)),b=xD(d);e?(d.parentNode.removeChild(d),b&&Qr(b,j)):(c=c.U()&&c.fa()?new fD(c):l,e=Oa(d.innerHTML),as(P.filter(new Zr(d,m,j),$r))&&(e="<br>"+e),b&&"BR"!==b.tagName&&(e+="<br>"),b=ec(e),d.parentNode.replaceChild(b,d),c.restore());break;case "2":this.as(c,La(c.Ec())?SF(c.Ud()):OF?"\n":"")}};
t.Mi=function(b,c){var d=document.createElement(b);d.id=Gh(Fh.N());return c(d,function(){d=J(d.id);d.removeAttribute("id");return d})};
t.rg=function(){var b=this.C,c=this.C.field,d,e=new Fq(RF,m,l,c),g=L("div",{style:"display:none"});Nr(e,new Of(4,0,0,0));e.Fl=new Of(4,0,0,0)||l;e.At=150;e.Kr=100;e.bh(g);e.className="hc-lang-select";O(e,"beforeshow",function(b){d=b.target.anchor;e.Lc(new mq(d,1));if(d.lang){var b=h,c,g=d.lang;(c=(c=z.find(KF,function(b){return b[0]===g||z.contains(b[1],g)}))&&LF(c))&&b.Aa(c.value);h.ii(j)}else h.dk("选择语言")});O(e,"beforehide",function(b){d=l;h.Aa(l);if((b=b.target)&&c.contains(b)&&RF(b))return m});
var h=new JF;h.X(g);O(h,"change",function(b){d&&(d.lang=b.BQ.value,e.D(m))});this.Vp={uw:lf(e),UW:lf(h),G:function(){e.G();h.G()}};Qc(b,this.Vp);O(b,"delayedchange",this.xR,m,this);O(b.field,"paste",this.Tw,m,this)};t.xR=function(){var b=this.Vp&&this.Vp.uw();b&&(b.Q()&&b.anchor)&&b.Y()};
t.Tw=function(b){var c=TF(this),d=c.Jo,e=c.code;if("1"===c.state)if(c=b.Ub.clipboardData)c.types&&z.contains(c.types,"text/plain")&&(b.preventDefault(),c=c.getData("text/plain"),b=document.createTextNode(c),d.bg(b),Qr(b));else if(window.clipboardData){if(c=window.clipboardData.getData("Text")){b.preventDefault();var g=c;this.Mi("i",function(b,c){d.bg(b);b=c();g=Ja(g);lc(document.createTextNode(g),b)})}}else{var h=d.sa(),b=d.Ec().length,k=(e.firstChild?Ir(e.firstChild):0)-h-b;setTimeout(function(){var b=
SF(e.innerHTML);wc(e,b);b=(e.firstChild?Ir(e.firstChild):0)-k;e.firstChild&&po(e.firstChild,Math.max(h,b)).select()})}};
t.Rw=function(b){if(13===b.keyCode)return this.Mw(b);if(40===b.keyCode){var c=TF(this),d=c.Jo,b=c.code;if("1"===c.state){for(var e=c=d.fa(),g=[];e&&e!==b;)g.push([e.parentNode.childNodes.length,z.indexOf(e.parentNode.childNodes,e)]),e=e.parentNode;g=!g.length||z.every(g,function(b){return b[0]===b[1]+1});e=QF(c);if(g&&!(g=!e))e&&(c=c.nodeValue,d=d.Ia(),e=d===c.length||OF&&d===c.length-1&&"\n"===c.slice(-1)),g=e;g&&(xD(b)||jc(document.createElement("br"),b))}}};
t.Mw=function(b){var c=TF(this),d=c.Jo;if("1"===c.state)return b.preventDefault(),B?this.Mi("i",function(b,c){d.bg(b);setTimeout(function(){var d=document.createTextNode("\r");b=c();lc(d,b);Qr(d)})}):document.queryCommandSupported("insertLineBreak")?document.execCommand("insertLineBreak"):(b=document.createTextNode("\n"),d.insertNode(b),Qr(b)),this.C.We(),j};
t.as=function(b,c){var d=this.F,e;b.Wc();var g;var h=hD(b,j),k=h.ba,n,q=this.C.field;g=UF(this,k,zD(wD,qf(PF)))||q;var r=function(b){return b.parentNode.insertBefore(document.createTextNode(""),b)};if(QF(k)){var w=k.parentNode;!k.nodeValue&&w!==q&&Js(w)?(n=r(w),k=r(n),w.parentNode.removeChild(w)):n=B&&h.offset===k.length?jc(document.createTextNode(""),k):k.splitText(h.offset)}else"BR"===k.tagName&&(n=k,k=r(k));if(n){for(var A,h=k,k=n;h!=g&&(A=h.parentNode);){n=h;h=k;for(k=A.cloneNode(m);n.nextSibling;)k.appendChild(n.nextSibling);
h&&k.insertBefore(h,k.firstChild);h=A}A=k;n=A.firstChild;gc(g,A.childNodes);g=n}else g=l;g?(e=document.createElement("PRE"),g.parentNode.insertBefore(e,g)):this.Mi("PRE",function(c,d){b.insertNode(c);e=d()});!c&&B&&(c=" ");e.lang=d.XK;wc(e,c);Js(e)?Is(e.firstChild):Qr(e.lastChild);d=e;xD(d)||jc(document.createElement("br"),d)};RA["+code"]={cb:j,R:"插入代码",va:"+code",La:"tr-icon tr-code",factory:Sz};a.VF=function(){Ru.call(this);this.zQ=l};y(VF,Ru);a.WF=/^(DIV|TR|LI|BLOCKQUOTE|H\d|PRE|XMP)/,a.XF=function(b){b.push("<br>")};t=VF.prototype;t.jd=s("RemoveFormatting");t.Be=function(b){return"+removeFormat"==b};t.Ze=function(b){"+removeFormat"==b&&!tv(this.C).isCollapsed()&&(b=this.zQ||v(this.LG,this),YF(this,b),cD(this).Ca().execCommand("RemoveFormat",m,i),Fo&&YF(this,function(b){var d=E("528")?/&nbsp;/g:/\u00A0/g;return b.replace(d," ")}))};
t.Br=function(b,c,d){return!d?m:" "==c?(this.C.execCommand("+removeFormat"),j):m};
a.ZF=function(b,c){for(var d=b.C.h();c&&c!=d;){if("TABLE"==c.tagName)return c;c=c.parentNode}return l},a.YF=function(b,c){var d=tv(b.C);if(!(1<d.fj())){if(C){var e=uD(d,b.C.h()),g=ZF(b,e.U()),h=ZF(b,e.fa());if(g||h){if(g==h)return;var k,n=d;k=g;var d=h,e=new oD(n),q=n.U(),r=n.sa(),w=n.fa(),n=n.Ia(),A=cD(b);if(k){var G=A.createTextNode("");jc(G,k);q=G;r=0}d&&(G=A.createTextNode(""),ic(G,d),w=G,n=0);Yn(q,r,w,n).select();k=e;g||(d=M(aD(k,j)),b.Nz=d);h||(d=M(aD(k,m)),b.Ov=d);d=tv(b.C);e=uD(d,b.C.h())}e.select();
d=e}q=d;d=cD(b).v("div");e=q.Rd();to?d.appendChild(e.cloneContents()):so&&(r=q.Ec(),r=r.replace(/\r\n/g,"\r"),w=r.length,q=w-r.replace(/^[\s\xa0]+/,"").length,r=w-Ma(r).length,e.moveStart("character",q),e.moveEnd("character",-r),q=e.htmlText,"Formatted"==e.queryCommandValue("formatBlock")&&(q=Oa(e.htmlText)),d.innerHTML=q);q=c(d.innerHTML);A=tv(b.C);d=cD(b);r=db();e=db();q='<span id="'+r+'"></span>'+q+'<span id="'+e+'"></span>';n=db();w='<span id="'+n+'"></span>';if(so){G=A.te(0).Rd();G.pasteHTML(w);
for(var I;(I=G.parentElement())&&Js(I)&&!nD(I);){A=I.nodeName;if("TD"==A||"TR"==A||"TH"==A)break;M(I)}G.pasteHTML(q);(n=d.h(n))&&M(n)}else if(to){d.Ca().execCommand("insertImage",m,n);A=RegExp("<[^<]*"+n+"[^>]*>");I=tv(b.C).Bb();3==I.nodeType&&(I=I.parentNode);for(;!A.test(I.innerHTML);)I=I.parentNode;if(C)I.innerHTML=I.innerHTML.replace(A,q);else{I.innerHTML=I.innerHTML.replace(A,w);for(I=n=d.h(n);(I=n.parentNode)&&Js(I)&&!nD(I);){A=I.nodeName;if("TD"==A||"TR"==A||"TH"==A)break;jc(n,I);M(I)}I.innerHTML=
I.innerHTML.replace(RegExp(w,"i"),q)}}I=d.h(r);d=d.h(e);Yn(I,0,d,d.childNodes.length).select();M(I);M(d);C&&k&&(d=tv(b.C),I=b.C.h(),b.Nz&&(I.insertBefore(b.Nz,I.firstChild),b.Nz=l),b.Ov&&(I.appendChild(b.Ov),b.Ov=l),I=l,e=aD(k,j),q=aD(k,m),e&&q&&(I=Yn(e,0,q,0)),eD((g?I:d).U(),(g?I:d).sa(),(h?I:d).fa(),(h?I:d).Ia()).select(),k.G())}};
t.LG=function(b){var c=document.createElement("div");c.innerHTML=b;for(var b=[],c=[c.childNodes,0],d=[],e=0,g=[],h=0,k=0;0<=k;k-=2){for(var n=m;0<h&&k<=g[h-1];)h--,n=j;n&&XF(b);for(n=m;0<e&&k<=d[e-1];)e--,n=j;n&&XF(b);for(var n=c[k],q=c[k+1];q<n.length;){var r=n[q++],w=r.nodeName,A=this.AD(r);if(A!=l)b.push(A);else{switch(w){case "#text":r=0<e?r.nodeValue:Ia(r.nodeValue);r=Va(r);b.push(r);continue;case "P":XF(b);XF(b);break;case "BR":XF(b);continue;case "TABLE":XF(b);g[h++]=k;break;case "PRE":case "XMP":d[e++]=
k;break;case "STYLE":case "SCRIPT":case "SELECT":continue;case "A":if(r.href&&""!=r.href){b.push("<a href='");b.push(r.href);b.push("'>");b.push(this.LG(r.innerHTML));b.push("</a>");continue}else break;case "IMG":b.push("<img src='");b.push(r.src);b.push("'");"0"==r.border&&b.push(" border='0'");b.push(">");continue;case "TD":r.previousSibling&&b.push(" ");break;case "TR":r.previousSibling&&XF(b);break;case "DIV":if(A=r.parentNode,A.firstChild==r&&WF.test(A.tagName))break;default:WF.test(w)&&XF(b)}r=
r.childNodes;0<r.length&&(c[k++]=n,c[k++]=q,n=r,q=0)}}}return b.join("").replace(/\xa0|[ \t]+/g," ")};t.AD=s(l);a.$F=function(){VF.call(this)};y($F,VF);$F.prototype.AD=function(b){var c;if("IMG"!==b.nodeName)return l;c=[];c.push('<img src="');c.push(Va(b.src));c.push('"');b.getAttribute("eeimg")&&b.getAttribute("alt")&&c.push(' eeimg="'+Va(b.getAttribute("eeimg"))+'" alt="'+Va(b.getAttribute("alt"))+'"');c.push(">");return c.join("")};a.aG=function(b){qE.call(this,b);this.O=new le(this);this.qA="http://upload."+bh.fm+":"+location.port+"/upload";this.dK=!B};y(aG,qE);a.bG=function(b){fd.call(this,"ok");var c=b[0];this.Gl=c;this.kG=c.replace("_m.jpg","_r.jpg");this.FG=b[1];this.EG=b[2]};y(bG,fd);t=aG.prototype;t.template=$k('<div class="zm-img-uploader"><iframe src="about:blank" name="av_up_frame" style="position: absolute; height: 0; width: 0; left: -9000px; "></iframe><div class="zg-section zm-img-uploader-tab"><a href="javascript:;" class="tab-nav selected">上传图片</a> 或 <a href="javascript:;" class="tab-nav">引用站外图片</a></div><form class="zg-clear" target="av_up_frame" method="POST" enctype="multipart/form-data" action="<%= uploadURL %>"><div class="tab-content selected <% if (canStylize) { %>inline<% } %>"><% if (canStylize) { %><input type="file" name="upload_file" style="opacity:0;height:0;width:0;font-size:0;position:absolute;"><a href="javascript:;" class="browser zg-btn-blue">选择图片</a><% } else { %><input type="file" name="upload_file"><% } %></div><div class="tab-content"><input type="text" autocomplete="off" name="upload_file_url" class="zm-editable-editor-input zg-form-text-input"><a href="javascript:;" class="insert zg-btn-blue zm-uploader-button-fix">确认</a></div><span style="display: none; " class="zm-img-uploader-loading">正在上传</span><span style="display: none; " class="zm-img-uploader-error">上传图片失败，请稍后重试</span></form><div class="zg-gray">请不要上传与回答问题无关的图片，详细请看 <a href="http://www.zhihu.com/question/20064580" target="_blank">知乎图片使用规范</a></div><div class="zm-command"><a class="cancel" href="javascript:;">取消</a></div></div>');
t.ov=function(){var b=ec(this.template({uploadURL:this.qA,canStylize:this.dK}));H.forEach({form:"form",Wz:".zm-img-uploader-tab",Xh:".zm-img-uploader-loading",Kf:".zm-img-uploader-error",DH:"input[type=text]",wn:"input[type=file]",FB:".browser",Zu:".cancel",ZN:".insert"},function(c,e){this[e]=$(c,b).get(0)},this);this.O.e(W,"iframe_data",this.Bu).e(this.wn,"change",this.SQ).e(this.ZN,"click",this.$N).e(this.Zu,"click",function(){this.Gw();this.hide()}).e(this.Wz,"click",function(b){b=$(b.target);
b.is("a")&&!b.is(".selected")&&cG(this,b.index())});this.aC=b;Sg||(cG(this,1),$(this.Wz).replaceWith("<strong>输入站外图片地址：</strong>"));this.FB&&this.O.e(this.FB,"click",function(){this.wn.click()});var c=new rE(this);c.Va("插入图片").Ea(this.aC);c=vE(c);fi(c,l);return c};t.SQ=function(){if(this.wn.value){var b=this.wn.value,b=String(b).toLowerCase();(!b?0:z.some([".jpg",".jpeg",".gif",".png"],function(c){return Fa(b,c)}))?(this.DH.value="",dG(this)):eG(this,"图片不是 .jpg、.png 或 .gif 格式，无法上传。")}};
t.$N=function(){var b=Jk(this.DH.value);b?Ea(b,"http://")?(this.wn.value="",dG(this)):eG(this,"我们目前不支持该协议。"):eG(this,"请填写图片地址。")};a.cG=function(b,c){function d(b){b.eq(c).addClass("selected").siblings().removeClass("selected")}var e=$(".tab-nav",b.Wz),g=$(".tab-content",b.form);R(b.Kf,m);var h=g.eq(c);h.find("input").val("");d(e);d(g);h.find(":text").focus()},a.eG=function(b,c){R(b.Xh,m);b.Kf.innerHTML=c;R(b.Kf,j)};t.Bu=function(b){R(this.Xh,m);this.ek(b.Ic)};
t.ek=function(b){b&&!b.r?(this.dispatchEvent(this.gn(b.msg)),this.hide()):eG(this,b.msg)};a.dG=function(b){R(b.Xh,j);R(b.Kf,m);b.form.submit()};t.gn=function(b){return new bG(b)};t.w=function(){this.O.G();this.O=l;aG.n.w.call(this)};a.fG=function(){wE.call(this,"image");this.O=new le(this)};y(fG,wE);t=fG.prototype;t.jd=lf("ImageDialogPlugin");t.Ze=function(b,c){var d=this.C;return!d.hf&&(d.Pf(),!d.hf)?m:fG.n.Ze.call(this,b,c)};
t.lj=function(b){if(b&&"mouseup"===b.type){var c=b.target;c&&"IMG"===c.nodeName&&(b=xD(c),b||(b=document.createElement("br"),jc(b,c)),Is(b))}};t.En=function(b){fG.n.En.call(this,b)};t.nv=function(b){b=new aG(b);this.O.e(b,"ok",this.In).e(b,"cancel",this.Hw);return b};t.w=function(){fG.n.w.call(this);this.O.G()};
t.In=function(b){yE(this);var c=cD(this),d;d=b.kG?c.v("IMG",{"class":"origin_image zh-lightbox-thumb","data-original":b.kG,title:"点击查看原图",src:b.Gl}):c.v("IMG",{"class":"content_image",src:b.Gl});b.FG&&d.setAttribute("data-rawwidth",b.FG);b.EG&&d.setAttribute("data-rawheight",b.EG);b=tv(this.C);if(tD(b))b.bg(d),B||(Qr(d,m),c.Oa().focus()),Vu(this.C),this.C.We();else return l;this.O.removeAll()};t.Hw=function(){this.O.removeAll()};a.gG=function(b){qE.call(this,b);this.O=new le(this)};y(gG,qE);a.hG=function(b,c,d,e,g){fd.call(this,"ok");this.tT=b;this.rT=c;this.sT=g;this.rS=d;this.poster=e};y(hG,fd);t=gG.prototype;t.show=function(){gG.n.show.call(this);this.Yt.focus()};t.hide=function(){gG.n.hide.call(this)};
t.ov=function(){var b="http://upload."+bh.fm+":"+location.port+"/upload_video",b=this.ed.v("div","zm-img-uploader zm-img-uploader-upload-tab-selected",[this.ed.v("div","zg-section",this.ed.v("strong",l,"输入视频页地址：")),this.MX=this.ed.v("iframe",{id:"video_up_frame",src:"about:_blank",name:"video_up_frame",style:"visible:hidden;position:absolute;height:0;width:0;left:-9000px"}),this.jD=this.ed.v("form",{"class":"zg-section-title",target:"video_up_frame",method:"post",enctype:"multipart/form-data",action:b},
[this.Yt=this.ed.v("input",{type:"text","class":"zg-form-text-input",name:"upload_file_url",autocomplete:"off"}),this.Tk=this.ed.v("a",{"class":"zg-btn-blue zm-uploader-button-fix",name:"save",href:"javascript:;"},"确定"),this.ed.v("div","zm-video-uploader-info",[this.Xh=this.ed.v("span",{style:"display:none","class":"zm-img-uploader-loading"},"正在上传"),this.Kf=this.ed.v("span",{style:"display:none","class":"zm-img-uploader-error"},"插入视频失败，请稍后重试")])]),this.JN=this.ed.v("div","zg-gray"),this.bn=this.ed.v("div",
"zm-command",[this.Zu=this.ed.v("a",{href:"javascript:;"},"取消")])]);this.JN.innerHTML='我们目前支持<a class="zg-link-gray" target="_blank" href="http://youku.com">优酷</a>、<a class="zg-link-gray" target="_blank" href="http://tudou.com">土豆</a>、<a href="http://video.sina.com.cn/" class="zg-link-gray" target="_blank">新浪</a>、<a href="http://v.qq.com/" class="zg-link-gray" target="_blank">腾讯</a>、<a href="http://www.56.com/" class="zg-link-gray" target="_blank">56</a>、<a href="http://tv.sohu.com/" class="zg-link-gray" target="_blank">搜狐</a>、<a href="http://www.iqiyi.com/" class="zg-link-gray" target="_blank">爱奇艺</a>视频服务。<br />请不要上传与回答问题无关的视频，详细请看 <a href="http://www.zhihu.com/question/20118966" target="_blank">知乎视频使用规范</a>';
this.O.e(this.Zu,"click",function(){this.Gw();this.hide()}).e(this.Tk,"click",this.wG).e(this.bn,"click",this.ua).e(this.jD,"submit",function(){return iG(this,this.Yt.value)}).e(W,"iframe_data",this.Bu);this.aC=b;var c=new rE(this);c.Va("插入视频").Ea(b);b=vE(c);fi(b,l);return b};a.iG=function(b,c){c=Jk(c);if(!c)return m;var d=c.match(/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi);d||(R(b.Xh,m),b.Kf.innerHTML="我们无法识别你输入的视频页地址",R(b.Kf,j));return d};
t.wG=function(){if(this.Yt.value){var b=Jk(this.Yt.value);b&&iG(this,b)&&(R(this.Xh,j),R(this.Kf,m),this.jD.submit())}};t.ua=function(b){"save"===(b.target&&b.target.name)&&this.wG()};t.Bu=function(b){R(this.Xh,m);this.ek(b.Ic)};t.ek=function(b){b&&!b.r?(this.dispatchEvent(this.gn(b.msg[0],b.msg[1],b.msg[2],b.msg[3],b.msg[4])),this.hide()):(b=b.msg,R(this.Xh,m),this.Kf.innerHTML=b,R(this.Kf,j))};t.gn=function(b,c,d,e,g){return new hG(b,c,d,e,g)};t.w=function(){this.O.G();this.O=l;gG.n.w.call(this)};
a.jG=function(){wE.call(this,sD);this.O=new le(this)};y(jG,wE);t=jG.prototype;t.jd=lf("VideoDialogPlugin");t.Ze=function(b,c){var d=this.C;return!d.hf&&(d.Pf(),!d.hf)?m:jG.n.Ze.call(this,b,c)};t.En=function(b){jG.n.En.call(this,b)};t.nv=function(b){b=new gG(b);this.O.e(b,"ok",this.In).e(b,"cancel",this.Hw);return b};t.w=function(){jG.n.w.call(this);this.O.G()};
t.In=function(b){yE(this);var c=cD(this),d=c.v("embed");H.forEach({type:"application/x-shockwave-flash",allowscriptaccess:"always",allowfullscreen:"true",wmode:"opaque","class":"video",width:"420",height:"350",src:b.tT,"data-poster":b.poster,"data-name":b.sT,"data-videoid":b.rT,"data-sourceurl":b.rS},function(b,c){d.setAttribute(c,b)});b=Mr(d);Fa(b,'">')&&(b+="</embed>");var b=ec(b+" "),e=b.firstChild,g=tv(this.C);if(tD(g))g.bg(b),B?document.selection&&(c=document.selection.createRange(),c.move("character",
-1),c.select()):(Qr(e),c.Oa().focus()),Vu(this.C),this.C.We();else return l;this.O.removeAll()};t.Hw=function(){this.O.removeAll()};a.Ks=j,a.kG=Ru.prototype.execCommand;Ru.prototype.execCommand=function(b){var c=this.C;return H.contains(DD,b)&&!c.hf?(c.Pf(),m):kG.apply(this,arguments)};a.lG=wE.prototype.execCommand,a.mG=["+equation"];wE.prototype.execCommand=function(b){var c=this.C;return z.contains(mG,b)&&!c.hf&&(c.Pf(),!c.hf)?m:lG.apply(this,arguments)};sD="video";yD=kb?"⌘":"ctrl";RA[sD]={va:sD,R:"插入视频",La:"tr-icon tr-video",factory:Rz};RA["+equation"]={va:"+equation",R:Xz.UU,La:"tr-icon tr-equation",factory:Rz};
RA["+bold"].R="粗体 ("+yD+"+b)";RA["+italic"].R="斜体 ("+yD+"+i)";RA["+underline"].R="下划线 ("+yD+"+u)";RA["+superscript"].R="引用内容";RA["+insertOrderedList"].R="有序列表";RA["+insertUnorderedList"].R="无序列表";RA["+removeFormat"].R="清除格式";RA.image.R="插入图片";RA[sD].R="插入视频";RA["+equation"].R="插入公式";a.nG=function(){};ia(nG);
nG.prototype.xg=function(b,c){this.config=c;var d,e,g;e=K("zm-editable-toolbar-container",b);d=K("zm-editable-editor-outer",b);g=K("zm-editable-editor-field-element",b);var h=new zv(g.id);h.WJ=89;var k=[];c.enableFullScreen&&k.push("toggleFullScreen");k.push("+bold","+italic","+underline",new WE,"+blockquote","+code","+insertOrderedList","+insertUnorderedList","+equation");c.canUploadMedia_&&k.push(new WE,"image",sD);c.useRemoveFormat_&&k.push(new WE,"+removeFormat");var n=Rb(e);g=[];for(var q=0,
r;r=k[q];q++){if(oa(r)){var w=i;if(r=RA[r]){var w=r.factory||Sz,A=r.va,G=r.R,I=r.caption,Q=r.La,X=n||Rb(),w=w(A,G,I,Q,l,X);r.cb&&(w.cb=j)}r=w}r&&g.push(r)}var k=Rb(e),na=new mD(dz.N(),Nl,k),k=eg(e);na.li(k);na.Ke(m);for(n=0;q=g[n];n++)rj(q,32,m),q.li(k),na.H(q,j);na.X(e);new YE(h,na);Qc(h,na);bD(h,new CD);bD(h,new LE);if(c.loremIpsum_&&(bD(h,new ME(c.loremIpsum_)),C))h.on("load",function(){vd(h.h(),"focus",function(){h.execCommand("clearlorem",j)})});bD(h,new WD);bD(h,new $F);bD(h,new QE);e=new NF;
bD(h,e);bD(h,new fG);bD(h,new jG);bD(h,new wF);bD(h,new sF);bD(h,new tF);bD(h,new GF);c.enableFullScreen&&(d=new VA({title:"写作模式",nk:d}),bD(h,d));h.on("load",function(){c.useScraper_&&this.Zr(h,na)},m,this);return[h,na]};nG.prototype.Zr=function(b,c){var d=b.h(),e=new Nv;e.o(d);var g=L("div",{style:"display:none",className:"tr-spinner spinner-gray"});c.h().appendChild(g);e.on("willScrape",function(){R(g,j)}).on("didScrape",function(){R(g,m)});Qc(b,e)};
Ca("ZH.createRichTextEditor",function(b,c){return nG.N().xg(b,c)});If("rich_text_editor");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/rich_text_editor.js