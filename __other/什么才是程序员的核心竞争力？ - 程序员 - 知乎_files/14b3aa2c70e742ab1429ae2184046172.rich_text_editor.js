(function(a){with(a){
a.LC=function(b){if(A&&!Fb(9)){var c=m;try{c=b.parentNode}catch(d){}return!!c}return rc(b.ownerDocument.body,b)},a.MC=function(b,c){return b.aa.h(c?b.lH:b.IC)};fp.prototype.Rf=Z(66,function(){var b=this.Pq.body.createTextRange();b.moveToElementText(this.Pq.body);return this.sg(new fp(b,this.Pq),j)});pp.prototype.Rf=Z(65,function(){return(!this.ua||LC(this.ua))&&(!this.pa||LC(this.pa))&&(!(A&&!Fb(9))||tp(this).Rf())});
vp.prototype.Rf=Z(64,function(){var b=m;try{b=z.every(this.Hh(),function(b){return A?!!b.parentNode:rc(b.ownerDocument.body,b)})}catch(c){}return b});Bp.prototype.Rf=Z(63,function(){return z.every(Ro(this),function(b){return b.Rf()})});Yo.prototype.dj=Z(58,function(){return 3!=this.ba.nodeType?-1:this.ba==this.ua?this.Ba:0});zp.prototype.dj=Z(57,s(0));Dp.prototype.dj=Z(56,function(){return this.Sf[this.Ok].dj()});
ap.prototype.Sd=Z(47,function(){var b=Rb(this.Q.startContainer).v("div");b.appendChild(this.Q.cloneContents());b=b.innerHTML;if(Fa(b,"<")||!this.isCollapsed()&&!Xa(b,"<"))return b;var c=this.rc(),c=1==c.nodeType?c:c.parentNode;return Kr(c.cloneNode(m)).replace(">",">"+b)});fp.prototype.Sd=Z(46,function(){return this.Q.htmlText});pp.prototype.Sd=Z(45,function(){return tp(this).Sd()});vp.prototype.Sd=Z(44,function(){return this.Bg()});Bp.prototype.Sd=Z(43,function(){return z.map(Ro(this),function(b){return b.Sd()}).join("")});
Yo.prototype.bj=Z(42,function(){return 3!=this.ba.nodeType?-1:this.ba==this.pa?this.ya:this.ba.nodeValue.length});zp.prototype.bj=Z(41,s(0));Dp.prototype.bj=Z(40,function(){return this.Sf[this.Ok].bj()});Po.prototype.$f=Z(39,function(b){this.isCollapsed()||this.Vc();return this.insertNode(b,j)});vp.prototype.$f=Z(38,function(b){b=this.insertNode(b,j);this.isCollapsed()||this.Vc();return b});
Mo.prototype.restore=Z(36,function(b){this.xg&&No.log(ce,"Disposed SavedRange objects cannot be restored.",i);var c=this.Wj();b||this.G();return c});up.prototype.Wj=Z(35,function(){return sp(this.fB,this.wJ,this.XC,this.AL)});Ap.prototype.Wj=Z(34,function(){for(var b=(this.Ua.length?Qb(this.Ua[0]):document).body.createControlRange(),c=0,d=this.Ua.length;c<d;c++)b.addElement(this.Ua[c]);return wp(b)});
Ep.prototype.Wj=Z(33,function(){var b=z.map(this.fz,function(b){return b.restore()}),c=new Bp;c.Wl=b;c.Pe=z.map(b,function(b){return b.Pd()});return c});Zo.prototype.Bg=Z(26,function(){var b=new Ir;Q.forEach(this,function(c,d,e){3==c.nodeType?b.append(Wa(c.nodeValue.substring(e.dj(),e.bj()))):1==c.nodeType&&(-1==e.$b?fc(c)&&b.append("</"+c.tagName+">"):(d=c.cloneNode(m),d=Kr(d),A&&"LI"==c.tagName?b.append(d):(c=d.lastIndexOf("<"),b.append(c?d.substr(0,c):d))))},this);return b.toString()});
pp.prototype.Bg=Z(25,function(){return tp(this).Bg()});vp.prototype.Bg=Z(24,function(){return z.map(yp(this),Kr).join("")});Bp.prototype.Bg=Z(23,function(){return this.Sd()});Sn.prototype.fi=Z(21,function(b,c){var d=b.xd(),e=this.L()+"-collapse-left",g=this.L()+"-collapse-right";b.Xi(d?g:e,!!(c&1));b.Xi(d?e:g,!!(c&2))});co.prototype.fi=Z(20,function(b){this.M.fi(this,b)});Oo.prototype.$o=Z(16,function(){var b=this.Jc?-1:1;this.$b==b&&(this.$b=-1*b,this.depth+=this.$b*(this.Jc?-1:1))});
Yo.prototype.$o=Z(15,function(){Yo.n.$o.apply(this);rc(this.ba,this.pa)&&f(Q.Za)});Id.prototype.setInterval=Z(11,function(b){this.Hg=b;this.na&&this.enabled?(this.stop(),this.start()):this.na&&this.stop()});fm.prototype.pw=Z(10,function(){return this.h().innerHTML});Xo.prototype.bh=Z(9,function(b,c){this.insertNode(b,j);this.insertNode(c,m)});
ap.prototype.bh=Z(8,function(b,c){var d=$b(Qb(this.V()));if(d=Gp(d))var e=d.V(),g=d.ea(),h=d.ta(),l=d.Ia();var n=this.Q.cloneRange(),q=this.Q.cloneRange();n.collapse(m);q.collapse(j);n.insertNode(c);q.insertNode(b);n.detach();q.detach();if(d){if(3==e.nodeType)for(;h>e.length;){h-=e.length;do e=e.nextSibling;while(e==b||e==c)}if(3==g.nodeType)for(;l>g.length;){l-=g.length;do g=g.nextSibling;while(g==b||g==c)}sp(e,h,g,l).select()}});
fp.prototype.bh=Z(7,function(b,c){var d=this.Q.duplicate(),e=this.Q.duplicate();lp(d,b,j);lp(e,c,m);this.me()});pp.prototype.bh=Z(6,function(b,c){tp(this).bh(b,c);this.me()});ap.prototype.Vc=Z(5,function(){var b=this.Q;b.extractContents();if(b.startContainer.hasChildNodes()&&(b=b.startContainer.childNodes[b.startOffset])){var c=b.previousSibling;""==Gc(b)&&N(b);c&&""==Gc(c)&&N(c)}});
fp.prototype.Vc=Z(4,function(){if(!this.isCollapsed()&&this.Q.htmlText){var b=this.V(),c=this.ea(),d=this.Q.text,e=this.Q.duplicate();e.moveStart("character",1);e.moveStart("character",-1);e.text==d&&(this.Q=e);this.Q.text="";this.me();d=this.V();e=this.ta();try{var g=b.nextSibling;b==c&&(b.parentNode&&3==b.nodeType&&g&&3==g.nodeType)&&(b.nodeValue+=g.nodeValue,N(g),this.Q=hp(d),this.Q.move("character",e),this.me())}catch(h){}}});pp.prototype.Vc=Z(3,function(){tp(this).Vc();this.me()});
vp.prototype.Vc=Z(2,function(){if(this.Q){for(var b=[],c=0,d=this.Q.length;c<d;c++)b.push(this.Q.item(c));z.forEach(b,N);this.collapse(m)}});Bp.prototype.Vc=Z(1,function(){z.forEach(Ro(this),function(b){b.Vc()})});
a.NC=function(b,c){var d=c.hd();b.md[d]&&b.Kb.log(ce,"Cannot register the same class of plugin twice.",i);b.md[d]=c;for(var e in Hu)c[Hu[e]]&&b.qj[e].push(c);c.C=b;b.Td()&&c.enable(b)},a.OC=function(b){return b.C&&b.C.hb},a.PC=function(b){var c=b.ba.parentNode;return new Fr(c,z.indexOf(c.childNodes,b.ba))},a.QC=function(b,c,d,e){return sp(b,c,d,e)},a.RC=function(b){O.call(this);this.lH=db();this.IC=db();this.aa=Rb(b.Ca());b.bh(this.aa.v("SPAN",{id:this.lH}),this.aa.v("SPAN",{id:this.IC}))};y(RC,Mo);
RC.prototype.Bo=function(b){N(MC(this,j));N(MC(this,m));return b};RC.prototype.Wj=function(){var b=k,c=MC(this,j),d=MC(this,m);if(c&&d){var b=c.parentNode,c=z.indexOf(b.childNodes,c),e=d.parentNode,d=z.indexOf(e.childNodes,d);e==b&&(d-=1);b=sp(b,c,e,d);b=this.Bo(b);b.select()}else this.Bo();return b};RC.prototype.w=function(){this.Bo();this.aa=k};
a.SC=function(b){var c;if(3==b.ba.nodeType)for(c=b.ba.previousSibling;c&&3==c.nodeType;c=c.previousSibling)b.offset+=Gr(c);else c=b.ba.previousSibling;var d=b.ba.parentNode;b.ba=c?c.nextSibling:d.firstChild;return b},a.TC=function(b,c){return c?Hr(b.V(),b.ta()):Hr(b.ea(),b.Ia())},a.UC=function(b){for(var c=k,d=b.firstChild;d;){var e=d.nextSibling;3==d.nodeType?""==d.nodeValue?b.removeChild(d):c?(c.nodeValue+=d.nodeValue,b.removeChild(d)):c=d:(UC(d),c=k);d=e}},a.VC=function(b){var c=b&&b.nodeName.toLowerCase();
return!(!b||"block"!=(1!=b.nodeType?k:A?Wf(b,"display"):Vf(b,"display"))&&!("td"==c||"table"==c||"li"==c))},a.WC=function(b){return Hc(b,VC,j)},a.XC=function(b,c){if(c){var d,e=SC(TC(c,j)),g=PC(e),h=e.ba.previousSibling;3==e.ba.nodeType&&(e.ba=k);var l=SC(TC(c,m)),n=PC(l),q=l.ba.previousSibling;3==l.ba.nodeType&&(l.ba=k);d=function(){!e.ba&&h&&(e.ba=h.nextSibling,e.ba||(e=new Fr(h,Gr(h))));!l.ba&&q&&(l.ba=q.nextSibling,l.ba||(l=new Fr(q,Gr(q))));return sp(e.ba||g.ba.firstChild||g.ba,e.offset,l.ba||
n.ba.firstChild||n.ba,l.offset)};var r=WC(c.Cb())}r?(r=vc(r,b),A?UC(r):r.normalize()):b&&(A?UC(b):b.normalize());return d?d():k},a.YC=function(b,c,d){Ms.call(this,c,b||Oy.O(),d)};y(YC,Ms);a.ZC=function(b){return b.getAttribute&&"true"==b.getAttribute("g_editable")},a.$C=function(b){RC.call(this,b)};y($C,RC);$C.prototype.Bo=function(b){var c=MC(this,j),d=MC(this,m),c=c&&d?vc(c,d):c||d;$C.n.Bo.call(this);if(b)return XC(c,b);c&&(b=Gp($b(Qb(c))),(b=XC(c,b))&&b.select())};
a.aD=function(b,c,d){for(var e=(c=1==c)?b.V():b.ea(),g=c?b.ta():b.Ia(),h=b.Cb();e!=h&&e!=d&&!(c&&0!=g||!c&&g!=Gr(e));)var l=e.parentNode,e=z.indexOf(l.childNodes,e),g=c?e:e+1,e=l;return QC(c?e:b.V(),c?g:b.ta(),c?b.ea():e,c?b.Ia():g)},a.bD=function(b){sg(b,m);if(Pp)for(var c=b,b=b.parentNode;b&&"HTML"!=b.tagName;){if(rg?"none"==b.style[rg].toLowerCase():(A||rb)&&"on"==b.getAttribute("unselectable")){sg(b,m,j);for(var d=0,e=b.childNodes.length;d<e;d++){var g=b.childNodes[d];g!=c&&1==g.nodeType&&sg(b.childNodes[d],
j)}}c=b;b=b.parentNode}},a.cD=function(b){var c=b.target.tagName;"TEXTAREA"!=c&&"INPUT"!=c&&b.preventDefault()},a.dD=void 0,a.eD=function(b){var c=b.Cb();return b.V()!=c.parentElement&&ZC(c)||!!Hc(c,ZC)},a.fD=function(b,c){var d=aD(b,1,c),d=aD(d,0,c),e=d.V(),g=d.ea(),h=d.ta(),d=d.Ia();if(e==g){for(;g!=c&&0==h&&d==Gr(g);)e=g.parentNode,h=z.indexOf(e.childNodes,g),d=h+1,g=e;e=g}return sp(e,h,g,d)},a.gD=function(b,c){Pp&&c.e(b,"mousedown",cD,j);sg(b,j);for(var d=b.getElementsByTagName("INPUT"),e=0,g=
d.length;e<g;e++){var h=d[e];h.type in hq&&bD(h)}z.forEach(b.getElementsByTagName("TEXTAREA"),bD)},a.hD=function(b){return!!fq[b.tagName]},a.iD=function(b){return $r(Q.filter(new Yr(b),Zr))},a.jD=void 0,a.kD=function(b){var c=arguments,d=c.length;return function(){for(var b=0;b<d;b++)if(!c[b].apply(this,arguments))return m;return j}},a.lD=function(b){this.zf=b;this.hO=j;this.Rv=[]},a.mD=function(b){b.ov||(b.ov=Gc(b.zf));return b.ov};a.nD=function(){Gu.call(this)};y(nD,Gu);nD.prototype.hd=s("BTF");nD.prototype.Kb=le("goog.editor.plugins.BasicTextFormatter");
a.oD={zI:"+link",mU:"+formatBlock",zU:"+indent",$U:"+outdent",CV:"+strikeThrough",vU:"+insertHorizontalRule",DV:"+subscript",EV:"+superscript",PV:"+underline",PT:"+bold",BU:"+italic",kU:"+fontSize",jU:"+fontName",iU:"+foreColor",JT:"+backColor",YU:"+insertOrderedList",TV:"+insertUnorderedList",CU:"+justifyCenter",DU:"+justifyFull",FU:"+justifyRight",EU:"+justifyLeft"},a.pD=G.tm(oD);t=nD.prototype;t.Ae=function(b){return b in pD};t.re=function(){return iv(this.C)};a.qD=function(b){return OC(b).Ca()};
t.Ye=function(b,c){var d,e,g,h,l,n=c;switch(b){case "+backColor":if(n!==k)if(Vp){e=n;g=iv(this.C);var q,r;g&&g.isCollapsed()&&(q=OC(this).createTextNode(C?" ":""),n=g.V(),r=1==n.nodeType?n:n.parentNode,""==r.innerHTML?(r.style.textIndent="-10000px",r.appendChild(q)):(r=OC(this).v("span",{style:"text-indent:-10000px"},q),g.$f(r)),Vo(q).select());rD(this,"hiliteColor",e,m,j);q&&(C&&(q.data=""),r.style.textIndent="")}else rb?rD(this,"hiliteColor",n):rD(this,b,n);break;case "+link":a:{l=n;this.C.gf||
OC(this).Oa().focus();g=(e=this.re())&&e.Cb();if((g=Ic(g,"A"))&&Hc(g,ZC))mc(g);else{g=k;var w=[];if((n=e&&e.Cb())&&"IMG"==n.tagName)l=k;else{if(e&&e.isCollapsed())e=e.se(0).Pd(),Mp?(g=OC(this).createElement("A"),e.insertNode(g)):Lp&&(e.pasteHTML("<a id='newLink'></a>"),g=OC(this).h("newLink"),g.removeAttribute("id"));else{var B=db();rD(this,"CreateLink",B);z.forEach(this.C.h().getElementsByTagName("A"),function(b){Ga(b.href,B)&&w.push(b)});w.length&&(g=w.pop())}e=g;g=new lD(e);g.zf.href="/";l&&(e.target=
l);w&&(g.Rv=w);l=g}if(l){if(!this.C.execCommand("link",l))if(h=this.C.Bk.prompt(Qz,"http://"))if(e=l,g=mD(l)||h,n=e.zf,n.href=h,q=mD(e),g!=q&&(h=ps(n),3==h.nodeType&&(h=h.parentNode),Gc(h)!=q&&(h=n),hc(h),n=Rb(h),h.appendChild(n.createTextNode(g)),e.ov=k),e.hO=m,e=l.zf,Zp){g=e.nextSibling;if(!g||!(3==g.nodeType&&(Fa(g.data," ")||Fa(g.data," "))))g=Rb(e).createTextNode(" "),jc(g,e);Ip(g,1).select()}else Nr(e,m);else{e=Vo(l.zf);e=new $C(e);mc(l.zf);for(l.zf=k;l.Rv.length;)mc(l.Rv.pop());e.restore().select();
l=k;break a}break a}}l=k}break;case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":rD(this,b,k,m,j);C&&rD(this,b,k,m,j);(!Tp||!C)&&Q.forEach(iv(this.C),sD);break;default:A&&("+formatBlock"==b&&n)&&(n="<"+n+">");if("+foreColor"==b&&n===k)break;switch(b){case "+indent":case "+outdent":Tp&&(C&&(e=j),rb&&(e="+outdent"==b?!qD(this).queryCommandEnabled("outdent"):j));case "+insertOrderedList":case "+insertUnorderedList":if(q=bq)q=qD(this),q=tD(this,j,q,b,i);if(q)g="P"!=this.C.queryCommandValue("+defaultTag");
else if(!cq&&(A||rb)){d=this.re();q=d.Cb();var H=qD(this);uD.lastIndex=0;uD.test(q.innerHTML)&&(d=d.V()&&d.ea()?new RC(d):k,"P"==q.tagName?vD(q,j):(q.innerHTML=q.innerHTML.replace(uD,'<p$1 trtempbr="temp_br">'),q=z.toArray(q.getElementsByTagName("P")),Q.forEach(q,function(b){if("temp_br"==b.getAttribute("trtempbr")){b.removeAttribute("trtempbr");if(Wr(Fc(b))){var c=A?H.createTextNode(" "):H.createElement("BR");b.appendChild(c)}vD(b)}})),d.restore())}C&&(aq&&!this.queryCommandValue(b))&&(q=this.C.queryCommandValue("+defaultTag"),
"P"==q||"DIV"==q?q=m:(q=this.re(),q.isCollapsed()&&3!=q.rc().nodeType?(d=OC(this).createTextNode(" "),q.insertNode(d,m),Vo(d).select(),q=j):q=m),h|=q);case "+formatBlock":d=!!this.C.Kh("Bidi");break;case "+subscript":case "+superscript":$p&&!this.queryCommandValue(b)&&(q="+subscript"==b?"+superscript":"+subscript",r=wD(q),this.queryCommandValue(q)||qD(this).execCommand(r,m,k),qD(this).execCommand(r,m,k));break;case "+underline":case "+bold":case "+italic":e=C&&Tp&&this.queryCommandValue(b);break;
case "+foreColor":case "+fontName":e=Tp&&C}rD(this,b,n,d,!!e);h&&qD(this).execCommand("Delete",m,j);g&&qD(this).execCommand("FormatBlock",m,"<div>")}C&&!this.C.Fg&&OC(this).Oa().focus();return l};
t.queryCommandValue=function(b){var c;switch(b){case "+link":return b=(b=this.re())&&b.Cb(),b=Ic(b,"A"),!!b&&!!Hc(b,ZC);case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":return xD(this,b);case "+formatBlock":var b=iv(this.C),d=k;Q.forEach(b,function(b,c,e){-1!=e.$b&&(b=WC(b).tagName,d=d||b,d!=b&&(d=k,f(Q.Za)),e.$o())});return d;case "+indent":case "+outdent":case "+insertHorizontalRule":return m;case "+fontSize":case "+fontName":case "+foreColor":case "+backColor":return this.Us(qD(this),
b,Tp&&C);case "+underline":case "+bold":case "+italic":c=Tp&&C;default:var e=qD(this);return tD(this,j,e,b,c)}};t.qG=function(b){Rp&&b.match(/^\s*<script/i)&&(b="&nbsp;"+b);Sp&&(b=b.replace(/<(\/?)strong([^\w])/gi,"<$1b$2"),b=b.replace(/<(\/?)em([^\w])/gi,"<$1i$2"));return b};
t.kK=function(b){for(var b=b.getElementsByTagName("IMG"),c=0,d;d=b[c];c++)if(A){d.removeAttribute("tabIndex");d.removeAttribute("tabIndexSet");var e=d;"removeAttribute"in e&&e.removeAttribute(sa);try{delete e[sa]}catch(g){}d.cP&&(d.tabIndex=d.cP)}};t.lK=function(b){if(D){for(var c=Sb(this.C.hb.Ga,"HEAD",i,i),d=[],e=c.length,g=1;g<e;++g)for(var h=c[g].getElementsByTagName("STYLE"),l=h.length,n=0;n<l;++n)d.push(h[n].outerHTML);return d.join("")+b}return b};
t.vr=function(b,c,d){if(!d)return m;var e;switch(c){case "b":e="+bold";break;case "i":e="+italic";break;case "u":e="+underline";break;case "s":return j}return e?(this.C.execCommand(e),j):m};
a.uD=A?/<br([^\/>]*)\/?>/gi:/<br([^\/>]*)\/?>(?!<\/(div|p)>)/gi,a.vD=function(b,c){if(A||rb){var d=b.outerHTML.replace(/<(\/?)p/gi,"<$1div");c&&(d=d.replace(uD,"</div><div$1>"));rb&&!/<\/div>$/i.test(d)&&(d+="</div>");b.outerHTML=d}},a.wD=function(b){return 0==b.indexOf("+")?b.substring(1):b},a.sD=function(b){b=WC(b);b.align&&(b.style.textAlign=b.align,b.removeAttribute("align"))},a.rD=function(b,c,d,e,g){var h=k;e&&(h=b.C.queryCommandValue("rtl")?"rtl":b.C.queryCommandValue("ltr")?"ltr":k);var c=
wD(c),l,n;if(A){var q=c;n=[];var e=k,r=b.re();l=OC(b);if(q in yD){var w=r&&r.Cb();if(w){for(var B=Tb("BLOCKQUOTE",k,w),H,I=0;I<B.length;I++)if(r.containsNode(B[I])){H=B[I];break}if(w=H||Ic(w,"BLOCKQUOTE"))e=l.v("div",{style:"height:0"}),w.appendChild(e),n.push(e),H?r=sp(H,0,e,0):r.containsNode(e)&&(r=QC(r.V(),r.ta(),e,0)),r.select()}}H=b.C;!H.mc()&&!e&&q in zD&&(H=H.h(),r&&(r.isCollapsed()&&!pc(H))&&(e=r.se(0).Pd(),r=e.duplicate(),r.moveToElementText(H),r.collapse(m),r.isEqual(e)&&(r=l.createTextNode(" "),
H.appendChild(r),e.move("character",1),e.move("character",-1),e.select(),n.push(r))),e=l.v("div",{style:"height:0"}),H.appendChild(e),n.push(e));l=n[0];n=n[1]}if(D){l=c;var L;AD[l]&&(L=OC(b).v("div",{style:"height: 0"},"x"),b.C.h().appendChild(L));BD[l]&&(l=b.C.h(),L=OC(b).v("div",{style:"height: 0"},"x"),l.insertBefore(L,l.firstChild));l=L}if(C&&(L=c,E("1.9")&&"formatblock"==L.toLowerCase()&&(L=b.re(),H=L.V(),L.isCollapsed()&&(H&&"BODY"==H.tagName)&&(e=L.ta(),(H=H.childNodes[e])&&"BR"==H.tagName))))L=
L.Pd(),L.setStart(H,0),L.setEnd(H,0);if(dq&&"fontsize"==c.toLowerCase()){var U=fD(iv(b.C),b.C.h());Q.forEach(Q.filter(U,function(b,c,d){return 1==d.$b&&U.containsNode(b)}),function(b){Tf(b,"font-size","");C&&(0==b.style.length&&b.getAttribute("style")!=k)&&b.removeAttribute("style")})}L=qD(b);if(g&&Tp&&(L.execCommand("styleWithCSS",m,j),rb)){H=[];e=iv(b.C).Cb();do H.push(e);while(e=e.parentNode);H=Q.aK(Q.$c(iv(b.C)),Q.$c(H));H=Q.filter(H,VC);Q.forEach(H,function(b){var c=b.style.outline;b.style.outline=
"0px solid red";b.style.outline=c})}L.execCommand(c,m,d);g&&Tp&&L.execCommand("styleWithCSS",m,m);D&&(!E("526")&&"formatblock"==c.toLowerCase()&&d&&/^[<]?h\d[>]?$/i.test(d))&&Q.forEach(b.re(),function(b){"Apple-style-span"==b.className&&(b.style.fontSize="",b.style.fontWeight="")});if(/insert(un)?orderedlist/i.test(c)){if(D){var ha=m;Q.forEach(b.re(),function(b){var c=b.tagName;if("UL"==c||"OL"==c)if(ha){if(c=qc(b)){var d=b.ownerDocument.createRange();d.setStartAfter(c);d.setEndBefore(b);if(Ka(d.toString())&&
c.nodeName==b.nodeName){for(;c.lastChild;)b.insertBefore(c.lastChild,b.firstChild);c.parentNode.removeChild(c)}}}else ha=j})}if(A){for(c=(c=b.re())&&c.rc();c&&"UL"!=c.tagName&&"OL"!=c.tagName;)c=c.parentNode;c&&(c=c.parentNode);c&&(d=z.toArray(c.getElementsByTagName("UL")),z.extend(d,z.toArray(c.getElementsByTagName("OL"))),z.forEach(d,function(b){var c=b.type;if(c&&!("UL"==b.tagName?CD:DD)[c])b.type=""}));n&&N(n)}}l&&N(l);h&&b.C.execCommand(h)},a.zD={indent:1,outdent:1,insertOrderedList:1,insertUnorderedList:1,
justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,ltr:1,rtl:1},a.yD={insertOrderedList:1,insertUnorderedList:1},a.DD={1:1,a:1,A:1,i:1,I:1},a.CD={disc:1,circle:1,square:1},a.AD={justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,formatBlock:1},a.BD={insertOrderedList:1,insertUnorderedList:1},a.ED={center:1,justify:1,right:1,left:1},a.xD=function(b,c){var d=c.replace("+justify","").toLowerCase();"full"==d&&(d="justify");var e=b.C.Kh("Bidi");if(e)return d==e.TW();var g=b.re();if(!g)return m;
for(var h=g.Cb(),e=z.filter(h.childNodes,function(b){return Zr(b)&&g.containsNode(b,j)}),e=e.length?e:[h],h=0;h<e.length;h++){var l=WC(e[h]),n=d,q=Xf(l,"textAlign"),q=q.replace(/^-(moz|webkit)-/,"");ED[q]||(q=l.align||"left");if(n!=q)return m}return j};nD.prototype.Us=function(b,c,d){return tD(this,m,b,c,d)};a.tD=function(b,c,d,e,g){e=wD(e);if(g){var h=qD(b);h.execCommand("styleWithCSS",m,j)}b=c?d.queryCommandState(e):d.queryCommandValue(e);g&&h.execCommand("styleWithCSS",m,m);return b};a.FD=function(b,c){O.call(this);this.Cs=[];for(this.ys=[];b&&"BODY"!=b.nodeName&&b!=c;){for(var d=0,e=b.previousSibling;e;)e=e.previousSibling,++d;this.Cs.unshift(d);this.ys.unshift(b.nodeName);b=b.parentNode}};y(FD,O);FD.prototype.toString=function(){for(var b=[],c,d=0;c=this.ys[d];d++)b.push(this.Cs[d]+","+c);return b.join("\n")};a.GD=function(b,c){for(var d,e=c,g=0;d=b.ys[g];++g)if(e=e.childNodes[b.Cs[g]],!e||e.nodeName!=d)return k;return e};FD.prototype.w=function(){delete this.Cs;delete this.ys};le("goog.editor.plugins.Blockquote");a.HD=function(){Gu.call(this)};y(HD,Gu);t=HD.prototype;t.eh="DIV";t.hd=s("EnterHandler");t.enable=function(b){HD.n.enable.call(this,b);eq&&("P"==this.eh||"DIV"==this.eh)&&OC(this).Ca().execCommand("opera-defaultBlock",m,this.eh)};t.qG=function(b){return!b||Wr(b)?Rp?this.QL():"":b};t.QL=lf("<br>");
t.EM=function(b){if(C&&this.C.Fg)return m;if(8==b.keyCode){var c=iv(this.C),d=this.C.h(),c=c&&c.V();d.firstChild==c&&Fs(c)&&(b.preventDefault(),b.stopPropagation())}else if(13==b.keyCode)if(C){if(!b.shiftKey){var d=iv(this.C),c=!d||d.isCollapsed(),e=Mp?ID(this):JD(this),g=this.C.execCommand("+splitBlockquote",e);g&&(b.preventDefault(),b.stopPropagation());Mp||e.removeNode(j);g||this.vM(b,c,d)}}else{this.C.Ah();d=Mp?ID(this):JD(this);if(c=!!this.C.execCommand("+splitBlockquote",d))b.preventDefault(),
b.stopPropagation();Mp||d.removeNode(j);D&&this.wM(b);if(A||rb)KD(this);else if(!c&&D){if(c=d=iv(this.C))a:{for(c=d.Cb();c;c=c.parentNode)if(hD(c)){c="BLOCKQUOTE"==c.tagName;break a}c=m}if(c){c=OC(this);e=c.createElement("BR");d.insertNode(e,j);if(d=hD(e.parentNode)){for(d=e.nextSibling;d&&3==d.nodeType&&!d.nodeValue;)d=d.nextSibling;d=!d}d&&ic(c.createElement("BR"),e);Nr(e,m);b.preventDefault()}}this.C.Ve()}else if(C&&46==b.keyCode&&(c=iv(this.C),c.isCollapsed()&&(d=c.ea(),1==d.nodeType&&(c=d.childNodes[c.Ia()])&&
"BR"==c.tagName)))e=$r(Q.filter(new Yr(c,m,j),Zr)),g=c.nextSibling,d.removeChild(c),b.preventDefault(),g&&hD(g)&&(e&&!("BR"==e.tagName||hD(e))?Ip(e,Gr(e)).select():(b=ps(g),Ip(b,0).select()));return m};t.ur=function(b){if(C&&this.C.Fg)return m;(A||rb)&&13==b.keyCode&&KD(this,j);return m};t.wM=ia;t.vM=ia;
a.LD=G.yh("LI","DIV","H1","H2","H3","H4","H5","H6"),a.KD=function(b,c){for(var d=iv(b.C),e=d.rc(),g=b.C.h(),h;e&&e!=g;){var l=e.nodeName;if("DIV"==l||LD[l]&&(!c||!(Fs(e)&&1==e.getElementsByTagName("BR").length))){if(rb&&h){"DIV"==l&&(h==e.lastChild&&Fs(h))&&(jc(h,e),Vo(h).select());break}return}rb&&(c&&"P"==l&&"DIV"!=l)&&(h=e);e=e.parentNode}if(A&&!E(9)){var n=m,d=d.Pd(),e=d.duplicate();e.moveEnd("character",1);if(e.text.length&&(n=e.parentElement(),e=e.duplicate(),e.collapse(m),e=e.parentElement(),
n=n!=e&&e!=d.parentElement()))d.move("character",-1),d.select()}b.C.hb.Ca().execCommand("FormatBlock",m,"<DIV>");n&&(d.move("character",1),d.select())},a.JD=function(b){var b=OC(b).Ca(),c=b.selection.createRange(),d=db();c.pasteHTML('<span id="'+d+'"></span>');b=b.getElementById(d);b.id="";return b},a.ID=function(b){b=iv(b.C);if(!b.isCollapsed()){var c=j;if(rb){var d=b.V(),e=b.ta();d==b.ea()&&(d.lastChild&&"BR"==d.lastChild.tagName&&e==d.childNodes.length-1)&&(c=m)}if(c){var g=b;if(g&&!g.isCollapsed()){var h=
j,c=g.Cb(),d=new FD(g.V(),c),e=g.ta(),l;l=g;var n=l.V();VC(n)&&(n=n.childNodes[l.ta()]||n);var n=WC(n),q=l.ea();VC(q)&&(q=q.childNodes[l.Ia()]||q);q=WC(q);l=n==q;if(n=!l)a:{var q=g,n=q.ea(),q=q.Ia(),r=n;if(VC(r)){var w=r.childNodes[q];if(!w||1==w.nodeType&&VC(w)){n=m;break a}}for(w=WC(r);w!=r;){if(iD(r)){n=j;break a}r=r.parentNode}n=q!=Gr(n)}g.Vc();(g=GD(d,c))?g=Ip(g,e):(g=Ip(c,c.childNodes.length),h=m);g.select();l&&(l=WC(g.V()),Fs(l,j)&&(h="&nbsp;",rb&&"LI"==l.tagName&&(h="<br>"),l.innerHTML=h,
Es(l.firstChild),h=m));n&&(g=WC(g.V()),l=iD(g),g&&l&&(gc(g,l.childNodes),N(l)));h&&(g=Ip(GD(d,c),e),g.select())}}}return TC(b,j)};a.MD=function(){},a.ND=new MD,a.OD=["click",C?"keypress":"keydown"];MD.prototype.e=function(b,c,d,e,g){function h(b){if("click"==b.type&&nd(b))c.call(e,b);else if(13==b.keyCode||3==b.keyCode)b.type="keypress",c.call(e,b)}h.Cj=c;h.jt=e;g?g.e(b,OD,h):P(b,OD,h)};MD.prototype.Ea=function(b,c,d,e,g){for(var h=0;d=OD[h];h++){var l;l=yd(b,d,m)||[];for(var n,q=0;n=l[q];q++)if(n.Tf.Cj==c&&n.Tf.jt==e){g?g.Ea(b,d,n.Tf):xd(b,d,n.Tf);break}}};a.QD=function(b){O.call(this);this.pk=b||window;this.ps=P(this.pk,"resize",this.Nw,m,this);this.jc=Xb(this.pk);if(D&&lb||rb&&this.pk.self!=this.pk.top)this.Vt=window.setInterval(v(this.GB,this),PD)};y(QD,Gd);a.PD=500;t=QD.prototype;t.ps=k;t.pk=k;t.jc=k;t.Vt=k;t.pl=function(){return this.jc?this.jc.clone():k};t.w=function(){QD.n.w.call(this);this.ps&&(zd(this.ps),this.ps=k);this.Vt&&(window.clearInterval(this.Vt),this.Vt=k);this.jc=this.pk=k};t.Nw=function(){this.GB()};
t.GB=function(){var b=Xb(this.pk);Ob(b,this.jc)||(this.jc=b,this.dispatchEvent("resize"))};a.SD=function(b,c){O.call(this);this.aa=Rb(b);this.N=new me(this);this.qA=new QD(this.aa.Oa());this.ld={};this.rd=this.aa.v("DIV",{className:RD});R(this.rd,m);b.appendChild(this.rd);Tf(this.rd,"zIndex",c);this.Om=this.rd;this.pK=this.aa.v("DIV",{className:"tr_bubble_closebox",innerHTML:"&nbsp;"});this.Om.appendChild(this.pK);gD(this.rd,this.N);this.$h=new Ph(this.rd)};y(SD,Gd);a.RD="tr_bubble";t=SD.prototype;t.Kb=le("goog.ui.editor.Bubble");
t.w=function(){SD.n.w.call(this);N(this.rd);this.rd=k;this.N.G();this.N=k;this.qA.G();this.qA=k};t.U=p("Om");t.Cb=p("rd");t.mN=function(){this.P()&&this.fa()};t.UM=function(){for(var b in this.ld)N(this.ld[b].element);this.ld={};F.remove(this.rd,"tr_multi_bubble");this.N.removeAll();this.dispatchEvent("hide")};t.P=function(){return this.$h.P()};a.TD=A?4:2,a.UD=new Of(TD,0,TD,0);
SD.prototype.fa=function(){var b=k,c=j,d;for(d in this.ld)var e=this.ld[d],b=e.Tz,c=c&&e.QQ;d=496;b=eg(this.rd)!=eg(b);c&&(d=VD(this,b?7:5,4,9));d&496&&(d=VD(this,b?6:4,5,9));d&496&&(d=VD(this,b?7:5,4,5),d&496&&this.Kb.lk("reposition(): positionAtAnchor() failed with "+d))};
a.VD=function(b,c,d,e){var g=k,h;for(h in b.ld){var l=b.ld[h].Tz;if(!g||rc(l,g))g=b.ld[h].Tz}return am(g,c,b.rd,d,k,UD,e)},a.WD=function(b,c,d,e,g,h){this.type=d;this.Tz=g;this.QQ=h;this.element=b.v("DIV",{className:"tr_bubble_panel",id:c},b.v("DIV",{className:"tr_bubble_panel_title"},e+":"),b.v("DIV",{className:"tr_bubble_panel_content"}))};WD.prototype.U=function(){return this.element.lastChild};a.XD=function(){Gu.call(this);this.fc=new me(this)};y(XD,Gu);a.YD=function(b,c){return new SD(b,c)},a.ZD={};t=XD.prototype;t.Mj=k;t.Ax=m;t.hd=lf("AbstractBubblePlugin");t.ur=function(){this.P()&&this.kj();return m};
t.kj=function(b,c){var d;if(b)d=b.target;else if(c)d=c;else{var e=iv(this.C);if(e){var g=e.V(),h=e.ea(),l=e.ta(),n=e.Ia();A&&(e.isCollapsed()&&g!=h)&&(e=Ip(g,l));1==g.nodeType&&(g==h&&l==n-1)&&(g=g.childNodes[l],1==g.nodeType&&(d=g))}d=d||e&&e.Cb()}var q;a:{if(d&&(l=this.NL(d))){if(l!=this.Ft||!this.Mj){$D(this);this.Vg&&Rr(this.Vg);d=aE(this);var r=this.iw();if(!G.some(d.ld,function(b){return b.type==r})){this.Ft=l;var g=this.iw(),n=this.fD(),h=v(this.GK,this),w=this.cS(),e=db(),l=new WD(d.aa,e,
g,n,l,!w);d.ld[e]=l;n=0;for(w=d.Om.childNodes.length-1;n<w;n++){var B=d.Om.childNodes[n];if(d.ld[B.id].type>g){q=B;break}}ic(l.element,q||d.Om.lastChild);h(l.U());gD(l.element,d.N);q=G.Ra(d.ld);1==q?(d.N.e(d.qA,"resize",d.mN).e(d.$h,"hide",d.UM),d.$h.D(j),d.fa()):2==q&&F.add(d.rd,"tr_multi_bubble");d.fa();this.Mj=e;this.fc.e(d,"hide",this.FD);this.Yh();this.Ax&&this.fc.e(d.U(),"keydown",this.mP);this.fc.e(d.U(),"mouseover",function(){this.Vg&&this.Vg.stop()},this)}}else this.Vg&&this.Vg.stop();q=
m;break a}$D(this);q=m}return q};t.disable=function(b){if(b.Dj==Tu){var c=ZD[b.id];c&&(c.G(),delete ZD[b.id])}};a.aE=function(b){var c=b.hW||b.C.Bk.document.body;b.aa=Rb(c);var d=ZD[b.C.id];d||(d=YD.call(k,c,b.C.SJ||0),ZD[b.C.id]=d);return d};t.iw=s("");t.fD=s("");t.cS=mf;
a.$D=function(b){if(b.Mj&&(!b.Vg||!b.Vg.Xb()))b.Vg=new yj(function(){if(this.Mj){var b=aE(this),d=this.Mj;N(b.ld[d].element);delete b.ld[d];d=G.Ra(b.ld);1>=d&&F.remove(b.rd,"tr_multi_bubble");0==d?b.$h.D(m):b.fa();this.FD()}},250,b),b.Vg.start()};t.Yh=ia;t.FD=function(){this.Mj=this.Ft=k;this.fc.removeAll()};t.Kw=function(b){if(this.Ax&&this.P()&&9==b.keyCode&&!b.shiftKey){var c=aE(this).U();if(c=K("tr_bubble_link",c))return c.focus(),b.preventDefault(),j}return m};
t.mP=function(b){if(this.P()&&9==b.keyCode){var c=aE(this).U(),c=Ub("tr_bubble_link",c);if(b.shiftKey?c[0]==b.target:c.length&&c[c.length-1]==b.target)this.C.focus(),b.preventDefault()}};t.P=function(){return!!this.Mj};t.fa=function(){var b=aE(this);b&&b.fa()};
t.Eq=function(b,c,d,e,g){c=this.aa.v("SPAN",{className:"tr_bubble_link"},g?this.aa.v("I",{className:g},c):c);this.Ax&&c.setAttribute("tabindex",0);c.setAttribute("role","link");e?e.appendChild(c):(e=this.aa.h(b))&&lc(c,e);c.id=b;gD(c,this.fc);d&&(b=this.fc,ND.e(c,d,i,b.ca||b,b));return c};x("Go to link: ");x("Change");x("Remove");a.bE=function(b){O.call(this);this.dd=b};y(bE,Gd);bE.prototype.show=function(){this.Ue||(this.Ue=this.hv(),this.Ue.addEventListener(di,this.YL,m,this));this.Ue.D(j)};bE.prototype.hide=function(){this.Ue&&this.Ue.D(m)};bE.prototype.ob=function(){return!!this.Ue&&this.Ue.P()};a.cE=function(b){this.Yk=b;this.vi=new Uh("",j,this.Yk.dd);this.Rm=new bi(this.Yk.dd);this.Qm={};this.oh("tr-dialog")};cE.prototype.Ya=function(b){this.vi.Ya(b);return this};
a.dE=function(b,c){var d=x("OK");b.Rm.set("ok",c||d,j);b.Qm.ok=v(b.Yk.RM,b.Yk)},a.eE=function(b){var c=ji,d=x("取消");b.Rm.set(c,d,m,j);b.Qm[c]=v(b.Yk.zw,b.Yk);return b};cE.prototype.ge=function(b,c,d){d=d||db();this.Rm.set(d,b);this.Qm[d]=c;return this};cE.prototype.oh=function(b){F.add(Xh(this.vi),b);return this};cE.prototype.Ha=function(b){this.vi.U().appendChild(b);return this};
a.fE=function(b){b.Rm.Fb()&&(dE(b),eE(b));gi(b.vi,b.Rm);var c=b.Qm;b.Qm=k;b.vi.addEventListener(hi,function(b){if(c[b.key])return c[b.key](b)});$h(b.vi,j);var d=b.vi;b.vi=k;return d};t=bE.prototype;t.jw=function(b){return this.Ue.nc.fd(b)};t.RM=function(b){return(b=this.Ym(b))?this.dispatchEvent(b):m};t.zw=function(){return this.dispatchEvent("cancel")};t.w=function(){this.Ue&&(this.hide(),this.Ue.G(),this.Ue=k);bE.n.w.call(this)};t.YL=function(){this.dispatchEvent("afterhide")};a.gE=function(b){Gu.call(this);this.xK=b};y(gE,Gu);t=gE.prototype;t.Ae=function(b){return b==this.xK};t.execCommand=function(b,c){return this.Ye.apply(this,arguments)};t.lw=p("nb");t.Ye=function(b,c){this.PG||hE(this);this.nb||(this.nb=this.gv(Rb(this.C.Bk),c));var d=iv(this.C);this.ez=d&&new $C(d);Hs(this.C.hb.Oa());wd(this.nb,"afterhide",this.wn,m,this);this.C.Fg=j;this.nb.show();this.dispatchEvent("dialogOpened");Ku(this.C);return j};
t.wn=function(){this.C.Fg=m;iE(this);this.PG||hE(this);this.dispatchEvent("dialogClosed");Ku(this.C);this.C.Jq.selectionchange=Aa()};a.iE=function(b){b.ez&&(b.ez.restore(),b.ez=k);b.C.focus()};t.w=function(){hE(this);gE.n.w.call(this)};t.PG=m;t.px=m;a.hE=function(b){b.nb&&!b.px&&(b.px=j,b.nb.G(),b.nb=k,b.px=m)};a.jE=function(){};y(jE,Nn);ja(jE);t=jE.prototype;t.L=s("goog-tab");t.qc=function(){return Vc.PA};t.v=function(b){var c=jE.n.v.call(this,b);(b=b.Pf())&&this.Lc(c,b);return c};t.o=function(b,c){var c=jE.n.o.call(this,b,c),d=this.Pf(c);d&&b.rt(d);if(b.Z&8&&(d=b.getParent())&&qa(d.km))b.Zb(8,m),d.km(b);return c};t.Pf=function(b){return b.title||""};t.Lc=function(b,c){b&&(b.title=c||"")};a.kE=function(b,c,d){Wn.call(this,b,c||jE.O(),d);Zn(this,8,j);this.ak|=9};y(kE,Wn);kE.prototype.Pf=p("mp");kE.prototype.Lc=function(b){this.M.Lc(this.h(),b);this.rt(b)};kE.prototype.rt=ca("mp");Un("goog-tab",function(){return new kE(k)});a.lE=function(){};y(lE,vo);ja(lE);lE.prototype.L=s("goog-tab-bar");lE.prototype.qc=function(){return Vc.QI};lE.prototype.rz=function(b,c,d){this.aF||(this.tq||mE(this),this.aF=G.tm(this.tq));var e=this.aF[c];e?(b.Ro(e==nE||e==oE?yo:xo),b.bF=e):lE.n.rz.call(this,b,c,d)};lE.prototype.af=function(b){var c=lE.n.af.call(this,b);this.tq||mE(this);c.push(this.tq[b.bF]);return c};a.mE=function(b){var c=b.L();b.tq=G.create(pE,c+"-top",qE,c+"-bottom",nE,c+"-start",oE,c+"-end")};a.sE=function(b,c,d){b=b||pE;this.Ro(b==nE||b==oE?yo:xo);this.bF=b;Ms.call(this,this.vb,c||lE.O(),d);rE(this)};y(sE,Ms);a.pE="top",a.qE="bottom",a.nE="start",a.oE="end";t=sE.prototype;t.LJ=j;t.mf=k;t.B=function(){sE.n.B.call(this);rE(this)};t.w=function(){sE.n.w.call(this);this.mf=k};t.removeChild=function(b,c){tE(this,b);return sE.n.removeChild.call(this,b,c)};t.mz=function(b){sE.n.mz.call(this,b);this.LJ&&this.km(Oh(this,b))};t.km=function(b){b?b.jm(j):this.mf&&this.mf.jm(m)};
a.tE=function(b,c){if(c&&c==b.mf){for(var d=Ur(b,c),e=d-1;c=Oh(b,e);e--)if(c.P()&&c.isEnabled()){b.km(c);return}for(d+=1;c=Oh(b,d);d++)if(c.P()&&c.isEnabled()){b.km(c);return}b.km(k)}};t.dN=function(b){this.mf&&this.mf!=b.target&&this.mf.jm(m);this.mf=b.target};t.eN=function(b){b.target==this.mf&&(this.mf=k)};t.bN=function(b){tE(this,b.target)};t.cN=function(b){tE(this,b.target)};t.te=function(){Ps(this)||this.od(this.mf||Oh(this,0))};
a.rE=function(b){b.m().e(b,"select",b.dN).e(b,"unselect",b.eN).e(b,"disable",b.bN).e(b,"hide",b.cN)};Un("goog-tab-bar",function(){return new sE});a.uE=function(){Gu.call(this)};y(uE,Gu);uE.prototype.vr=function(b){if(C&&this.C.Fg)b=m;else if(9==b.keyCode&&!b.metaKey&&!b.ctrlKey){var c=iv(this.C);Ic(c.Cb(),"LI")||Q.some(c,function(b){return"LI"==b.tagName})?(this.C.execCommand(b.shiftKey?"+outdent":"+indent"),b.preventDefault(),b=j):b=m}else b=m;return b};a.vE=function(){Gu.call(this)};y(vE,uE);vE.prototype.hd=s("ListTabHandler");a.wE=function(b){Gu.call(this);this.PO=b};y(wE,Gu);t=wE.prototype;t.hd=lf("LoremIpsum");t.Pp=nf;t.xp=m;t.queryCommandValue=function(b){return"usinglorem"==b&&this.xp};
t.execCommand=function(b,c){if("clearlorem"==b){var d=!!c,e=this.C;if(this.xp&&!e.Fg){var g=e.h();g||(g=e.Hc);this.xp=m;g.style.fontStyle=this.bP;e.Ad(j,k,j);d&&e.Td()&&(D?(Qb(e.h()).body.focus(),e.Of()):rb&&nv(e))}}else"updatelorem"==b&&(d=this.C,!this.xp&&(!d.Fg&&Vu!=d.id)&&((e=d.h())||(e=d.Hc),Fs(e)&&(this.xp=j,this.bP=e.style.fontStyle,e.style.fontStyle="italic",d.Ad(j,this.PO,j))))};t.Ae=function(b){return"clearlorem"==b||"updatelorem"==b||"usinglorem"==b};a.xE=function(b){this.lB=b};y(xE,Gd);a.yE=function(){O.call(this);this.LO=100;this.Dd=[];this.Sj=[];this.Ls=[]};y(yE,Gd);t=yE.prototype;t.Mr=k;t.eA=function(){zE(this,this.Dd,this.Sj)};t.Ty=function(){zE(this,this.Sj,this.Dd)};a.zE=function(b,c,d){if(c.length){var e=c.pop();d.push(e);b.Ls.push({type:c==b.Dd?"before_undo":"before_redo",cD:c==b.Dd?e.eA:e.Ty,state:e});1==b.Ls.length&&b.yg();(0==c.length||1==d.length)&&b.dispatchEvent("state_change")}};
t.yg=function(){if(!(this.Mr||0==this.Ls.length)){var b=this.Ls.shift();this.dispatchEvent({type:b.type,state:b.state})&&(b.state.lB?(this.Mr=P(b.state,"action_completed",this.uL,m,this),b.cD.call(b.state)):(b.cD.call(b.state),this.yg()))}};t.uL=function(){zd(this.Mr);this.Mr=k;this.yg()};a.AE=function(b){Gu.call(this);b=b||new yE;this.dF&&zd(this.dF);this.Zd=b;this.dF=P(this.Zd,"state_change",this.cL,m,this);this.Zi={};this.an={};this.kE=k;this.VJ=v(this.zR,this)};y(AE,Gu);AE.prototype.Kb=le("goog.editor.plugins.UndoRedo");AE.prototype.Fn=k;a.BE=G.tm({RV:"+undo",jV:"+redo"});t=AE.prototype;t.Ae=function(b){return b in BE};t.NH=function(b){this.disable(b);this.C=k};
t.enable=function(b){if(!this.isEnabled(b)){jv(b);var c=new me(this);C||c.e(b,"beforechange",this.$L);c.e(b,Pu,this.hM);c.e(b,"blur",this.yw);this.Zi[b.Eg]=c;CE(this,b)}};t.disable=function(b){jv(b);var c=this.Zi[b.Eg];c&&(c.G(),delete this.Zi[b.Eg]);this.an[b.Eg]&&delete this.an[b.Eg]};t.isEnabled=function(b){return!!this.Zi[b.Eg]};t.w=function(){AE.n.w.call(this);for(var b in this.Zi)this.Zi[b].G(),delete this.Zi[b];this.C=k;this.Zd&&(this.Zd.G(),delete this.Zd)};t.hd=s("UndoRedo");
t.execCommand=function(b){"+undo"==b?this.Zd.eA():"+redo"==b&&this.Zd.Ty()};t.queryCommandValue=function(b){var c=k;"+undo"==b?c=0<this.Zd.Dd.length:"+redo"==b&&(c=0<this.Zd.Sj.length);return c};t.cL=function(){this.C.dispatchEvent({type:"cvc",yK:["+redo","+undo"]})};
t.zR=function(b,c,d){var e=this.C;if(e){Ju(e,j,j);try{e.Ah();e.execCommand("clearlorem",j);e.h().innerHTML=c;d&&d.select();var g=this.C;e.focus();g&&g.Eg!=b.nn&&g.execCommand("updatelorem");var h=this.an[b.nn];h.qi=c;h.LH=d}catch(l){this.Kb.log(ce,"Error while restoring undo state",l)}finally{this.Fn=b,e.Ve(),Ku(e)}}};
t.vr=function(b,c,d){if(d){var e;"z"==c?e=b.shiftKey?"+redo":"+undo":"y"==c&&(e="+redo");if(e)return(b="+undo"==e?this.Zd.Dd[this.Zd.Dd.length-1]:this.Zd.Sj[this.Zd.Sj.length-1])&&b.nn?this.C.execCommand(e):this.execCommand(e),j}return m};t.$L=function(b){if(!this.Fn){var b=b.target,c=b.Eg;this.kE!=c&&(this.kE=c,CE(this,b))}};t.hM=function(b){this.Fn?(b=this.Fn,this.Fn=k,b.dispatchEvent("action_completed")):CE(this,b.target)};t.yw=function(b){(b=b.target)&&jv(b)};
a.CE=function(b,c){var d=c.Eg,e,g;c.queryCommandValue("usinglorem")?(e="",g=k):(e=c.h().innerHTML,g=new DE(c),g=!g.isValid()?k:g);var h=b.an[d];if(h){if(h.qi==e)return;if(""==e||""==h.qi){var l=c.Ws(8,"",{});if(e==l&&""==h.qi||h.qi==l&&""==e)return}h.Uy=e;h.aR=g;l=b.Zd;if(0==l.Dd.length||!h.equals(l.Dd[l.Dd.length-1])){l.Dd.push(h);l.Dd.length>l.LO&&l.Dd.shift();var n=l.Sj.length;l.Sj.length=0;l.dispatchEvent({type:"state_added",state:h});(1==l.Dd.length||n)&&l.dispatchEvent("state_change")}}b.an[d]=
new EE(d,e,g,b.VJ)},a.EE=function(b,c,d,e){this.lB=j;this.nn=b;this.MG=e;this.qi=c;this.LH=d};y(EE,xE);EE.prototype.eA=function(){this.MG(this,this.qi,this.LH)};EE.prototype.Ty=function(){this.MG(this,this.Uy,this.aR)};EE.prototype.equals=function(b){return this.nn==b.nn&&this.qi==b.qi&&this.Uy==b.Uy};
a.DE=function(b){this.Md=b;var c=b.hb.Oa(),b=(b=iv(b))&&b.Rf()&&b.Oa()==c?b:k;if(Mp){if(c=b,this.cs=m,c){var d=So(c),e=To(c);if(d&&e){var b=c.Qh()?c.Ia():c.ta(),d=new FD(d,this.Md.h()),g=Uo(c),e=new FD(e,this.Md.h());c.Qh()?(this.Ba=e,this.Jz=g,this.ya=d,this.Iv=b):(this.Ba=d,this.Jz=b,this.ya=e,this.Iv=g);this.cs=j}}}else Lp&&(c=b,this.cs=m,c&&(b=c.se(0).Pd(),rc(this.Md.h(),b.parentElement())&&(c=this.Md.hb.Ca().body.createTextRange(),c.moveToElementText(this.Md.h()),e=b.duplicate(),e.collapse(j),
e.setEndPoint("StartToStart",c),this.Ba=FE(e),b=b.duplicate(),b.setEndPoint("StartToStart",c),this.ya=FE(b),this.cs=j)))};DE.prototype.isValid=p("cs");DE.prototype.toString=function(){return Mp?"W3C:"+this.Ba.toString()+"\n"+this.Jz+":"+this.ya.toString()+"\n"+this.Iv:"IE:"+this.Ba+","+this.ya};DE.prototype.select=function(){var b=this.re(this.Md.h());b&&(Lp&&this.Md.h().focus(),Hp(b).select())};
DE.prototype.re=function(b){if(Mp){var c=GD(this.Ba,b),b=GD(this.ya,b);return!c||!b?k:sp(c,this.Jz,b,this.Iv).Pd()}c=b.ownerDocument.body.createTextRange();c.moveToElementText(b);c.collapse(j);c.moveEnd("character",this.ya);c.moveStart("character",this.Ba);return c};
a.FE=function(b){var c=b.duplicate(),d=b.text,e=d.length;c.collapse(j);c.moveEnd("character",e);for(var g,h=10;(g=c.compareEndPoints("EndToEnd",b))&&!(e-=g,c.moveEnd("character",-g),--h,0==h););b=0;for(c=d.indexOf("\n\r");-1!=c;)++b,c=d.indexOf("\n\r",c+1);return e+b};a.GE=function(b,c){uo.call(this,b||Ny.O(),c)};y(GE,uo);Un("goog-toolbar-separator",function(){return new GE});a.IE=function(b,c){O.call(this);this.ca=new me(this);this.Md=b;this.rb=c;this.Py=[];Mh(this.rb,function(b){b.cb&&this.Py.push(HE(b.Qd()))},this);this.rb.Ke(m);this.ca.e(this.Md,"cvc",this.hT).e(this.rb,"action",this.WL)};y(IE,Gd);a.HE=function(b){return b};t=IE.prototype;t.m=p("ca");t.hr=p("Md");t.P=function(){return this.rb.P()};t.D=function(b){this.rb.D(b)};t.isEnabled=function(){return this.rb.isEnabled()};t.Xa=function(b){this.rb.Xa(b)};t.blur=function(){this.rb.Rc(k)};
t.w=function(){IE.n.w.call(this);this.ca&&(this.ca.G(),delete this.ca);this.rb&&(this.rb.G(),delete this.rb);delete this.Md;delete this.Py};t.hT=function(b){if(this.rb.isEnabled()&&this.dispatchEvent("change")){var c;try{c=this.Md.queryCommandValue(b.yK||this.Py)}catch(d){c={}}var b=c,e;for(e in b)if(c=Kh(this.rb,e)){var g=b[e];c.ri?c.ri(g):c.Xc(!!g)}}};t.WL=function(b){var c=b.target.Qd();this.Md.execCommand(c,b.target.W())};a.JE=function(b){this.pL=b};y(JE,gd);JE.prototype.type="ok";a.KE=function(b){gd.call(this,"change");this.isValid=b};y(KE,gd);a.LE=function(b){return!b?"":"//www.zhihu.com/equation?tex="+encodeURIComponent(b)};a.ME=function(b){T.call(this,b)};y(ME,T);ME.prototype.lj="";ME.prototype.D=function(b){R(this.h(),b)};a.OE=function(b,c,d,e,g,h,l,n){this.pi=c;this.xk=l||[];for(var c=n||NE.O(),n=[],d=-d,e=-e,q=0;q<l.length;q++)n.push(M("DIV",{"class":c.L()+"-item",style:"width:"+g+"px;height:"+h+"px;background-position:"+d+"px "+e+"px;"})),d-=g;this.Xf=b;fz.call(this,n,c)};y(OE,fz);t=OE.prototype;t.Lh=p("pi");t.gl=function(b){return 0<=b&&b<this.xk.length?this.xk[b]:k};t.Qf=function(b){OE.n.Qf.call(this,b);this.Xf.dispatchEvent(new PE(QE,this))};
t.Mh=function(b){OE.n.Mh.call(this,b);b.relatedTarget&&!rc(this.h(),b.relatedTarget)&&this.Xf.qv()};t.jd=function(b){OE.n.jd.call(this,b);b.relatedTarget&&!rc(this.h(),b.relatedTarget)&&this.Xf.rv.stop()};a.PE=function(b,c,d){gd.call(this,b,d);this.GQ=c},a.QE="a";PE.prototype.rw=p("GQ");a.NE=function(){};y(NE,Yy);ja(NE);NE.prototype.L=s("ee-palette");a.RE=function(b){OE.call(this,b,"a",0,150,18,18,"\\leftarrow \\rightarrow \\leftrightarrow \\Leftarrow \\Rightarrow \\Leftrightarrow \\uparrow \\downarrow \\updownarrow \\Uparrow \\Downarrow \\Updownarrow".split(" "));jz(this,new Nb(12,1))};y(RE,OE);a.SE=function(b){OE.call(this,b,"c",0,70,18,18,"\\leq \\geq \\prec \\succ \\preceq \\succeq \\ll \\gg \\equiv \\sim \\simeq \\asymp \\approx \\ne \\subset \\supset \\subseteq \\supseteq \\in \\ni \\notin".split(" "));jz(this,new Nb(7,3))};y(SE,OE);a.TE=function(b){OE.call(this,b,"g",0,30,18,18,"\\alpha \\beta \\gamma \\delta \\epsilon \\varepsilon \\zeta \\eta \\theta \\vartheta \\iota \\kappa \\lambda \\mu \\nu \\xi \\pi \\varpi \\rho \\varrho \\sigma \\varsigma \\tau \\upsilon \\phi \\varphi \\chi \\psi \\omega \\Gamma \\Delta \\Theta \\Lambda \\Xi \\Pi \\Sigma \\Upsilon \\Phi \\Psi \\Omega".split(" "));jz(this,new Nb(7,6))};y(TE,OE);a.UE=function(b){OE.call(this,b,"m",0,90,30,56,"x_{a};x^{b};x_{a}^{b};\\bar{x};\\tilde{x};\\frac{a}{b};\\sqrt{x};\\sqrt[n]{x};\\bigcap_{a}^{b};\\bigcup_{a}^{b};\\prod_{a}^{b};\\coprod_{a}^{b};\\left( x \\right);\\left[ x \\right];\\left{ x \\right};\\left| x \\right|;\\int_{a}^{b};\\oint_{a}^{b};\\sum_{a}^{b}{x};\\lim_{a \\rightarrow b}{x}".split(";"));jz(this,new Nb(10,2))};y(UE,OE);a.WE=function(b){OE.call(this,b,"mn",0,0,46,18,["g","s","c","m","a"],VE.O());jz(this,new Nb(5,1))};y(WE,OE);WE.prototype.D=function(b,c){return WE.n.D.call(this,j,c)};a.VE=function(){};y(VE,NE);ja(VE);VE.prototype.L=s("ee-menu-palette");a.XE=function(b){OE.call(this,b,"s",0,50,18,18,"\\times \\div \\cdot \\pm \\mp \\ast \\star \\circ \\bullet \\oplus \\ominus \\oslash \\otimes \\odot \\dagger \\ddagger \\vee \\wedge \\cap \\cup \\aleph \\Re \\Im \\top \\bot \\infty \\partial \\forall \\exists \\neg \\angle \\triangle \\diamond".split(" "));jz(this,new Nb(7,5))};y(XE,OE);a.YE=function(){O.call(this);this.gG={};this.Am=k;this.N=new me(this);this.rv=new Id(300);this.N.e(this.rv,Kd,this.sD)};y(YE,Gd);t=YE.prototype;t.rw=function(b){var c=this.gG,d=c[b];if(!d){switch(b){case "mn":d=new WE(this);break;case "g":d=new TE(this);break;case "s":d=new XE(this);break;case "c":d=new SE(this);break;case "m":d=new UE(this);break;case "a":d=new RE(this);break;default:f(Error("Invalid palette type!"))}c[b]=d}return d};
t.setActive=function(b){var c=this.Am;c&&c.D(m);this.Am=c=this.rw(b);c.D(j);return c};t.qv=function(){this.rv.start()};t.sD=function(){this.setActive("mn")};t.w=function(){YE.n.w.call(this);this.gG=this.Am=k};a.ZE=function(b,c,d){T.call(this,d);this.lj=c;this.Xf=b.FQ};y(ZE,ME);t=ZE.prototype;t.ME="";t.Uu=0;
t.v=function(){var b=x("TeX 公式"),c=x("预览"),d=x("Learn more"),e=this.aa,d=e.v("DIV",{style:"display: none;"},e.v("SPAN",{"class":"ee-section-title ee-section-title-floating"},b),this.lj?e.v("A",{id:"ee-section-learn-more",target:"_blank",href:this.lj},d):k,e.v("DIV",{style:"clear: both;"}),b=this.PN=e.v("DIV",{style:"position: relative"}));this.Xf.setActive("mn").X(b);b.appendChild(e.v("DIV",{style:"clear:both"}));var g=this.gh=e.v("textarea",{"class":"ee-tex",dir:"ltr"});b.appendChild(g);b.appendChild(e.v("DIV",
{"class":"ee-section-title"},c));c=this.SQ=e.v("DIV",{"class":"ee-preview-container"});b.appendChild(c);this.g=d};t.B=function(){this.wH=new du(this.gh);P(this.wH,"input",this.LD,m,this);this.m().e(this.gh,"keydown",this.LD);this.m().e(this.Xf,QE,this.TM,m,this)};t.D=function(b){ZE.n.D.call(this,b);b&&Ld(this.BL,0,this)};t.BL=function(){this.gh.focus();Or(this.gh,this.gh.value.length)};
a.$E=function(b){var c=b.kl();if(c!=b.ME){b.ME=c;var d=!(1024<c.length);b.dispatchEvent(new KE(d));var b=b.SQ,e=Rb(b);e.$s(b);c&&(d?c=e.v("IMG",{src:LE(c)}):(c=x("Equation is too long"),c=e.v("DIV",{"class":"ee-warning"},c)),e.appendChild(b,c))}};t.LD=function(){this.Uu++;Ld(v(this.fN,this,this.Uu),500)};t.fN=function(b){b==this.Uu&&$E(this)};
t.TM=function(b){var c=b.rw(),d=this.Xf,e=d.Am,b=this.gh;if("mn"==c.Lh()){var g=c.Eb,g=-1!=g?c.gl(g):k;if(e!=c&&e.Lh()==g){d.sD();return}g&&(c=this.Xf.setActive(g),c.h()||c.X(this.PN),c=c.h(),$f(c,0,-c.clientHeight))}else{e=this.Xf.Am;g=e.gl(e.Eb);if(!g)return;Ld(v(this.XN,this,g+" "),0)}b.focus()};t.XN=function(b){var c=this.gh,d=Wm(c),e=c.value,e=e.substring(0,d)+b+e.substring(d);c.value=e;Or(c,d+b.length);$E(this)};t.kl=function(){return this.gh.value};t.lz=function(b){this.gh.value=b;$E(this)};
t.w=function(){this.wH.G();this.Xf=k;ZE.n.w.call(this)};a.aF=function(b,c,d){T.call(this,d);this.WB=b;this.lj=c};y(aF,T);t=aF.prototype;t.hh=k;t.v=function(){aF.n.v.call(this);this.Cq()};t.Cq=function(){var b=this.h();this.hh=new ZE(this.WB,this.lj,this.aa);this.H(this.hh);this.hh.X(b);this.hh.D(j)};t.$=function(b){this.g=b;this.Cq()};t.kl=function(){return this.hh.kl()};t.lz=function(b){this.hh.lz(b)};t.pw=function(){var b=this.kl(),c=LE(b);return!c?"":'<img src="'+c+'" alt="'+Wa(b)+'" class="ee_img tr_noresize" eeimg="1" style="vertical-align: middle">'};
t.isValid=function(){return 1024<this.kl().length};t.D=function(b){this.hh.D(b)};t.w=function(){this.hh&&this.hh.G();this.WB=k;aF.n.w.call(this)};a.bF=function(b,c,d,e){bE.call(this,c);this.Yi=new aF(b,e);this.Yi.X();this.Yi.lz(d);this.Yi.addEventListener("+equation",this.po,m,this)};y(bF,bE);bF.prototype.hv=function(){var b=new cE(this),c=x("公式编辑器"),d=x("插入公式"),e=x("保存"),d=this.Yi.kl()?e:d;dE(eE(b.Ya(c).Ha(this.Yi.h())),d);return fE(b)};bF.prototype.Ym=function(){if(this.Yi.isValid())return k;var b=this.Yi.pw();return new JE(b)};bF.prototype.po=function(b){this.DF||(this.DF=this.jw("ok"));this.DF.disabled=!b.isValid};a.cF=function(b){this.lj=b||"";gE.call(this,"+equation")};y(cF,gE);t=cF.prototype;t.Da=le("goog.editor.plugins.EquationEditorPlugin");t.hd=lf("EquationEditorPlugin");t.gv=function(b,c){var d=c||k,e;d?(e=d.getAttribute("alt"),e||(e=d.getAttribute("src"),e=!e?"":decodeURIComponent(e.match(we)[6]||k).slice(4)||"")):e="";this.fG=d;d={};d.FQ=new YE;d=new bF(d,b,e,this.lj);d.addEventListener("ok",this.An,m,this);return d};t.enable=function(b){cF.n.enable.call(this,b)};
t.disable=function(b){cF.n.disable.call(this,b)};t.An=function(b){iE(this);this.C.Ah();b=dc(OC(this).Ga,b.pL);if(this.fG)lc(b,this.fG);else{var c=iv(this.C);c.isCollapsed()||c.Vc();b=c.insertNode(b,m)}Nr(b,m);this.C.Ve()};a.dF=function(){XD.call(this)};y(dF,XD);x("Equation:");a.eF=x("Edit"),a.fF=x("Remove");t=dF.prototype;t.hd=s("EquationBubble");t.NL=function(b){return b&&"IMG"==b.nodeName&&(b.getAttribute("eeimg")||F.has(b,"ee_img"))?b:k};t.GK=function(b){this.Eq("ee_bubble_edit",eF,this.hL,b,"zg-icon zg-icon-pen");this.Eq("ee_remove_remove",fF,this.jR,b,"zg-icon zg-icon-trash")};t.iw=s("IMG");t.fD=function(){return x("Equation")};t.jR=function(){this.C.Ah();N(this.Ft);$D(this);this.C.Ve()};
t.hL=function(){var b=this.Ft;$D(this);this.C.execCommand("+equation",b)};a.gF=function(b){Gu.call(this);this.kA="http://upload."+bh.am+":"+location.port+"/upload";G.extend(this.F={},this.defaults,b||{})};y(gF,Gu);t=gF.prototype;t.defaults={BX:ia};t.hd=lf("FastUpload");
t.enable=function(b){if(!this.isEnabled(b)&&!(!window.URL&&!window.webkitURL||!window.FileReader||!window.FormData||!document.addEventListener)){$.fn.draghover=function(){return this.each(function(){var b=$(),c=$(this),d=j;c.on("dragenter",function(l){l=l.originalEvent;0===b.size()&&(d&&z.contains(l.dataTransfer.types,"Files"))&&c.trigger("draghoverstart",l);b=b.add(l.target)});c.on("dragleave",function(l){setTimeout(function(){b=b.not(l.target);0===b.size()&&d&&c.trigger("draghoverend",l)},1)});
c.on("dragstart",function(){d=m});c.on("drop dragend",function(){b=$();c.trigger("draghoverend");d=j})})};this.vA=$(this.C.h());var c=OC(this),d=$('<div class="editable-dropzone"><div class="row"><div class="cell"><div>拖拽至此处上传</div></div></div></div>');c.mx(d[0],this.C.h());c=this.lI=d;new me(this);b.h().addEventListener("paste",v(this.Mw,this));document.addEventListener("dragover",v(this.tM,this),m);c.on("dragover",v(this.sM,this));c.get(0).addEventListener("drop",v(this.rr,this),m);$(window).draghover().on({draghoverstart:v(this.vD,
this),draghoverend:v(this.uM,this)});c.draghover().on({draghoverstart:v(this.mM,this),draghoverend:v(this.vD,this)})}};t.tM=function(b){z.contains(b.dataTransfer.types,"Files")&&(b.dataTransfer.dropEffect="none",b.preventDefault())};t.sM=function(b){b=b.originalEvent;b.dataTransfer.dropEffect="copy";b.preventDefault();b.stopPropagation()};t.vD=function(b){b.preventDefault();b.stopPropagation();hF(this,1)};t.mM=function(b){hF(this,2);b.stopPropagation()};
t.uM=function(b){b.preventDefault();hF(this,0)};a.hF=function(b,c){var d=[{display:"none"},{display:"table",width:b.vA.width(),height:b.vA.height(),"background-color":"rgba(255, 255, 255, 0.5)"}];d[2]=$.extend({},d[1],{"background-color":"rgba(245, 245, 245, 0.5)"});b.lI.css(d[c])};t.Mw=function(b){var c=this;b.clipboardData&&z.contains(b.clipboardData.types,"Files")&&z.forEach(b.clipboardData.items,function(d){-1<d.type.indexOf("image")&&(iF(c,d.getAsFile()),b.preventDefault())})};
t.rr=function(b){var c=this;c.C.execCommand("clearlorem");var d=b.dataTransfer.files;document.createElement("img");b.preventDefault();var e=[];z.forEach(d,function(b){-1<b.type.indexOf("image")?(iF(c,b),e.push(j)):e.push(m)});z.every(e,function(b){return!b})&&V("文件类型不支持！");hF(c,0)};
a.iF=function(b,c){var d=new FormData;d.append("via","xhr2");d.append("upload_file",c);var e;e=$.ajaxSettings.xhr();e.withCredentials=j;var g=$.ajax({url:b.kA,data:d,processData:m,contentType:m,xhr:function(){return e},type:"POST"}).done(function(b){"string"===$.type(b)&&(b=JSON.parse(b));if(1===b.code)V(b.msg);else{var c=new Image;c.src=b.msg[0];c.setAttribute("originImgSrc",c.src.replace("_m.jpg","_r.jpg"));c.setAttribute("data-rawWidth",b.msg[1]);c.setAttribute("data-rawHeight",b.msg[2]);g.BA.after(c)}}).fail(function(){V("上传失败！>_<")}).always(function(){g.BA.remove()}),
d=g,h;h=OC(b);var l=h.v("IMG",{"class":"",style:"display:block",src:"http://static.zhihu.com/static/img/spinner2.gif"}),n=iv(b.C);!n||!eD(n)||!rc(b.C.h(),n.Cb())?Fs(b.C.field)?kc(b.C.h(),l,0):b.C.h().appendChild(l):n.$f(l);A||(Nr(l,m),h.Oa().focus());Ju(b.C);h=$(l);d.BA=h};a.jF={},a.pF=function(b,c,d){function e(b){mc(b)}function g(c,d){for(;c!==b;){if(d(c))return c;c=c.parentNode}return k}function h(b){return b.tagName&&b.tagName===c}b||f("Missing Editable Container");c||(c="blockquote");var c=c.toUpperCase(),l=Gp();if(l&&kF(b,So(l))&&kF(b,To(l))){var n=QC(l.V(),l.ta(),l.ea(),l.Ia()),q;if(l.isCollapsed())q=[];else{var r=l.rc(),w=l.V(),B=l.ea();q=r.childNodes;var H=function(b){return w!==r&&!kF(b,w)},I=function(b){return!(b.previousSibling&&kF(b.previousSibling,B))};
q=Q.toArray(1===q.length?q:Q.Sz(Q.gL(q,H),I))}var H=l.Cb(),I=g(H,h),L=z.reduce(q,function(b,d){1===d.nodeType&&(h(d)?b.push(d):b.push.apply(b,z.toArray(d.getElementsByTagName(c))));return b},[]),U;if(I){if(d)return lF.fu;mc(I)}else if(L.length){if(d)return lF.fu;z.forEach(L,e)}else{if(d)return lF.JA;if(d=g(H,function(b){return z.contains(mF,b.tagName.toLowerCase())}))U=document.createElement(c),d.parentNode.insertBefore(U,d),U.appendChild(d);else if(l.V()!==l.ea())U=document.createElement(c),q[0].parentNode.insertBefore(U,
q[0]),z.forEach(q,function(b){U.appendChild(b)});else{n=c;nF.UI?document.execCommand("formatBlock",m,n):(d=Gp(),l=d.rc(),ra(l)&&1==l.nodeType&&Fs(l)?(n=document.createElement(n),l===b?l.appendChild(n):lc(n,l),(D||C)&&n.appendChild(document.createElement("br")),Es(n)):(d=d.ea(),d=Hc(d,function(b){return hD(b.parentNode)||VC(b.parentNode)},j),l=Q.Sz(new Yr(d,j,j),qf(oF)),d=Q.Sz(new Yr(d,m,m),qf(oF)),l=Q.toArray(l).reverse().concat(Q.toArray(d)),l.length&&(n=document.createElement(n),d=z.Wd(l),(q=d.nextSibling)&&
(q&&"BR"===q.tagName)&&N(q),jc(n,d),gc(n,l),(D||C)&&n.appendChild(document.createElement("br")),Nr(n.lastChild))));return}}n&&(l=function(c,d){return c&&kF(b,c)&&Gr(c)>=d},l(n.V(),n.ta())&&l(n.ea(),n.Ia())&&n.select())}else if(d)return lF.JA},a.oF=function(b){return b&&"BR"===b.tagName||hD(b)||VC(b)},a.kF=function(b,c){return 3===b.nodeType?b===c:b.contains(3===c.nodeType?c.parentNode:c)},a.mF=["ul","ol","dl","table"],a.lF={fu:1,JA:0},a.nF=jF;nF.UI=!A;nF.toggle=pF;
nF.Rd=function(b,c){return pF(b,c,j)};nF.OI=lF;a.qF=function(){Gu.call(this)};y(qF,Gu);t=qF.prototype;t.hd=lf("Blockquote");t.Ae=function(b){return"+blockquote"===b};t.Ye=function(b){this.Ae(b)&&jF.toggle(this.C.h())};t.queryCommandValue=function(){return jF.OI.fu===jF.Rd(this.C.h())};t.Kw=function(b){if(13===b.keyCode)return this.Fw(b)};t.vz=function(b,c){return rF(b,c).vz};
a.rF=function(b,c){function d(b,c){return{vz:b,AF:c}}D&&(b.normalize(),c=Gp());var e,g=c;e=g.ea();var h=g.Ia(),g=g.rc(),l=g.childNodes.length;3!==e.nodeType&&l&&(e=g.childNodes[h===l?l-1:h]);if(!e)return d(m,k);if(Fs(b))return d(j,b);for(h=e;h!==b;){if(iD(h))return d(m,k);h=h.parentNode}return e&&"BR"===e.tagName&&e.previousSibling&&"BR"===e.previousSibling.tagName?d(j,e):(e=c.Cb())&&1===e.nodeType&&(!e.childNodes.length||Fs(e))?d(j,e):d(m,k)};
t.Fw=function(b){var c=iv(this.C);if(c.isCollapsed()){var d;a:{d=c.ea();for(var e=this.C.field;d!==e;){if("BLOCKQUOTE"===d.tagName)break a;d=d.parentNode}d=i}if(d&&(c=rF(d,c),c.vz)){b.preventDefault();b=document.createElement("div");jc(b,d);if(D||C)(d=(d=d.nextSibling)&&"BR"===d.tagName&&d)||(d=document.createElement("br")),b.appendChild(d);Ip(b,0).select();c.AF&&N(c.AF)}}};LA["+blockquote"]={cb:j,R:"引用内容",wa:"+blockquote",La:"tr-icon tr-blockquote",factory:Mz};a.sF=function(b,c){this.eb=b;this.oA=!c};
sF.prototype.bi=function(b,c,d){var e,g=[];if(""!=b){e=$a(b);var h=RegExp("(^|\\W+)"+e,"i");Q.some(this.eb,function(b){String(b).match(h)&&g.push(b);return g.length>=c})}e=g;if(0==e.length&&this.oA){var l=[];Q.forEach(this.eb,function(c,d){var e=b.toLowerCase(),g=String(c).toLowerCase(),h=0;if(-1!=g.indexOf(e))h=parseInt((g.indexOf(e)/4).toString(),10);else for(var n=e.split(""),L=-1,U=10,ha=0,Ia;Ia=n[ha];ha++)Ia=g.indexOf(Ia),Ia>L?(L=Ia-L-1,L>U-5&&(L=U-5),h+=L,L=Ia):(h+=U,U+=5);h<6*e.length&&l.push({xS:c,
SG:h,index:d})});l.sort(function(b,c){var d=b.SG-c.SG;return 0!=d?d:b.index-c.index});e=[];for(var n=0;n<c&&n<l.length;n++)e.push(l[n].xS)}d(b,e)};a.tF=function(b){T.call(this);G.extend(this.F={},this.defaults,b||{});this.ae=k};y(tF,T);
a.uF=[["ABAP",["abap"]],["ActionScript",["as","actionscript"]],["Ada",["ada","ada95ada2005"]],["ANTLR",["antlr"]],["ApacheConf",["apacheconf","aconf","apache"]],["AppleScript",["applescript"]],["AspectJ",["aspectj"]],["Asymptote",["asy","asymptote"]],["AutoHotkey",["ahk"]],["Awk",["awk","gawk","mawk","nawk"]],["BBCode",["bbcode"]],["Base Makefile",["basemake"]],["Bash",["bash","sh","ksh"]],["Batchfile",["bat"]],["Befunge",["befunge"]],["BlitzMax",["blitzmax","bmax"]],["Boo",["boo"]],["Brainfuck",
["brainfuck","bf"]],["Bro",["bro"]],["BUGS",["bugs","winbugs","openbugs"]],["C",["c"]],["CMake",["cmake"]],["c-objdump",["c-objdump"]],["aspx-cs",["aspx-cs"]],["C#",["csharp","c#"]],["Ceylon",["ceylon"]],["CFEngine3",["cfengine3","cf3"]],["Cheetah",["cheetah","spitfire"]],["Clojure",["clojure","clj"]],["CoffeeScript",["coffee-script","coffeescript"]],["Coldfusion HTML",["cfm"]],["cfstatement",["cfs"]],["Common Lisp",["common-lisp","cl"]],["Coq",["coq"]],["C++",["cpp","c++"]],["cpp-objdump",["cpp-objdump",
"c++-objdumb","cxx-objdump"]],["Croc",["croc"]],["CSS",["css"]],["CUDA",["cuda","cu"]],["Cython",["cython","pyx"]],["D",["d"]],["d-objdump",["d-objdump"]],["Darcs Patch",["dpatch"]],["Dart",["dart"]],["Delphi",["delphi","pas","pascal","objectpascal"]],["dg",["dg"]],["Diff",["diff","udiff"]],["Django/Jinja",["django","jinja"]],["DTD",["dtd"]],["Duel","duel;Duel Engine;Duel View;JBST;jbst;JsonML+BST".split(";")],["Dylan",["dylan"]],["ECL",["ecl"]],["eC",["ec"]],["Erlang",["erlang"]],["Elixir",["elixir",
"ex","exs"]],["ERB",["erb"]],["Evoque",["evoque"]],["FSharp",["fsharp"]],["Factor",["factor"]],["Fancy",["fancy","fy"]],["Fantom",["fan"]],["Felix",["felix","flx"]],["Fortran",["fortran"]],["GLSL",["glsl"]],["GAS",["gas"]],["Genshi",["genshi","kid","xml+genshi","xml+kid"]],["Gettext Catalog",["pot","po"]],["Gherkin",["Cucumber","cucumber","Gherkin","gherkin"]],["Gnuplot",["gnuplot"]],["Go",["go"]],["GoodData-CL",["gooddata-cl"]],["Gosu",["gosu"]],["Gosu Template",["gst"]],["Groff",["groff","nroff",
"man"]],["Groovy",["groovy"]],["Haml",["haml","HAML"]],["Haskell",["haskell","hs"]],["haXe",["hx","haXe"]],["HTML",["html"]],["HTTP",["http"]],["Hxml",["haxeml","hxml"]],["Hybris",["hybris","hy"]],["INI",["ini","cfg"]],["Io",["io"]],["Ioke",["ioke","ik"]],["IRC logs",["irc"]],["Jade",["jade","JADE"]],["JavaScript",["js","javascript"]],["JSON",["json"]],["Java",["java"]],["Java Server Page",["jsp"]],["Julia console",["jlcon"]],["Julia",["julia","jl"]],["Kconfig",["kconfig","menuconfig","linux-config",
"kernel-config"]],["Koka",["koka"]],["Kotlin",["kotlin"]],["Lasso",["lasso","lassoscript"]],["Lighttpd configuration file",["lighty","lighttpd"]],["Literate Haskell",["lhs","literate-haskell"]],["LiveScript",["live-script","livescript"]],["LLVM",["llvm"]],["Logtalk",["logtalk"]],["Lua",["lua"]],["MOOCode",["moocode"]],["Makefile",["make","makefile","mf","bsdmake"]],["Mako",["mako"]],["MAQL",["maql"]],["Mason",["mason"]],["Matlab",["matlab"]],["Matlab session",["matlabsession"]],["MiniD",["minid"]],
["Modelica",["modelica"]],["Modula-2",["modula2","m2"]],["MoinMoin/Trac Wiki markup",["trac-wiki","moin"]],["Monkey",["monkey"]],["MoonScript",["moon","moonscript"]],["Mscgen",["mscgen","msc"]],["MuPAD",["mupad"]],["MXML",["mxml"]],["MySQL",["mysql"]],["Myghty",["myghty"]],["NASM",["nasm"]],["Nemerle",["nemerle"]],["NewLisp",["newlisp"]],["Newspeak",["newspeak"]],["Nginx configuration file",["nginx"]],["Nimrod",["nimrod","nim"]],["NumPy",["numpy"]],["objdump",["objdump"]],["Objective-C",["objective-c",
"objectivec","obj-c","objc"]],["Objective-J",["objective-j","objectivej","obj-j","objj"]],["OCaml",["ocaml"]],["Octave",["octave"]],["Ooc",["ooc"]],["Opa",["opa"]],["OpenEdge ABL",["openedge","abl","progress"]],["Perl",["perl","pl"]],["PHP",["php","php3","php4","php5"]],["PL/pgSQL",["plpgsql"]],["PostScript",["postscript"]],["PostgreSQL console (psql)",["psql","postgresql-console","postgres-console"]],["PostgreSQL SQL dialect",["postgresql","postgres"]],["POVRay",["pov"]],["PowerShell",["powershell",
"posh","ps1"]],["Prolog",["prolog"]],["Properties",["properties"]],["Protocol Buffer",["protobuf"]],["Python",["python","py","sage"]],["Python Traceback",["pytb"]],["RConsole",["rconsole","rout"]],["Racket",["racket","rkt"]],["Embedded Ragel",["ragel-em"]],["Raw token data",["raw"]],["Rd",["rd"]],["REBOL",["rebol"]],["Redcode",["redcode"]],["RHTML",["rhtml","html+erb","html+ruby"]],["RobotFramework",["RobotFramework","robotframework"]],["reStructuredText",["rst","rest","restructuredtext"]],["Ruby",
["rb","ruby","duby"]],["Rust",["rust"]],["S",["splus","s","r"]],["Standard ML",["sml"]],["Sass",["sass","SASS"]],["Scala",["scala"]],["Scaml",["scaml","SCAML"]],["Scheme",["scheme","scm"]],["Scilab",["scilab"]],["SCSS",["scss"]],["Smali",["smali"]],["Smalltalk",["smalltalk","squeak"]],["Smarty",["smarty"]],["Snobol",["snobol"]],["SourcePawn",["sp"]],["Debian Sourcelist",["sourceslist","sources.list"]],["SQL",["sql"]],["sqlite3con",["sqlite3"]],["SquidConf",["squidconf","squid.conf","squid"]],["Scalate Server Page",
["ssp"]],["Stan",["stan"]],["systemverilog",["sv"]],["Tcl",["tcl"]],["Tcsh",["tcsh","csh"]],["Tea",["tea"]],["TeX",["tex","latex"]],["Text",["text"]],["Treetop",["treetop"]],["UrbiScript",["urbiscript"]],["VGL",["vgl"]],["Vala",["vala","vapi"]],["aspx-vb",["aspx-vb"]],["VB.net",["vb.net","vbnet"]],["Velocity",["velocity"]],["verilog",["v"]],["vhdl",["vhdl"]],["VimL",["vim"]],["XQuery",["xquery","xqy","xq","xql","xqm"]],["XML",["xml"]],["XSLT",["xslt"]],["Xtend",["xtend"]],["YAML",["yaml"]]],a.vF=
function(b){return{label:b[0],value:b[1][0],toString:lf(b[0])}},a.wF=z.map(uF,vF);t=tF.prototype;t.defaults={OR:"lang-select",xq:"collapsed",yO:"lang-list",AQ:"lang-option",yk:"active",LB:"checked"};t.w=function(){tF.n.w.call(this);this.m().G();this.Y.G();N(this.g);this.cr=this.It=this.g=k};t.v=function(){var b=this.F;this.g=M("div",{innerHTML:this.template,className:[b.OR,b.xq].join(" ")})};t.template='<div class="title-button">选择语言</div><i class="zg-icon zg-icon-double-arrow"></i><div class="input-wrapper"><input class="filter-input zg-form-text-input" placeholder="搜索语言"></div>';
t.B=function(){tF.n.B.call(this);this.It=K("title-button",this.g);this.cr=K("filter-input",this.g);sg(this.It,j);var b=this.cr,c=this.g,d=this.F,e=this.m(),g=this,h=g.F,l={},n=new sF(wF,m),c=new on(c,l),q=new dn(k,k,m),r=n.bi;n.bi=function(b,c,d){Oa(b)?r.apply(this,arguments):d(b,wF)};l.Wc=function(b,c,d){b=b.data;b.value===g.ae&&(F.add(d,h.LB),d.appendChild(M("i","icon "+h.LB)));d.appendChild(document.createTextNode(b.toString()))};var w=new Om(n,c,q);q.Y=w;q.Ck(b);w.El=20;e.e(w,"suggestionsupdate",
function(){w.ve(w.Ec+0)}).e(w,"update",function(b){this.qy(b.Io)}).e(w,"dismiss",function(){this.fi(j)});b=w.M;b.className=d.yO;b.ci=d.AQ;b.lu=d.yk;this.Y=w;this.m().e(this.g,"click",this.nr).e(this.It,"click",this.gN)};t.W=p("ae");t.Aa=function(b){var c=b&&z.find(wF,function(c){return c.value===b});c&&(this.Zj(c.label),this.dispatchEvent({type:"change",zQ:c}));this.ae=b};
t.nr=function(b){var c=this.Y,d=c.M.h();d&&(document.activeElement!==this.cr&&!d.contains(b.target))&&(b.preventDefault(),b.stopPropagation(),Qm(c))};t.gN=function(){this.isCollapsed()&&this.fi(m)};t.isCollapsed=function(){return F.has(this.g,this.F.xq)};t.fi=function(b){if(this.isCollapsed()!==b){var c=this.cr,d=this.F;b?F.add(this.g,d.xq):(F.remove(this.g,d.xq),b=this.Y,d=b.M,b.Zl(wF),d.h().scrollTop=0,d.show(),c.value="",c.focus())}};t.Zj=function(b){var c=this.It;c.title=b;xc(c,b)};
t.qy=function(b){this.Aa(b.value);this.Y.Dc()};a.xF=function(b){Gu.call(this);G.extend(this.F={},this.defaults,b||{});this.Ov=this.rb=k};y(xF,Gu);
a.yF=D||rb||C,a.zF=function(b){return"P"===b.tagName},a.AF=function(b){return 3===b.nodeType},a.BF=function(b){return b&&"PRE"===b.tagName},a.CF=function(b){function c(b){return z.contains(g,b)}function d(){var b=document.createTextNode("\n");g.push(b);return b}var e=document.createElement("div");e.innerHTML=b;var g=[],h=qf(c),b=zc(e,hD);(0,z.forEach)(b,function(b){b.lastChild&&"BR"===b.lastChild.tagName&&b.removeChild(b.lastChild);b.firstChild||b.appendChild(document.createTextNode(""));b.insertBefore(d(),
b.firstChild);b.appendChild(d())});b=z.toArray(e.getElementsByTagName("br"));(0,z.forEach)(b,function(b){b!==b.parentNode.lastChild&&lc(document.createTextNode("\n"),b)});e=zc(e,AF);e=pf(function(b){return z.filter(b,function(d,e){var g=b[e-1];return!g||!(c(g)&&c(d))})},function(b){var c=z.Wv(b,h);return-1!==c?b.slice(0,c+1):b},function(b){var c=z.Vv(b,h);return-1!==c?b.slice(c):b})(e);return(0,z.map)(e,function(b){return b.nodeValue}).join("").replace(/\xa0/g," ")};t=xF.prototype;t.hd=lf("CodePlugin");
t.Ae=function(b){return"+code"===b};t.Ye=function(b){this.Ae(b)&&this.trigger()};t.queryCommandValue=function(){var b="1"===DF(this).state,c=this.C.Kh("EnterHandler");c&&(b?c.disable(this.C):c.enable(this.C));this.rb&&this.Ov&&Mh(this.rb,function(c){c instanceof Sy&&c.Xa(!b||z.contains(this.Ov,c.Qd()))},this);return b};t.defaults={TK:""};t.VR=function(b){this.rb=b;this.Ov=["toggleFullScreen"].concat("+code")};t.w=function(){xF.n.w.call(this);this.rb=k};
a.EF=function(b,c,d){for(b=b.C.field;c!==b;){if(d(c))return c;c=c.parentNode}},a.DF=function(b){var c,d=Gp();d&&b.C.field.contains(d.Cb())?(c=d.V(),b=(c=EF(b,c,BF))?"1":"2"):b="0";return{state:b,zo:d,code:c}};
t.trigger=function(){var b=DF(this),c=b.zo,d=b.code;switch(b.state){case "1":var e=!Oa(Gc(d)),b=iD(d);e?(d.parentNode.removeChild(d),b&&Nr(b,j)):(c=c.V()&&c.ea()?new RC(c):k,e=Qa(d.innerHTML),$r(Q.filter(new Yr(d,m,j),Zr))&&(e="<br>"+e),b&&"BR"!==b.tagName&&(e+="<br>"),b=ec(e),d.parentNode.replaceChild(b,d),c.restore());break;case "2":this.Wr(c,Oa(c.Gc())?CF(c.Sd()):yF?"\n":"")}};
t.Li=function(b,c){var d=document.createElement(b);d.id=Gh(Fh.O());return c(d,function(){d=J(d.id);d.removeAttribute("id");return d})};
t.pg=function(){var b=this.C,c=this.C.field,d,e=new um(BF,m,k,c),g=M("div",{style:"display:none"});Pr(e,new Of(4,0,0,0));e.wl=new Of(4,0,0,0)||k;e.vt=150;e.Fr=100;e.Xg(g);e.className="hc-lang-select";P(e,"beforeshow",function(b){d=b.target.anchor;e.Yc(new cm(d,1));if(d.lang){var b=h,c,g=d.lang;(c=(c=z.find(uF,function(b){return b[0]===g||z.contains(b[1],g)}))&&vF(c))&&b.Aa(c.value);h.fi(j)}else h.Zj("选择语言")});P(e,"beforehide",function(b){d=k;h.Aa(k);if((b=b.target)&&c.contains(b)&&BF(b))return m});
var h=new tF;h.X(g);P(h,"change",function(b){d&&(d.lang=b.zQ.value,e.D(m))});this.Op={ow:lf(e),RW:lf(h),G:function(){e.G();h.G()}};Rc(b,this.Op);P(b,"delayedchange",this.uR,m,this);P(b.field,"paste",this.Mw,m,this)};t.uR=function(){var b=this.Op&&this.Op.ow();b&&(b.P()&&b.anchor)&&b.fa()};
t.Mw=function(b){var c=DF(this),d=c.zo,e=c.code;if("1"===c.state)if(c=b.Ub.clipboardData)c.types&&z.contains(c.types,"text/plain")&&(b.preventDefault(),c=c.getData("text/plain"),b=document.createTextNode(c),d.$f(b),Nr(b));else if(window.clipboardData){if(c=window.clipboardData.getData("Text")){b.preventDefault();var g=c;this.Li("i",function(b,c){d.$f(b);b=c();g=Ma(g);lc(document.createTextNode(g),b)})}}else{var h=d.ta(),b=d.Gc().length,l=(e.firstChild?Gr(e.firstChild):0)-h-b;setTimeout(function(){var b=
CF(e.innerHTML);xc(e,b);b=(e.firstChild?Gr(e.firstChild):0)-l;e.firstChild&&Ip(e.firstChild,Math.max(h,b)).select()})}};
t.Kw=function(b){if(13===b.keyCode)return this.Fw(b);if(40===b.keyCode){var c=DF(this),d=c.zo,b=c.code;if("1"===c.state){for(var e=c=d.ea(),g=[];e&&e!==b;)g.push([e.parentNode.childNodes.length,z.indexOf(e.parentNode.childNodes,e)]),e=e.parentNode;g=!g.length||z.every(g,function(b){return b[0]===b[1]+1});e=AF(c);if(g&&!(g=!e))e&&(c=c.nodeValue,d=d.Ia(),e=d===c.length||yF&&d===c.length-1&&"\n"===c.slice(-1)),g=e;g&&(iD(b)||jc(document.createElement("br"),b))}}};
t.Fw=function(b){var c=DF(this),d=c.zo;if("1"===c.state)return b.preventDefault(),A?this.Li("i",function(b,c){d.$f(b);setTimeout(function(){var d=document.createTextNode("\r");b=c();lc(d,b);Nr(d)})}):document.queryCommandSupported("insertLineBreak")?document.execCommand("insertLineBreak"):(b=document.createTextNode("\n"),d.insertNode(b),Nr(b)),this.C.Ve(),j};
t.Wr=function(b,c){var d=this.F,e;b.Vc();var g;var h=TC(b,j),l=h.ba,n,q=this.C.field;g=EF(this,l,kD(hD,qf(zF)))||q;var r=function(b){return b.parentNode.insertBefore(document.createTextNode(""),b)};if(AF(l)){var w=l.parentNode;!l.nodeValue&&w!==q&&Fs(w)?(n=r(w),l=r(n),w.parentNode.removeChild(w)):n=A&&h.offset===l.length?jc(document.createTextNode(""),l):l.splitText(h.offset)}else"BR"===l.tagName&&(n=l,l=r(l));if(n){for(var B,h=l,l=n;h!=g&&(B=h.parentNode);){n=h;h=l;for(l=B.cloneNode(m);n.nextSibling;)l.appendChild(n.nextSibling);
h&&l.insertBefore(h,l.firstChild);h=B}B=l;n=B.firstChild;gc(g,B.childNodes);g=n}else g=k;g?(e=document.createElement("PRE"),g.parentNode.insertBefore(e,g)):this.Li("PRE",function(c,d){b.insertNode(c);e=d()});!c&&A&&(c=" ");e.lang=d.TK;xc(e,c);Fs(e)?Es(e.firstChild):Nr(e.lastChild);d=e;iD(d)||jc(document.createElement("br"),d)};LA["+code"]={cb:j,R:"插入代码",wa:"+code",La:"tr-icon tr-code",factory:Mz};a.FF=function(){Gu.call(this);this.xQ=k};y(FF,Gu);a.GF=/^(DIV|TR|LI|BLOCKQUOTE|H\d|PRE|XMP)/,a.HF=function(b){b.push("<br>")};t=FF.prototype;t.hd=s("RemoveFormatting");t.Ae=function(b){return"+removeFormat"==b};t.Ye=function(b){"+removeFormat"==b&&!iv(this.C).isCollapsed()&&(b=this.xQ||v(this.EG,this),IF(this,b),OC(this).Ca().execCommand("RemoveFormat",m,i),Yp&&IF(this,function(b){var d=E("528")?/&nbsp;/g:/\u00A0/g;return b.replace(d," ")}))};
t.vr=function(b,c,d){return!d?m:" "==c?(this.C.execCommand("+removeFormat"),j):m};
a.JF=function(b,c){for(var d=b.C.h();c&&c!=d;){if("TABLE"==c.tagName)return c;c=c.parentNode}return k},a.IF=function(b,c){var d=iv(b.C);if(!(1<d.ej())){if(C){var e=fD(d,b.C.h()),g=JF(b,e.V()),h=JF(b,e.ea());if(g||h){if(g==h)return;var l,n=d;l=g;var d=h,e=new $C(n),q=n.V(),r=n.ta(),w=n.ea(),n=n.Ia(),B=OC(b);if(l){var H=B.createTextNode("");jc(H,l);q=H;r=0}d&&(H=B.createTextNode(""),ic(H,d),w=H,n=0);sp(q,r,w,n).select();l=e;g||(d=N(MC(l,j)),b.Iz=d);h||(d=N(MC(l,m)),b.Hv=d);d=iv(b.C);e=fD(d,b.C.h())}e.select();
d=e}q=d;d=OC(b).v("div");e=q.Pd();Mp?d.appendChild(e.cloneContents()):Lp&&(r=q.Gc(),r=r.replace(/\r\n/g,"\r"),w=r.length,q=w-r.replace(/^[\s\xa0]+/,"").length,r=w-Pa(r).length,e.moveStart("character",q),e.moveEnd("character",-r),q=e.htmlText,"Formatted"==e.queryCommandValue("formatBlock")&&(q=Qa(e.htmlText)),d.innerHTML=q);q=c(d.innerHTML);B=iv(b.C);d=OC(b);r=db();e=db();q='<span id="'+r+'"></span>'+q+'<span id="'+e+'"></span>';n=db();w='<span id="'+n+'"></span>';if(Lp){H=B.se(0).Pd();H.pasteHTML(w);
for(var I;(I=H.parentElement())&&Fs(I)&&!ZC(I);){B=I.nodeName;if("TD"==B||"TR"==B||"TH"==B)break;N(I)}H.pasteHTML(q);(n=d.h(n))&&N(n)}else if(Mp){d.Ca().execCommand("insertImage",m,n);B=RegExp("<[^<]*"+n+"[^>]*>");I=iv(b.C).Cb();3==I.nodeType&&(I=I.parentNode);for(;!B.test(I.innerHTML);)I=I.parentNode;if(C)I.innerHTML=I.innerHTML.replace(B,q);else{I.innerHTML=I.innerHTML.replace(B,w);for(I=n=d.h(n);(I=n.parentNode)&&Fs(I)&&!ZC(I);){B=I.nodeName;if("TD"==B||"TR"==B||"TH"==B)break;jc(n,I);N(I)}I.innerHTML=
I.innerHTML.replace(RegExp(w,"i"),q)}}I=d.h(r);d=d.h(e);sp(I,0,d,d.childNodes.length).select();N(I);N(d);C&&l&&(d=iv(b.C),I=b.C.h(),b.Iz&&(I.insertBefore(b.Iz,I.firstChild),b.Iz=k),b.Hv&&(I.appendChild(b.Hv),b.Hv=k),I=k,e=MC(l,j),q=MC(l,m),e&&q&&(I=sp(e,0,q,0)),QC((g?I:d).V(),(g?I:d).ta(),(h?I:d).ea(),(h?I:d).Ia()).select(),l.G())}};
t.EG=function(b){var c=document.createElement("div");c.innerHTML=b;for(var b=[],c=[c.childNodes,0],d=[],e=0,g=[],h=0,l=0;0<=l;l-=2){for(var n=m;0<h&&l<=g[h-1];)h--,n=j;n&&HF(b);for(n=m;0<e&&l<=d[e-1];)e--,n=j;n&&HF(b);for(var n=c[l],q=c[l+1];q<n.length;){var r=n[q++],w=r.nodeName,B=this.qD(r);if(B!=k)b.push(B);else{switch(w){case "#text":r=0<e?r.nodeValue:La(r.nodeValue);r=Wa(r);b.push(r);continue;case "P":HF(b);HF(b);break;case "BR":HF(b);continue;case "TABLE":HF(b);g[h++]=l;break;case "PRE":case "XMP":d[e++]=
l;break;case "STYLE":case "SCRIPT":case "SELECT":continue;case "A":if(r.href&&""!=r.href){b.push("<a href='");b.push(r.href);b.push("'>");b.push(this.EG(r.innerHTML));b.push("</a>");continue}else break;case "IMG":b.push("<img src='");b.push(r.src);b.push("'");"0"==r.border&&b.push(" border='0'");b.push(">");continue;case "TD":r.previousSibling&&b.push(" ");break;case "TR":r.previousSibling&&HF(b);break;case "DIV":if(B=r.parentNode,B.firstChild==r&&GF.test(B.tagName))break;default:GF.test(w)&&HF(b)}r=
r.childNodes;0<r.length&&(c[l++]=n,c[l++]=q,n=r,q=0)}}}return b.join("").replace(/\xa0|[ \t]+/g," ")};t.qD=s(k);a.KF=function(){FF.call(this)};y(KF,FF);KF.prototype.qD=function(b){var c;if("IMG"!==b.nodeName)return k;c=[];c.push('<img src="');c.push(Wa(b.src));c.push('"');b.getAttribute("eeimg")&&b.getAttribute("alt")&&c.push(' eeimg="'+Wa(b.getAttribute("eeimg"))+'" alt="'+Wa(b.getAttribute("alt"))+'"');c.push(">");return c.join("")};a.LF=function(b){bE.call(this,b);this.N=new me(this);this.kA="http://upload."+bh.am+":"+location.port+"/upload";this.$J=!A};y(LF,bE);a.MF=function(b){gd.call(this,"ok");var c=b[0];this.xl=c;this.eG=c.replace("_m.jpg","_r.jpg");this.yG=b[1];this.xG=b[2]};y(MF,gd);t=LF.prototype;t.template=Kk('<div class="zm-img-uploader"><iframe src="about:blank" name="av_up_frame" style="position: absolute; height: 0; width: 0; left: -9000px; "></iframe><div class="zg-section zm-img-uploader-tab"><a href="javascript:;" class="tab-nav selected">上传图片</a> 或 <a href="javascript:;" class="tab-nav">引用站外图片</a></div><form class="zg-clear" target="av_up_frame" method="POST" enctype="multipart/form-data" action="<%= uploadURL %>"><div class="tab-content selected <% if (canStylize) { %>inline<% } %>"><% if (canStylize) { %><input type="file" name="upload_file" style="opacity:0;height:0;width:0;font-size:0;position:absolute;"><a href="javascript:;" class="browser zg-btn-blue">选择图片</a><% } else { %><input type="file" name="upload_file"><% } %></div><div class="tab-content"><input type="text" autocomplete="off" name="upload_file_url" class="zm-editable-editor-input zg-form-text-input"><a href="javascript:;" class="insert zg-btn-blue zm-uploader-button-fix">确认</a></div><span style="display: none; " class="zm-img-uploader-loading">正在上传</span><span style="display: none; " class="zm-img-uploader-error">上传图片失败，请稍后重试</span></form><div class="zg-gray">请不要上传与回答问题无关的图片，详细请看 <a href="http://www.zhihu.com/question/20064580" target="_blank">知乎图片使用规范</a></div><div class="zm-command"><a class="cancel" href="javascript:;">取消</a></div></div>');
t.hv=function(){var b=ec(this.template({uploadURL:this.kA,canStylize:this.$J}));G.forEach({form:"form",Qz:".zm-img-uploader-tab",Sh:".zm-img-uploader-loading",Jf:".zm-img-uploader-error",xH:"input[type=text]",pn:"input[type=file]",yB:".browser",Su:".cancel",VN:".insert"},function(c,e){this[e]=$(c,b).get(0)},this);this.N.e(Y,"iframe_data",this.tu).e(this.pn,"change",this.PQ).e(this.VN,"click",this.WN).e(this.Su,"click",function(){this.zw();this.hide()}).e(this.Qz,"click",function(b){b=$(b.target);
b.is("a")&&!b.is(".selected")&&NF(this,b.index())});this.UB=b;Sg||(NF(this,1),$(this.Qz).replaceWith("<strong>输入站外图片地址：</strong>"));this.yB&&this.N.e(this.yB,"click",function(){this.pn.click()});var c=new cE(this);c.Ya("插入图片").Ha(this.UB);c=fE(c);gi(c,k);return c};t.PQ=function(){if(this.pn.value){var b=this.pn.value,b=String(b).toLowerCase();(!b?0:z.some([".jpg",".jpeg",".gif",".png"],function(c){return Ga(b,c)}))?(this.xH.value="",OF(this)):PF(this,"图片不是 .jpg、.png 或 .gif 格式，无法上传。")}};
t.WN=function(){var b=tk(this.xH.value);b?Fa(b,"http://")?(this.pn.value="",OF(this)):PF(this,"我们目前不支持该协议。"):PF(this,"请填写图片地址。")};a.NF=function(b,c){function d(b){b.eq(c).addClass("selected").siblings().removeClass("selected")}var e=$(".tab-nav",b.Qz),g=$(".tab-content",b.form);R(b.Jf,m);var h=g.eq(c);h.find("input").val("");d(e);d(g);h.find(":text").focus()},a.PF=function(b,c){R(b.Sh,m);b.Jf.innerHTML=c;R(b.Jf,j)};t.tu=function(b){R(this.Sh,m);this.$j(b.Ic)};
t.$j=function(b){b&&!b.r?(this.dispatchEvent(this.Ym(b.msg)),this.hide()):PF(this,b.msg)};a.OF=function(b){R(b.Sh,j);R(b.Jf,m);b.form.submit()};t.Ym=function(b){return new MF(b)};t.w=function(){this.N.G();this.N=k;LF.n.w.call(this)};a.QF=function(){gE.call(this,"image");this.N=new me(this)};y(QF,gE);t=QF.prototype;t.hd=lf("ImageDialogPlugin");t.Ye=function(b,c){var d=this.C;return!d.gf&&(d.Of(),!d.gf)?m:QF.n.Ye.call(this,b,c)};
t.kj=function(b){if(b&&"mouseup"===b.type){var c=b.target;c&&"IMG"===c.nodeName&&(b=iD(c),b||(b=document.createElement("br"),jc(b,c)),Es(b))}};t.wn=function(b){QF.n.wn.call(this,b)};t.gv=function(b){b=new LF(b);this.N.e(b,"ok",this.An).e(b,"cancel",this.Aw);return b};t.w=function(){QF.n.w.call(this);this.N.G()};
t.An=function(b){iE(this);var c=OC(this),d;d=b.eG?c.v("IMG",{"class":"origin_image zh-lightbox-thumb","data-original":b.eG,title:"点击查看原图",src:b.xl}):c.v("IMG",{"class":"content_image",src:b.xl});b.yG&&d.setAttribute("data-rawwidth",b.yG);b.xG&&d.setAttribute("data-rawheight",b.xG);b=iv(this.C);if(eD(b))b.$f(d),A||(Nr(d,m),c.Oa().focus()),Ku(this.C),this.C.Ve();else return k;this.N.removeAll()};t.Aw=function(){this.N.removeAll()};a.RF=function(b){bE.call(this,b);this.N=new me(this)};y(RF,bE);a.SF=function(b,c,d,e,g){gd.call(this,"ok");this.pT=b;this.nT=c;this.oT=g;this.pS=d;this.poster=e};y(SF,gd);t=RF.prototype;t.show=function(){RF.n.show.call(this);this.Tt.focus()};t.hide=function(){RF.n.hide.call(this)};
t.hv=function(){var b="http://upload."+bh.am+":"+location.port+"/upload_video",b=this.dd.v("div","zm-img-uploader zm-img-uploader-upload-tab-selected",[this.dd.v("div","zg-section",this.dd.v("strong",k,"输入视频页地址：")),this.KX=this.dd.v("iframe",{id:"video_up_frame",src:"about:_blank",name:"video_up_frame",style:"visible:hidden;position:absolute;height:0;width:0;left:-9000px"}),this.$C=this.dd.v("form",{"class":"zg-section-title",target:"video_up_frame",method:"post",enctype:"multipart/form-data",action:b},
[this.Tt=this.dd.v("input",{type:"text","class":"zg-form-text-input",name:"upload_file_url",autocomplete:"off"}),this.Lk=this.dd.v("a",{"class":"zg-btn-blue zm-uploader-button-fix",name:"save",href:"javascript:;"},"确定"),this.dd.v("div","zm-video-uploader-info",[this.Sh=this.dd.v("span",{style:"display:none","class":"zm-img-uploader-loading"},"正在上传"),this.Jf=this.dd.v("span",{style:"display:none","class":"zm-img-uploader-error"},"插入视频失败，请稍后重试")])]),this.HN=this.dd.v("div","zg-gray"),this.Ji=this.dd.v("div",
"zm-command",[this.Su=this.dd.v("a",{href:"javascript:;"},"取消")])]);this.HN.innerHTML='我们目前支持<a class="zg-link-gray" target="_blank" href="http://youku.com">优酷</a>、<a class="zg-link-gray" target="_blank" href="http://tudou.com">土豆</a>、<a href="http://video.sina.com.cn/" class="zg-link-gray" target="_blank">新浪</a>、<a href="http://v.qq.com/" class="zg-link-gray" target="_blank">腾讯</a>、<a href="http://www.56.com/" class="zg-link-gray" target="_blank">56</a>、<a href="http://tv.sohu.com/" class="zg-link-gray" target="_blank">搜狐</a>、<a href="http://www.iqiyi.com/" class="zg-link-gray" target="_blank">爱奇艺</a>视频服务。<br />请不要上传与回答问题无关的视频，详细请看 <a href="http://www.zhihu.com/question/20118966" target="_blank">知乎视频使用规范</a>';
this.N.e(this.Su,"click",function(){this.zw();this.hide()}).e(this.Lk,"click",this.pG).e(this.Ji,"click",this.ra).e(this.$C,"submit",function(){return TF(this,this.Tt.value)}).e(Y,"iframe_data",this.tu);this.UB=b;var c=new cE(this);c.Ya("插入视频").Ha(b);b=fE(c);gi(b,k);return b};a.TF=function(b,c){c=tk(c);if(!c)return m;var d=c.match(/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi);d||(R(b.Sh,m),b.Jf.innerHTML="我们无法识别你输入的视频页地址",R(b.Jf,j));return d};
t.pG=function(){if(this.Tt.value){var b=tk(this.Tt.value);b&&TF(this,b)&&(R(this.Sh,j),R(this.Jf,m),this.$C.submit())}};t.ra=function(b){"save"===(b.target&&b.target.name)&&this.pG()};t.tu=function(b){R(this.Sh,m);this.$j(b.Ic)};t.$j=function(b){b&&!b.r?(this.dispatchEvent(this.Ym(b.msg[0],b.msg[1],b.msg[2],b.msg[3],b.msg[4])),this.hide()):(b=b.msg,R(this.Sh,m),this.Jf.innerHTML=b,R(this.Jf,j))};t.Ym=function(b,c,d,e,g){return new SF(b,c,d,e,g)};t.w=function(){this.N.G();this.N=k;RF.n.w.call(this)};
a.UF=function(){gE.call(this,dD);this.N=new me(this)};y(UF,gE);t=UF.prototype;t.hd=lf("VideoDialogPlugin");t.Ye=function(b,c){var d=this.C;return!d.gf&&(d.Of(),!d.gf)?m:UF.n.Ye.call(this,b,c)};t.wn=function(b){UF.n.wn.call(this,b)};t.gv=function(b){b=new RF(b);this.N.e(b,"ok",this.An).e(b,"cancel",this.Aw);return b};t.w=function(){UF.n.w.call(this);this.N.G()};
t.An=function(b){iE(this);var c=OC(this),d=c.v("embed");G.forEach({type:"application/x-shockwave-flash",allowscriptaccess:"always",allowfullscreen:"true",wmode:"opaque","class":"video",width:"420",height:"350",src:b.pT,"data-poster":b.poster,"data-name":b.oT,"data-videoid":b.nT,"data-sourceurl":b.pS},function(b,c){d.setAttribute(c,b)});b=Kr(d);Ga(b,'">')&&(b+="</embed>");var b=ec(b+" "),e=b.firstChild,g=iv(this.C);if(eD(g))g.$f(b),A?document.selection&&(c=document.selection.createRange(),c.move("character",
-1),c.select()):(Nr(e),c.Oa().focus()),Ku(this.C),this.C.Ve();else return k;this.N.removeAll()};t.Aw=function(){this.N.removeAll()};a.Gs=j,a.VF=Gu.prototype.execCommand;Gu.prototype.execCommand=function(b){var c=this.C;return G.contains(oD,b)&&!c.gf?(c.Of(),m):VF.apply(this,arguments)};a.WF=gE.prototype.execCommand,a.XF=["+equation"];gE.prototype.execCommand=function(b){var c=this.C;return z.contains(XF,b)&&!c.gf&&(c.Of(),!c.gf)?m:WF.apply(this,arguments)};dD="video";jD=kb?"⌘":"ctrl";LA[dD]={wa:dD,R:"插入视频",La:"tr-icon tr-video",factory:Lz};LA["+equation"]={wa:"+equation",R:Rz.RU,La:"tr-icon tr-equation",factory:Lz};
LA["+bold"].R="粗体 ("+jD+"+b)";LA["+italic"].R="斜体 ("+jD+"+i)";LA["+underline"].R="下划线 ("+jD+"+u)";LA["+superscript"].R="引用内容";LA["+insertOrderedList"].R="有序列表";LA["+insertUnorderedList"].R="无序列表";LA["+removeFormat"].R="清除格式";LA.image.R="插入图片";LA[dD].R="插入视频";LA["+equation"].R="插入公式";a.YF=function(){};ja(YF);
YF.prototype.vg=function(b,c){this.config=c;var d,e,g;e=K("zm-editable-toolbar-container",b);d=K("zm-editable-editor-outer",b);g=K("zm-editable-editor-field-element",b);var h=new ov(g.id);h.SJ=89;var l=[];c.enableFullScreen&&l.push("toggleFullScreen");l.push("+bold","+italic","+underline",new GE,"+blockquote","+code","+insertOrderedList","+insertUnorderedList","+equation");c.canUploadMedia_&&l.push(new GE,"image",dD);c.useRemoveFormat_&&l.push(new GE,"+removeFormat");var n=Rb(e);g=[];for(var q=0,
r;r=l[q];q++){if(oa(r)){var w=i;if(r=LA[r]){var w=r.factory||Mz,B=r.wa,H=r.R,I=r.caption,L=r.La,U=n||Rb(),w=w(B,H,I,L,k,U);r.cb&&(w.cb=j)}r=w}r&&g.push(r)}var l=Rb(e),ha=new YC(Oy.O(),xo,l),l=eg(e);ha.ii(l);ha.Ke(m);for(n=0;q=g[n];n++)Zn(q,32,m),q.ii(l),ha.H(q,j);ha.X(e);new IE(h,ha);Rc(h,ha);NC(h,new nD);NC(h,new vE);if(c.loremIpsum_&&(NC(h,new wE(c.loremIpsum_)),C))h.on("load",function(){wd(h.h(),"focus",function(){h.execCommand("clearlorem",j)})});NC(h,new HD);NC(h,new KF);NC(h,new AE);e=new xF;
NC(h,e);NC(h,new QF);NC(h,new UF);NC(h,new gF);NC(h,new cF);NC(h,new dF);NC(h,new qF);c.enableFullScreen&&(d=new PA({title:"写作模式",ik:d}),NC(h,d));h.on("load",function(){c.useScraper_&&this.Vr(h,ha)},m,this);return[h,ha]};YF.prototype.Vr=function(b,c){var d=b.h(),e=new Cv;e.o(d);var g=M("div",{style:"display:none",className:"tr-spinner spinner-gray"});c.h().appendChild(g);e.on("willScrape",function(){R(g,j)}).on("didScrape",function(){R(g,m)});Rc(b,e)};
Da("ZH.createRichTextEditor",function(b,c){return YF.O().vg(b,c)});If("rich_text_editor");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/rich_text_editor.js